import{c as ke}from"./chunk-QMRW4JW7.js";import{a as Vu}from"./chunk-VW2EJ7NN.js";import{a as Ru,c as Pu}from"./chunk-HFQTUWZT.js";import{Ba as Dr,Ca as Qt,Db as Au,Eb as xu,Ka as yu,Ma as Et,Oa as bu,Sb as Su,Ta as hs,Tb as Ht,Ua as Un,Ub as Cu,Wa as ds,Xa as wu,Y as au,Z as $t,_ as cu,a as X,aa as uu,b as Ve,bb as Tt,ca as us,cb as kt,d as x,db as qn,ed as fs,fb as vu,ga as Ne,gb as Iu,ha as lu,ia as hu,ib as Vr,lb as Eu,mb as Tu,md as ms,na as du,oa as Gt,pa as Kt,qa as fu,qb as Nr,ra as mu,rb as Fr,sb as Or,ta as pu,tb as ku,va as gu,wa as ls,xd as Du,ya as _u}from"./chunk-HBXRJ3XO.js";var wf=["input"],vf=["label"],If=["*"],Ef=new uu("mat-checkbox-default-options",{providedIn:"root",factory:Fu});function Fu(){return{color:"accent",clickAction:"check-indeterminate"}}var me=function(n){return n[n.Init=0]="Init",n[n.Checked=1]="Checked",n[n.Unchecked=2]="Unchecked",n[n.Indeterminate=3]="Indeterminate",n}(me||{}),Tf={provide:Ru,useExisting:au(()=>Ou),multi:!0},ps=class{},kf=0,Nu=Fu(),Ou=(()=>{class n{focus(){this._inputElement.nativeElement.focus()}_createChangeEvent(t){let r=new ps;return r.source=this,r.checked=t,r}_getAnimationTargetElement(){return this._inputElement?.nativeElement}get inputId(){return`${this.id||this._uniqueId}-input`}constructor(t,r,i,o,a,l){this._elementRef=t,this._changeDetectorRef=r,this._ngZone=i,this._animationMode=a,this._options=l,this._animationClasses={uncheckedToChecked:"mdc-checkbox--anim-unchecked-checked",uncheckedToIndeterminate:"mdc-checkbox--anim-unchecked-indeterminate",checkedToUnchecked:"mdc-checkbox--anim-checked-unchecked",checkedToIndeterminate:"mdc-checkbox--anim-checked-indeterminate",indeterminateToChecked:"mdc-checkbox--anim-indeterminate-checked",indeterminateToUnchecked:"mdc-checkbox--anim-indeterminate-unchecked"},this.ariaLabel="",this.ariaLabelledby=null,this.labelPosition="after",this.name=null,this.change=new ls,this.indeterminateChange=new ls,this._onTouched=()=>{},this._currentAnimationClass="",this._currentCheckState=me.Init,this._controlValueAccessorChangeFn=()=>{},this._validatorChangeFn=()=>{},this._checked=!1,this._disabled=!1,this._indeterminate=!1,this._options=this._options||Nu,this.color=this._options.color||Nu.color,this.tabIndex=parseInt(o)||0,this.id=this._uniqueId=`mat-mdc-checkbox-${++kf}`}ngOnChanges(t){t.required&&this._validatorChangeFn()}ngAfterViewInit(){this._syncIndeterminate(this._indeterminate)}get checked(){return this._checked}set checked(t){t!=this.checked&&(this._checked=t,this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled}set disabled(t){t!==this.disabled&&(this._disabled=t,this._changeDetectorRef.markForCheck())}get indeterminate(){return this._indeterminate}set indeterminate(t){let r=t!=this._indeterminate;this._indeterminate=t,r&&(this._indeterminate?this._transitionCheckState(me.Indeterminate):this._transitionCheckState(this.checked?me.Checked:me.Unchecked),this.indeterminateChange.emit(this._indeterminate)),this._syncIndeterminate(this._indeterminate)}_isRippleDisabled(){return this.disableRipple||this.disabled}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}writeValue(t){this.checked=!!t}registerOnChange(t){this._controlValueAccessorChangeFn=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t}validate(t){return this.required&&t.value!==!0?{required:!0}:null}registerOnValidatorChange(t){this._validatorChangeFn=t}_transitionCheckState(t){let r=this._currentCheckState,i=this._getAnimationTargetElement();if(!(r===t||!i)&&(this._currentAnimationClass&&i.classList.remove(this._currentAnimationClass),this._currentAnimationClass=this._getAnimationClassForCheckStateTransition(r,t),this._currentCheckState=t,this._currentAnimationClass.length>0)){i.classList.add(this._currentAnimationClass);let o=this._currentAnimationClass;this._ngZone.runOutsideAngular(()=>{setTimeout(()=>{i.classList.remove(o)},1e3)})}}_emitChangeEvent(){this._controlValueAccessorChangeFn(this.checked),this.change.emit(this._createChangeEvent(this.checked)),this._inputElement&&(this._inputElement.nativeElement.checked=this.checked)}toggle(){this.checked=!this.checked,this._controlValueAccessorChangeFn(this.checked)}_handleInputClick(){let t=this._options?.clickAction;!this.disabled&&t!=="noop"?(this.indeterminate&&t!=="check"&&Promise.resolve().then(()=>{this._indeterminate=!1,this.indeterminateChange.emit(this._indeterminate)}),this._checked=!this._checked,this._transitionCheckState(this._checked?me.Checked:me.Unchecked),this._emitChangeEvent()):!this.disabled&&t==="noop"&&(this._inputElement.nativeElement.checked=this.checked,this._inputElement.nativeElement.indeterminate=this.indeterminate)}_onInteractionEvent(t){t.stopPropagation()}_onBlur(){Promise.resolve().then(()=>{this._onTouched(),this._changeDetectorRef.markForCheck()})}_getAnimationClassForCheckStateTransition(t,r){if(this._animationMode==="NoopAnimations")return"";switch(t){case me.Init:if(r===me.Checked)return this._animationClasses.uncheckedToChecked;if(r==me.Indeterminate)return this._checked?this._animationClasses.checkedToIndeterminate:this._animationClasses.uncheckedToIndeterminate;break;case me.Unchecked:return r===me.Checked?this._animationClasses.uncheckedToChecked:this._animationClasses.uncheckedToIndeterminate;case me.Checked:return r===me.Unchecked?this._animationClasses.checkedToUnchecked:this._animationClasses.checkedToIndeterminate;case me.Indeterminate:return r===me.Checked?this._animationClasses.indeterminateToChecked:this._animationClasses.indeterminateToUnchecked}return""}_syncIndeterminate(t){let r=this._inputElement;r&&(r.nativeElement.indeterminate=t)}_onInputClick(){this._handleInputClick()}_onTouchTargetClick(){this._handleInputClick(),this.disabled||this._inputElement.nativeElement.focus()}_preventBubblingFromLabel(t){t.target&&this._labelElement.nativeElement.contains(t.target)&&t.stopPropagation()}static{this.\u0275fac=function(r){return new(r||n)(Qt(gu),Qt(Su),Qt(yu),pu("tabindex"),Qt(_u,8),Qt(Ef,8))}}static{this.\u0275cmp=lu({type:n,selectors:[["mat-checkbox"]],viewQuery:function(r,i){if(r&1&&(Nr(wf,5),Nr(vf,5),Nr(ms,5)),r&2){let o;Fr(o=Or())&&(i._inputElement=o.first),Fr(o=Or())&&(i._labelElement=o.first),Fr(o=Or())&&(i.ripple=o.first)}},hostAttrs:[1,"mat-mdc-checkbox"],hostVars:14,hostBindings:function(r,i){r&2&&(Iu("id",i.id),hs("tabindex",null)("aria-label",null)("aria-labelledby",null),wu(i.color?"mat-"+i.color:"mat-accent"),ds("_mat-animation-noopable",i._animationMode==="NoopAnimations")("mdc-checkbox--disabled",i.disabled)("mat-mdc-checkbox-disabled",i.disabled)("mat-mdc-checkbox-checked",i.checked))},inputs:{ariaLabel:[Ne.None,"aria-label","ariaLabel"],ariaLabelledby:[Ne.None,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[Ne.None,"aria-describedby","ariaDescribedby"],id:"id",required:[Ne.HasDecoratorInputTransform,"required","required",Ht],labelPosition:"labelPosition",name:"name",value:"value",disableRipple:[Ne.HasDecoratorInputTransform,"disableRipple","disableRipple",Ht],tabIndex:[Ne.HasDecoratorInputTransform,"tabIndex","tabIndex",t=>t==null?void 0:Cu(t)],color:"color",checked:[Ne.HasDecoratorInputTransform,"checked","checked",Ht],disabled:[Ne.HasDecoratorInputTransform,"disabled","disabled",Ht],indeterminate:[Ne.HasDecoratorInputTransform,"indeterminate","indeterminate",Ht]},outputs:{change:"change",indeterminateChange:"indeterminateChange"},exportAs:["matCheckbox"],standalone:!0,features:[Au([Tf,{provide:Pu,useExisting:n,multi:!0}]),bu,du,xu],ngContentSelectors:If,decls:15,vars:19,consts:[["checkbox",""],["input",""],["label",""],["mat-internal-form-field","",3,"click","labelPosition"],[1,"mdc-checkbox"],[1,"mat-mdc-checkbox-touch-target",3,"click"],["type","checkbox",1,"mdc-checkbox__native-control",3,"blur","click","change","checked","indeterminate","disabled","id","required","tabIndex"],[1,"mdc-checkbox__ripple"],[1,"mdc-checkbox__background"],["focusable","false","viewBox","0 0 24 24","aria-hidden","true",1,"mdc-checkbox__checkmark"],["fill","none","d","M1.73,12.91 8.1,19.28 22.79,4.59",1,"mdc-checkbox__checkmark-path"],[1,"mdc-checkbox__mixedmark"],["mat-ripple","",1,"mat-mdc-checkbox-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mdc-label",3,"for"]],template:function(r,i){if(r&1){let o=vu();Eu(),Tt(0,"div",3),Vr("click",function(l){return Gt(o),Kt(i._preventBubblingFromLabel(l))}),Tt(1,"div",4,0)(3,"div",5),Vr("click",function(){return Gt(o),Kt(i._onTouchTargetClick())}),kt(),Tt(4,"input",6,1),Vr("blur",function(){return Gt(o),Kt(i._onBlur())})("click",function(){return Gt(o),Kt(i._onInputClick())})("change",function(l){return Gt(o),Kt(i._onInteractionEvent(l))}),kt(),qn(6,"div",7),Tt(7,"div",8),fu(),Tt(8,"svg",9),qn(9,"path",10),kt(),mu(),qn(10,"div",11),kt(),qn(11,"div",12),kt(),Tt(12,"label",13,2),Tu(14),kt()()}if(r&2){let o=ku(2);Un("labelPosition",i.labelPosition),Dr(4),ds("mdc-checkbox--selected",i.checked),Un("checked",i.checked)("indeterminate",i.indeterminate)("disabled",i.disabled)("id",i.inputId)("required",i.required)("tabIndex",i.disabled?-1:i.tabIndex),hs("aria-label",i.ariaLabel||null)("aria-labelledby",i.ariaLabelledby)("aria-describedby",i.ariaDescribedby)("aria-checked",i.indeterminate?"mixed":null)("name",i.name)("value",i.value),Dr(7),Un("matRippleTrigger",o)("matRippleDisabled",i.disableRipple||i.disabled)("matRippleCentered",!0),Dr(),Un("for",i.inputId)}},dependencies:[ms,Du],styles:['.mdc-touch-target-wrapper{display:inline}@keyframes mdc-checkbox-unchecked-checked-checkmark-path{0%,50%{stroke-dashoffset:29.7833385}50%{animation-timing-function:cubic-bezier(0, 0, 0.2, 1)}100%{stroke-dashoffset:0}}@keyframes mdc-checkbox-unchecked-indeterminate-mixedmark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0, 0, 0, 1)}100%{transform:scaleX(1)}}@keyframes mdc-checkbox-checked-unchecked-checkmark-path{from{animation-timing-function:cubic-bezier(0.4, 0, 1, 1);opacity:1;stroke-dashoffset:0}to{opacity:0;stroke-dashoffset:-29.7833385}}@keyframes mdc-checkbox-checked-indeterminate-checkmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(45deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-checked-checkmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(45deg);opacity:0}to{transform:rotate(360deg);opacity:1}}@keyframes mdc-checkbox-checked-indeterminate-mixedmark{from{animation-timing-function:mdc-animation-deceleration-curve-timing-function;transform:rotate(-45deg);opacity:0}to{transform:rotate(0deg);opacity:1}}@keyframes mdc-checkbox-indeterminate-checked-mixedmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(315deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-unchecked-mixedmark{0%{animation-timing-function:linear;transform:scaleX(1);opacity:1}32.8%,100%{transform:scaleX(0);opacity:0}}.mdc-checkbox{display:inline-block;position:relative;flex:0 0 18px;box-sizing:content-box;width:18px;height:18px;line-height:0;white-space:nowrap;cursor:pointer;vertical-align:bottom}.mdc-checkbox[hidden]{display:none}.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%}@media screen and (forced-colors: active){.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring{border-color:CanvasText}}.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring::after,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__focus-ring::after,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__focus-ring::after{border-color:CanvasText}}@media all and (-ms-high-contrast: none){.mdc-checkbox .mdc-checkbox__focus-ring{display:none}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-checkbox__mixedmark{margin:0 1px}}.mdc-checkbox--disabled{cursor:default;pointer-events:none}.mdc-checkbox__background{display:inline-flex;position:absolute;align-items:center;justify-content:center;box-sizing:border-box;width:18px;height:18px;border:2px solid currentColor;border-radius:2px;background-color:rgba(0,0,0,0);pointer-events:none;will-change:background-color,border-color;transition:background-color 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),border-color 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__checkmark{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;opacity:0;transition:opacity 180ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox--upgraded .mdc-checkbox__checkmark{opacity:1}.mdc-checkbox__checkmark-path{transition:stroke-dashoffset 180ms 0ms cubic-bezier(0.4, 0, 0.6, 1);stroke:currentColor;stroke-width:3.12px;stroke-dashoffset:29.7833385;stroke-dasharray:29.7833385}.mdc-checkbox__mixedmark{width:100%;height:0;transform:scaleX(0) rotate(0deg);border-width:1px;border-style:solid;opacity:0;transition:opacity 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__background,.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__background,.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__background,.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__background{animation-duration:180ms;animation-timing-function:linear}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-unchecked-checked-checkmark-path 180ms linear 0s;transition:none}.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-unchecked-indeterminate-mixedmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-checked-unchecked-checkmark-path 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__checkmark{animation:mdc-checkbox-checked-indeterminate-checkmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-checked-indeterminate-mixedmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__checkmark{animation:mdc-checkbox-indeterminate-checked-checkmark 500ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-checked-mixedmark 500ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-unchecked-mixedmark 300ms linear 0s;transition:none}.mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background{transition:border-color 90ms 0ms cubic-bezier(0, 0, 0.2, 1),background-color 90ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__checkmark-path{stroke-dashoffset:0}.mdc-checkbox__native-control{position:absolute;margin:0;padding:0;opacity:0;cursor:inherit}.mdc-checkbox__native-control:disabled{cursor:default;pointer-events:none}.mdc-checkbox--touch{margin:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2)}.mdc-checkbox--touch .mdc-checkbox__native-control{top:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);right:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);left:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);width:var(--mdc-checkbox-state-layer-size);height:var(--mdc-checkbox-state-layer-size)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark{transition:opacity 180ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 180ms 0ms cubic-bezier(0, 0, 0.2, 1);opacity:1}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(-45deg)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__checkmark{transform:rotate(45deg);opacity:0;transition:opacity 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__mixedmark,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(0deg);opacity:1}.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__checkmark,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__checkmark-path,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__mixedmark{transition:none}.mdc-checkbox{padding:calc((var(--mdc-checkbox-state-layer-size) - 18px) / 2);margin:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2)}.mdc-checkbox .mdc-checkbox__native-control[disabled]:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-disabled-unselected-icon-color);background-color:transparent}.mdc-checkbox .mdc-checkbox__native-control[disabled]:checked~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[disabled]:indeterminate~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[data-indeterminate=true][disabled]~.mdc-checkbox__background{border-color:transparent;background-color:var(--mdc-checkbox-disabled-selected-icon-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:var(--mdc-checkbox-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:var(--mdc-checkbox-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:var(--mdc-checkbox-disabled-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:var(--mdc-checkbox-disabled-selected-checkmark-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-icon-color);background-color:transparent}.mdc-checkbox .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-icon-color);background-color:var(--mdc-checkbox-selected-icon-color)}@keyframes mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336{0%{border-color:var(--mdc-checkbox-unselected-icon-color);background-color:transparent}50%{border-color:var(--mdc-checkbox-selected-icon-color);background-color:var(--mdc-checkbox-selected-icon-color)}}@keyframes mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336{0%,80%{border-color:var(--mdc-checkbox-selected-icon-color);background-color:var(--mdc-checkbox-selected-icon-color)}100%{border-color:var(--mdc-checkbox-unselected-icon-color);background-color:transparent}}.mdc-checkbox.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox:hover .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-hover-icon-color);background-color:transparent}.mdc-checkbox:hover .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox:hover .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox:hover .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-hover-icon-color);background-color:var(--mdc-checkbox-selected-hover-icon-color)}@keyframes mdc-checkbox-fade-in-background-FF212121FFF4433600000000FFF44336{0%{border-color:var(--mdc-checkbox-unselected-hover-icon-color);background-color:transparent}50%{border-color:var(--mdc-checkbox-selected-hover-icon-color);background-color:var(--mdc-checkbox-selected-hover-icon-color)}}@keyframes mdc-checkbox-fade-out-background-FF212121FFF4433600000000FFF44336{0%,80%{border-color:var(--mdc-checkbox-selected-hover-icon-color);background-color:var(--mdc-checkbox-selected-hover-icon-color)}100%{border-color:var(--mdc-checkbox-unselected-hover-icon-color);background-color:transparent}}.mdc-checkbox:hover.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:hover.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-FF212121FFF4433600000000FFF44336}.mdc-checkbox:hover.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:hover.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-FF212121FFF4433600000000FFF44336}.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-pressed-icon-color);background-color:transparent}.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-pressed-icon-color);background-color:var(--mdc-checkbox-selected-pressed-icon-color)}@keyframes mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336{0%{border-color:var(--mdc-checkbox-unselected-pressed-icon-color);background-color:transparent}50%{border-color:var(--mdc-checkbox-selected-pressed-icon-color);background-color:var(--mdc-checkbox-selected-pressed-icon-color)}}@keyframes mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336{0%,80%{border-color:var(--mdc-checkbox-selected-pressed-icon-color);background-color:var(--mdc-checkbox-selected-pressed-icon-color)}100%{border-color:var(--mdc-checkbox-unselected-pressed-icon-color);background-color:transparent}}.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox:not(:disabled):active.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-8A000000FFF4433600000000FFF44336}.mdc-checkbox .mdc-checkbox__background{top:calc((var(--mdc-checkbox-state-layer-size) - 18px) / 2);left:calc((var(--mdc-checkbox-state-layer-size) - 18px) / 2)}.mdc-checkbox .mdc-checkbox__native-control{top:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);right:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);left:calc((var(--mdc-checkbox-state-layer-size) - var(--mdc-checkbox-state-layer-size)) / 2);width:var(--mdc-checkbox-state-layer-size);height:var(--mdc-checkbox-state-layer-size)}.mdc-checkbox .mdc-checkbox__native-control:enabled:focus:focus:not(:checked):not(:indeterminate)~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-focus-icon-color)}.mdc-checkbox .mdc-checkbox__native-control:enabled:focus:checked~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control:enabled:focus:indeterminate~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-focus-icon-color);background-color:var(--mdc-checkbox-selected-focus-icon-color)}.mdc-checkbox:hover .mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-hover-state-layer-opacity);background-color:var(--mdc-checkbox-unselected-hover-state-layer-color)}.mdc-checkbox:hover .mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-hover-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-focus-state-layer-opacity);background-color:var(--mdc-checkbox-unselected-focus-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-focus-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-pressed-state-layer-opacity);background-color:var(--mdc-checkbox-unselected-pressed-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-pressed-state-layer-color)}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-hover-state-layer-opacity);background-color:var(--mdc-checkbox-selected-hover-state-layer-color)}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-hover-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-focus-state-layer-opacity);background-color:var(--mdc-checkbox-selected-focus-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-focus-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-pressed-state-layer-opacity);background-color:var(--mdc-checkbox-selected-pressed-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-pressed-state-layer-color)}.mat-mdc-checkbox{display:inline-block;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-checkbox .mdc-checkbox__background{-webkit-print-color-adjust:exact;color-adjust:exact}.mat-mdc-checkbox._mat-animation-noopable *,.mat-mdc-checkbox._mat-animation-noopable *::before{transition:none !important;animation:none !important}.mat-mdc-checkbox label{cursor:pointer}.mat-mdc-checkbox.mat-mdc-checkbox-disabled label{cursor:default;color:var(--mat-checkbox-disabled-label-color)}.mat-mdc-checkbox label:empty{display:none}.cdk-high-contrast-active .mat-mdc-checkbox.mat-mdc-checkbox-disabled{opacity:.5}.cdk-high-contrast-active .mat-mdc-checkbox .mdc-checkbox__checkmark{--mdc-checkbox-selected-checkmark-color: CanvasText;--mdc-checkbox-disabled-selected-checkmark-color: CanvasText}.mat-mdc-checkbox .mdc-checkbox__ripple{opacity:0}.mat-mdc-checkbox-ripple,.mdc-checkbox__ripple{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:50%;pointer-events:none}.mat-mdc-checkbox-ripple:not(:empty),.mdc-checkbox__ripple:not(:empty){transform:translateZ(0)}.mat-mdc-checkbox-ripple .mat-ripple-element{opacity:.1}.mat-mdc-checkbox-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-checkbox-touch-target-display)}.mat-mdc-checkbox-ripple::before{border-radius:50%}.mdc-checkbox__native-control:focus~.mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}}return n})();var f_=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=hu({type:n})}static{this.\u0275inj=cu({imports:[Ou,fs,fs]})}}return n})();var Mu=()=>{};var Uu=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Af=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){let o=n[t++],a=n[t++],l=n[t++],h=((i&7)<<18|(o&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{let o=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},qu={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let o=n[i],a=i+1<n.length,l=a?n[i+1]:0,h=i+2<n.length,d=h?n[i+2]:0,m=o>>2,b=(o&3)<<4|l>>4,E=(l&15)<<2|d>>6,S=d&63;h||(S=64,a||(E=64)),r.push(t[m],t[b],t[E],t[S])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Uu(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Af(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let o=t[n.charAt(i++)],l=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let b=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||l==null||d==null||b==null)throw new _s;let E=o<<2|l>>4;if(r.push(E),d!==64){let S=l<<4&240|d>>2;if(r.push(S),b!==64){let N=d<<6&192|b;r.push(N)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},_s=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},xf=function(n){let e=Uu(n);return qu.encodeByteArray(e,!0)},jn=function(n){return xf(n).replace(/\./g,"")},zu=function(n){try{return qu.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function ju(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var Sf=()=>ju().__FIREBASE_DEFAULTS__,Cf=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Rf=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&zu(n[1]);return e&&JSON.parse(e)},ys=()=>{try{return Mu()||Sf()||Cf()||Rf()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Pf=n=>ys()?.emulatorHosts?.[n],$u=n=>{let e=Pf(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},bs=()=>ys()?.config;var Mr=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Lr(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}function Gu(n){return x(this,null,function*(){return(yield fetch(n,{credentials:"include"})).ok})}function Ku(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=X({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[jn(JSON.stringify(t)),jn(JSON.stringify(a)),""].join(".")}var zn={};function Df(){let n={prod:[],emulator:[]};for(let e of Object.keys(zn))zn[e]?n.emulator.push(e):n.prod.push(e);return n}function Vf(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var Lu=!1;function Qu(n,e){if(typeof window>"u"||typeof document>"u"||!Lr(window.location.host)||zn[n]===e||zn[n]||Lu)return;zn[n]=e;function t(E){return`__firebase__banner__${E}`}let r="__firebase__banner",o=Df().prod.length>0;function a(){let E=document.getElementById(r);E&&E.remove()}function l(E){E.style.display="flex",E.style.background="#7faaf0",E.style.position="fixed",E.style.bottom="5px",E.style.left="5px",E.style.padding=".5em",E.style.borderRadius="5px",E.style.alignItems="center"}function h(E,S){E.setAttribute("width","24"),E.setAttribute("id",S),E.setAttribute("height","24"),E.setAttribute("viewBox","0 0 24 24"),E.setAttribute("fill","none"),E.style.marginLeft="-6px"}function d(){let E=document.createElement("span");return E.style.cursor="pointer",E.style.marginLeft="16px",E.style.fontSize="24px",E.innerHTML=" &times;",E.onclick=()=>{Lu=!0,a()},E}function m(E,S){E.setAttribute("id",S),E.innerText="Learn more",E.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",E.setAttribute("target","__blank"),E.style.paddingLeft="5px",E.style.textDecoration="underline"}function b(){let E=Vf(r),S=t("text"),N=document.getElementById(S)||document.createElement("span"),F=t("learnmore"),P=document.getElementById(F)||document.createElement("a"),G=t("preprendIcon"),K=document.getElementById(G)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(E.created){let Q=E.element;l(Q),m(P,F);let _e=d();h(K,G),Q.append(K,N,P,_e),document.body.appendChild(Q)}o?(N.innerText="Preview backend disconnected.",K.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(K.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,N.innerText="Preview backend running in this workspace."),N.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",b):b()}function Hu(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Nf(){let n=ys()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Wu(){return!Nf()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ws(){try{return typeof indexedDB=="object"}catch{return!1}}function Ju(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}var Ff="FirebaseError",je=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=Ff,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,$n.prototype.create)}},$n=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?Of(o,r):"Error",l=`${this.serviceName}: ${a} (${i}).`;return new je(i,l,r)}};function Of(n,e){return n.replace(Mf,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var Mf=/\{\$([^}]+)}/g;function Wt(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let o=n[i],a=e[i];if(Bu(o)&&Bu(a)){if(!Wt(o,a))return!1}else if(o!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function Bu(n){return n!==null&&typeof n=="object"}var __=4*60*60*1e3;function Se(n){return n&&n._delegate?n._delegate:n}var $e=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var At="[DEFAULT]";var vs=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Mr;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Bf(e))try{this.getOrInitializeService({instanceIdentifier:At})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=At){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return x(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=At){return this.instances.has(e)}getOptions(e=At){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[o,a]of this.instancesDeferred.entries()){let l=this.normalizeInstanceIdentifier(o);r===l&&a.resolve(i)}return i}onInit(e,t){let r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);let o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Lf(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=At){return this.component?this.component.multipleInstances?e:At:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Lf(n){return n===At?void 0:n}function Bf(n){return n.instantiationMode==="EAGER"}var Br=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new vs(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var Uf=[],j=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(j||{}),qf={debug:j.DEBUG,verbose:j.VERBOSE,info:j.INFO,warn:j.WARN,error:j.ERROR,silent:j.SILENT},zf=j.INFO,jf={[j.DEBUG]:"log",[j.VERBOSE]:"log",[j.INFO]:"info",[j.WARN]:"warn",[j.ERROR]:"error"},$f=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=jf[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Jt=class{constructor(e){this.name=e,this._logLevel=zf,this._logHandler=$f,this._userLogHandler=null,Uf.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in j))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?qf[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,j.DEBUG,...e),this._logHandler(this,j.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,j.VERBOSE,...e),this._logHandler(this,j.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,j.INFO,...e),this._logHandler(this,j.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,j.WARN,...e),this._logHandler(this,j.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,j.ERROR,...e),this._logHandler(this,j.ERROR,...e)}};var Gf=(n,e)=>e.some(t=>n instanceof t),Xu,Yu;function Kf(){return Xu||(Xu=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Qf(){return Yu||(Yu=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Zu=new WeakMap,Es=new WeakMap,el=new WeakMap,Is=new WeakMap,ks=new WeakMap;function Hf(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",a)},o=()=>{t(Fe(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&Zu.set(t,n)}).catch(()=>{}),ks.set(e,n),e}function Wf(n){if(Es.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",a),n.removeEventListener("abort",a)},o=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",a),n.addEventListener("abort",a)});Es.set(n,e)}var Ts={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Es.get(n);if(e==="objectStoreNames")return n.objectStoreNames||el.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Fe(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function tl(n){Ts=n(Ts)}function Jf(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Ur(this),e,...t);return el.set(r,e.sort?e.sort():[e]),Fe(r)}:Qf().includes(n)?function(...e){return n.apply(Ur(this),e),Fe(Zu.get(this))}:function(...e){return Fe(n.apply(Ur(this),e))}}function Xf(n){return typeof n=="function"?Jf(n):(n instanceof IDBTransaction&&Wf(n),Gf(n,Kf())?new Proxy(n,Ts):n)}function Fe(n){if(n instanceof IDBRequest)return Hf(n);if(Is.has(n))return Is.get(n);let e=Xf(n);return e!==n&&(Is.set(n,e),ks.set(e,n)),e}var Ur=n=>ks.get(n);function rl(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){let a=indexedDB.open(n,e),l=Fe(a);return r&&a.addEventListener("upgradeneeded",h=>{r(Fe(a.result),h.oldVersion,h.newVersion,Fe(a.transaction),h)}),t&&a.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),l.then(h=>{o&&h.addEventListener("close",()=>o()),i&&h.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}var Yf=["get","getKey","getAll","getAllKeys","count"],Zf=["put","add","delete","clear"],As=new Map;function nl(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(As.get(e))return As.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=Zf.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Yf.includes(t)))return;let o=function(a,...l){return x(this,null,function*(){let h=this.transaction(a,i?"readwrite":"readonly"),d=h.store;return r&&(d=d.index(l.shift())),(yield Promise.all([d[t](...l),i&&h.done]))[0]})};return As.set(e,o),o}tl(n=>Ve(X({},n),{get:(e,t,r)=>nl(e,t)||n.get(e,t,r),has:(e,t)=>!!nl(e,t)||n.has(e,t)}));var Ss=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(em(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function em(n){return n.getComponent()?.type==="VERSION"}var Cs="@firebase/app",il="0.14.6";var Ge=new Jt("@firebase/app"),tm="@firebase/app-compat",nm="@firebase/analytics-compat",rm="@firebase/analytics",im="@firebase/app-check-compat",sm="@firebase/app-check",om="@firebase/auth",am="@firebase/auth-compat",cm="@firebase/database",um="@firebase/data-connect",lm="@firebase/database-compat",hm="@firebase/functions",dm="@firebase/functions-compat",fm="@firebase/installations",mm="@firebase/installations-compat",pm="@firebase/messaging",gm="@firebase/messaging-compat",_m="@firebase/performance",ym="@firebase/performance-compat",bm="@firebase/remote-config",wm="@firebase/remote-config-compat",vm="@firebase/storage",Im="@firebase/storage-compat",Em="@firebase/firestore",Tm="@firebase/ai",km="@firebase/firestore-compat",Am="firebase",xm="12.6.0";var Rs="[DEFAULT]",Sm={[Cs]:"fire-core",[tm]:"fire-core-compat",[rm]:"fire-analytics",[nm]:"fire-analytics-compat",[sm]:"fire-app-check",[im]:"fire-app-check-compat",[om]:"fire-auth",[am]:"fire-auth-compat",[cm]:"fire-rtdb",[um]:"fire-data-connect",[lm]:"fire-rtdb-compat",[hm]:"fire-fn",[dm]:"fire-fn-compat",[fm]:"fire-iid",[mm]:"fire-iid-compat",[pm]:"fire-fcm",[gm]:"fire-fcm-compat",[_m]:"fire-perf",[ym]:"fire-perf-compat",[bm]:"fire-rc",[wm]:"fire-rc-compat",[vm]:"fire-gcs",[Im]:"fire-gcs-compat",[Em]:"fire-fst",[km]:"fire-fst-compat",[Tm]:"fire-vertex","fire-js":"fire-js",[Am]:"fire-js-all"};var qr=new Map,Cm=new Map,Ps=new Map;function sl(n,e){try{n.container.addComponent(e)}catch(t){Ge.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Gn(n){let e=n.name;if(Ps.has(e))return Ge.debug(`There were multiple attempts to register component ${e}.`),!1;Ps.set(e,n);for(let t of qr.values())sl(t,n);for(let t of Cm.values())sl(t,n);return!0}function ul(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function ll(n){return n==null?!1:n.settings!==void 0}var Rm={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ct=new $n("app","Firebase",Rm);var Ds=class{constructor(e,t,r){this._isDeleted=!1,this._options=X({},e),this._config=X({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new $e("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ct.create("app-deleted",{appName:this._name})}};var hl=xm;function Fs(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=X({name:Rs,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw ct.create("bad-app-name",{appName:String(i)});if(t||(t=bs()),!t)throw ct.create("no-options");let o=qr.get(i);if(o){if(Wt(t,o.options)&&Wt(r,o.config))return o;throw ct.create("duplicate-app",{appName:i})}let a=new Br(i);for(let h of Ps.values())a.addComponent(h);let l=new Ds(t,r,a);return qr.set(i,l),l}function dl(n=Rs){let e=qr.get(n);if(!e&&n===Rs&&bs())return Fs();if(!e)throw ct.create("no-app",{appName:n});return e}function ut(n,e,t){let r=Sm[n]??n;t&&(r+=`-${t}`);let i=r.match(/\s|\//),o=e.match(/\s|\//);if(i||o){let a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ge.warn(a.join(" "));return}Gn(new $e(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var Pm="firebase-heartbeat-database",Dm=1,Kn="firebase-heartbeat-store",xs=null;function fl(){return xs||(xs=rl(Pm,Dm,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Kn)}catch(t){console.warn(t)}}}}).catch(n=>{throw ct.create("idb-open",{originalErrorMessage:n.message})})),xs}function Vm(n){return x(this,null,function*(){try{let t=(yield fl()).transaction(Kn),r=yield t.objectStore(Kn).get(ml(n));return yield t.done,r}catch(e){if(e instanceof je)Ge.warn(e.message);else{let t=ct.create("idb-get",{originalErrorMessage:e?.message});Ge.warn(t.message)}}})}function ol(n,e){return x(this,null,function*(){try{let r=(yield fl()).transaction(Kn,"readwrite");yield r.objectStore(Kn).put(e,ml(n)),yield r.done}catch(t){if(t instanceof je)Ge.warn(t.message);else{let r=ct.create("idb-set",{originalErrorMessage:t?.message});Ge.warn(r.message)}}})}function ml(n){return`${n.name}!${n.options.appId}`}var Nm=1024,Fm=30,Vs=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Ns(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return x(this,null,function*(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=al();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>Fm){let i=Mm(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Ge.warn(e)}})}getHeartbeatsHeader(){return x(this,null,function*(){try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=al(),{heartbeatsToSend:t,unsentEntries:r}=Om(this._heartbeatsCache.heartbeats),i=jn(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Ge.warn(e),""}})}};function al(){return new Date().toISOString().substring(0,10)}function Om(n,e=Nm){let t=[],r=n.slice();for(let i of n){let o=t.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),cl(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),cl(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Ns=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return x(this,null,function*(){return ws()?Ju().then(()=>!0).catch(()=>!1):!1})}read(){return x(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield Vm(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return x(this,null,function*(){if(yield this._canUseIndexedDBPromise){let r=yield this.read();return ol(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return x(this,null,function*(){if(yield this._canUseIndexedDBPromise){let r=yield this.read();return ol(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return})}};function cl(n){return jn(JSON.stringify({version:2,heartbeats:n})).length}function Mm(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function Lm(n){Gn(new $e("platform-logger",e=>new Ss(e),"PRIVATE")),Gn(new $e("heartbeat",e=>new Vs(e),"PRIVATE")),ut(Cs,il,n),ut(Cs,il,"esm2020"),ut("fire-js","")}Lm("");var Bm="firebase",Um="12.7.0";ut(Bm,Um,"app");var pl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},gl={};var Ke,Os;(function(){var n;function e(w,p){function _(){}_.prototype=p.prototype,w.F=p.prototype,w.prototype=new _,w.prototype.constructor=w,w.D=function(v,y,T){for(var g=Array(arguments.length-2),ve=2;ve<arguments.length;ve++)g[ve-2]=arguments[ve];return p.prototype[y].apply(v,g)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,p,_){_||(_=0);let v=Array(16);if(typeof p=="string")for(var y=0;y<16;++y)v[y]=p.charCodeAt(_++)|p.charCodeAt(_++)<<8|p.charCodeAt(_++)<<16|p.charCodeAt(_++)<<24;else for(y=0;y<16;++y)v[y]=p[_++]|p[_++]<<8|p[_++]<<16|p[_++]<<24;p=w.g[0],_=w.g[1],y=w.g[2];let T=w.g[3],g;g=p+(T^_&(y^T))+v[0]+3614090360&4294967295,p=_+(g<<7&4294967295|g>>>25),g=T+(y^p&(_^y))+v[1]+3905402710&4294967295,T=p+(g<<12&4294967295|g>>>20),g=y+(_^T&(p^_))+v[2]+606105819&4294967295,y=T+(g<<17&4294967295|g>>>15),g=_+(p^y&(T^p))+v[3]+3250441966&4294967295,_=y+(g<<22&4294967295|g>>>10),g=p+(T^_&(y^T))+v[4]+4118548399&4294967295,p=_+(g<<7&4294967295|g>>>25),g=T+(y^p&(_^y))+v[5]+1200080426&4294967295,T=p+(g<<12&4294967295|g>>>20),g=y+(_^T&(p^_))+v[6]+2821735955&4294967295,y=T+(g<<17&4294967295|g>>>15),g=_+(p^y&(T^p))+v[7]+4249261313&4294967295,_=y+(g<<22&4294967295|g>>>10),g=p+(T^_&(y^T))+v[8]+1770035416&4294967295,p=_+(g<<7&4294967295|g>>>25),g=T+(y^p&(_^y))+v[9]+2336552879&4294967295,T=p+(g<<12&4294967295|g>>>20),g=y+(_^T&(p^_))+v[10]+4294925233&4294967295,y=T+(g<<17&4294967295|g>>>15),g=_+(p^y&(T^p))+v[11]+2304563134&4294967295,_=y+(g<<22&4294967295|g>>>10),g=p+(T^_&(y^T))+v[12]+1804603682&4294967295,p=_+(g<<7&4294967295|g>>>25),g=T+(y^p&(_^y))+v[13]+4254626195&4294967295,T=p+(g<<12&4294967295|g>>>20),g=y+(_^T&(p^_))+v[14]+2792965006&4294967295,y=T+(g<<17&4294967295|g>>>15),g=_+(p^y&(T^p))+v[15]+1236535329&4294967295,_=y+(g<<22&4294967295|g>>>10),g=p+(y^T&(_^y))+v[1]+4129170786&4294967295,p=_+(g<<5&4294967295|g>>>27),g=T+(_^y&(p^_))+v[6]+3225465664&4294967295,T=p+(g<<9&4294967295|g>>>23),g=y+(p^_&(T^p))+v[11]+643717713&4294967295,y=T+(g<<14&4294967295|g>>>18),g=_+(T^p&(y^T))+v[0]+3921069994&4294967295,_=y+(g<<20&4294967295|g>>>12),g=p+(y^T&(_^y))+v[5]+3593408605&4294967295,p=_+(g<<5&4294967295|g>>>27),g=T+(_^y&(p^_))+v[10]+38016083&4294967295,T=p+(g<<9&4294967295|g>>>23),g=y+(p^_&(T^p))+v[15]+3634488961&4294967295,y=T+(g<<14&4294967295|g>>>18),g=_+(T^p&(y^T))+v[4]+3889429448&4294967295,_=y+(g<<20&4294967295|g>>>12),g=p+(y^T&(_^y))+v[9]+568446438&4294967295,p=_+(g<<5&4294967295|g>>>27),g=T+(_^y&(p^_))+v[14]+3275163606&4294967295,T=p+(g<<9&4294967295|g>>>23),g=y+(p^_&(T^p))+v[3]+4107603335&4294967295,y=T+(g<<14&4294967295|g>>>18),g=_+(T^p&(y^T))+v[8]+1163531501&4294967295,_=y+(g<<20&4294967295|g>>>12),g=p+(y^T&(_^y))+v[13]+2850285829&4294967295,p=_+(g<<5&4294967295|g>>>27),g=T+(_^y&(p^_))+v[2]+4243563512&4294967295,T=p+(g<<9&4294967295|g>>>23),g=y+(p^_&(T^p))+v[7]+1735328473&4294967295,y=T+(g<<14&4294967295|g>>>18),g=_+(T^p&(y^T))+v[12]+2368359562&4294967295,_=y+(g<<20&4294967295|g>>>12),g=p+(_^y^T)+v[5]+4294588738&4294967295,p=_+(g<<4&4294967295|g>>>28),g=T+(p^_^y)+v[8]+2272392833&4294967295,T=p+(g<<11&4294967295|g>>>21),g=y+(T^p^_)+v[11]+1839030562&4294967295,y=T+(g<<16&4294967295|g>>>16),g=_+(y^T^p)+v[14]+4259657740&4294967295,_=y+(g<<23&4294967295|g>>>9),g=p+(_^y^T)+v[1]+2763975236&4294967295,p=_+(g<<4&4294967295|g>>>28),g=T+(p^_^y)+v[4]+1272893353&4294967295,T=p+(g<<11&4294967295|g>>>21),g=y+(T^p^_)+v[7]+4139469664&4294967295,y=T+(g<<16&4294967295|g>>>16),g=_+(y^T^p)+v[10]+3200236656&4294967295,_=y+(g<<23&4294967295|g>>>9),g=p+(_^y^T)+v[13]+681279174&4294967295,p=_+(g<<4&4294967295|g>>>28),g=T+(p^_^y)+v[0]+3936430074&4294967295,T=p+(g<<11&4294967295|g>>>21),g=y+(T^p^_)+v[3]+3572445317&4294967295,y=T+(g<<16&4294967295|g>>>16),g=_+(y^T^p)+v[6]+76029189&4294967295,_=y+(g<<23&4294967295|g>>>9),g=p+(_^y^T)+v[9]+3654602809&4294967295,p=_+(g<<4&4294967295|g>>>28),g=T+(p^_^y)+v[12]+3873151461&4294967295,T=p+(g<<11&4294967295|g>>>21),g=y+(T^p^_)+v[15]+530742520&4294967295,y=T+(g<<16&4294967295|g>>>16),g=_+(y^T^p)+v[2]+3299628645&4294967295,_=y+(g<<23&4294967295|g>>>9),g=p+(y^(_|~T))+v[0]+4096336452&4294967295,p=_+(g<<6&4294967295|g>>>26),g=T+(_^(p|~y))+v[7]+1126891415&4294967295,T=p+(g<<10&4294967295|g>>>22),g=y+(p^(T|~_))+v[14]+2878612391&4294967295,y=T+(g<<15&4294967295|g>>>17),g=_+(T^(y|~p))+v[5]+4237533241&4294967295,_=y+(g<<21&4294967295|g>>>11),g=p+(y^(_|~T))+v[12]+1700485571&4294967295,p=_+(g<<6&4294967295|g>>>26),g=T+(_^(p|~y))+v[3]+2399980690&4294967295,T=p+(g<<10&4294967295|g>>>22),g=y+(p^(T|~_))+v[10]+4293915773&4294967295,y=T+(g<<15&4294967295|g>>>17),g=_+(T^(y|~p))+v[1]+2240044497&4294967295,_=y+(g<<21&4294967295|g>>>11),g=p+(y^(_|~T))+v[8]+1873313359&4294967295,p=_+(g<<6&4294967295|g>>>26),g=T+(_^(p|~y))+v[15]+4264355552&4294967295,T=p+(g<<10&4294967295|g>>>22),g=y+(p^(T|~_))+v[6]+2734768916&4294967295,y=T+(g<<15&4294967295|g>>>17),g=_+(T^(y|~p))+v[13]+1309151649&4294967295,_=y+(g<<21&4294967295|g>>>11),g=p+(y^(_|~T))+v[4]+4149444226&4294967295,p=_+(g<<6&4294967295|g>>>26),g=T+(_^(p|~y))+v[11]+3174756917&4294967295,T=p+(g<<10&4294967295|g>>>22),g=y+(p^(T|~_))+v[2]+718787259&4294967295,y=T+(g<<15&4294967295|g>>>17),g=_+(T^(y|~p))+v[9]+3951481745&4294967295,w.g[0]=w.g[0]+p&4294967295,w.g[1]=w.g[1]+(y+(g<<21&4294967295|g>>>11))&4294967295,w.g[2]=w.g[2]+y&4294967295,w.g[3]=w.g[3]+T&4294967295}r.prototype.v=function(w,p){p===void 0&&(p=w.length);let _=p-this.blockSize,v=this.C,y=this.h,T=0;for(;T<p;){if(y==0)for(;T<=_;)i(this,w,T),T+=this.blockSize;if(typeof w=="string"){for(;T<p;)if(v[y++]=w.charCodeAt(T++),y==this.blockSize){i(this,v),y=0;break}}else for(;T<p;)if(v[y++]=w[T++],y==this.blockSize){i(this,v),y=0;break}}this.h=y,this.o+=p},r.prototype.A=function(){var w=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);w[0]=128;for(var p=1;p<w.length-8;++p)w[p]=0;p=this.o*8;for(var _=w.length-8;_<w.length;++_)w[_]=p&255,p/=256;for(this.v(w),w=Array(16),p=0,_=0;_<4;++_)for(let v=0;v<32;v+=8)w[p++]=this.g[_]>>>v&255;return w};function o(w,p){var _=l;return Object.prototype.hasOwnProperty.call(_,w)?_[w]:_[w]=p(w)}function a(w,p){this.h=p;let _=[],v=!0;for(let y=w.length-1;y>=0;y--){let T=w[y]|0;v&&T==p||(_[y]=T,v=!1)}this.g=_}var l={};function h(w){return-128<=w&&w<128?o(w,function(p){return new a([p|0],p<0?-1:0)}):new a([w|0],w<0?-1:0)}function d(w){if(isNaN(w)||!isFinite(w))return b;if(w<0)return P(d(-w));let p=[],_=1;for(let v=0;w>=_;v++)p[v]=w/_|0,_*=4294967296;return new a(p,0)}function m(w,p){if(w.length==0)throw Error("number format error: empty string");if(p=p||10,p<2||36<p)throw Error("radix out of range: "+p);if(w.charAt(0)=="-")return P(m(w.substring(1),p));if(w.indexOf("-")>=0)throw Error('number format error: interior "-" character');let _=d(Math.pow(p,8)),v=b;for(let T=0;T<w.length;T+=8){var y=Math.min(8,w.length-T);let g=parseInt(w.substring(T,T+y),p);y<8?(y=d(Math.pow(p,y)),v=v.j(y).add(d(g))):(v=v.j(_),v=v.add(d(g)))}return v}var b=h(0),E=h(1),S=h(16777216);n=a.prototype,n.m=function(){if(F(this))return-P(this).m();let w=0,p=1;for(let _=0;_<this.g.length;_++){let v=this.i(_);w+=(v>=0?v:4294967296+v)*p,p*=4294967296}return w},n.toString=function(w){if(w=w||10,w<2||36<w)throw Error("radix out of range: "+w);if(N(this))return"0";if(F(this))return"-"+P(this).toString(w);let p=d(Math.pow(w,6));var _=this;let v="";for(;;){let y=_e(_,p).g;_=G(_,y.j(p));let T=((_.g.length>0?_.g[0]:_.h)>>>0).toString(w);if(_=y,N(_))return T+v;for(;T.length<6;)T="0"+T;v=T+v}},n.i=function(w){return w<0?0:w<this.g.length?this.g[w]:this.h};function N(w){if(w.h!=0)return!1;for(let p=0;p<w.g.length;p++)if(w.g[p]!=0)return!1;return!0}function F(w){return w.h==-1}n.l=function(w){return w=G(this,w),F(w)?-1:N(w)?0:1};function P(w){let p=w.g.length,_=[];for(let v=0;v<p;v++)_[v]=~w.g[v];return new a(_,~w.h).add(E)}n.abs=function(){return F(this)?P(this):this},n.add=function(w){let p=Math.max(this.g.length,w.g.length),_=[],v=0;for(let y=0;y<=p;y++){let T=v+(this.i(y)&65535)+(w.i(y)&65535),g=(T>>>16)+(this.i(y)>>>16)+(w.i(y)>>>16);v=g>>>16,T&=65535,g&=65535,_[y]=g<<16|T}return new a(_,_[_.length-1]&-2147483648?-1:0)};function G(w,p){return w.add(P(p))}n.j=function(w){if(N(this)||N(w))return b;if(F(this))return F(w)?P(this).j(P(w)):P(P(this).j(w));if(F(w))return P(this.j(P(w)));if(this.l(S)<0&&w.l(S)<0)return d(this.m()*w.m());let p=this.g.length+w.g.length,_=[];for(var v=0;v<2*p;v++)_[v]=0;for(v=0;v<this.g.length;v++)for(let y=0;y<w.g.length;y++){let T=this.i(v)>>>16,g=this.i(v)&65535,ve=w.i(y)>>>16,tt=w.i(y)&65535;_[2*v+2*y]+=g*tt,K(_,2*v+2*y),_[2*v+2*y+1]+=T*tt,K(_,2*v+2*y+1),_[2*v+2*y+1]+=g*ve,K(_,2*v+2*y+1),_[2*v+2*y+2]+=T*ve,K(_,2*v+2*y+2)}for(w=0;w<p;w++)_[w]=_[2*w+1]<<16|_[2*w];for(w=p;w<2*p;w++)_[w]=0;return new a(_,0)};function K(w,p){for(;(w[p]&65535)!=w[p];)w[p+1]+=w[p]>>>16,w[p]&=65535,p++}function Q(w,p){this.g=w,this.h=p}function _e(w,p){if(N(p))throw Error("division by zero");if(N(w))return new Q(b,b);if(F(w))return p=_e(P(w),p),new Q(P(p.g),P(p.h));if(F(p))return p=_e(w,P(p)),new Q(P(p.g),p.h);if(w.g.length>30){if(F(w)||F(p))throw Error("slowDivide_ only works with positive integers.");for(var _=E,v=p;v.l(w)<=0;)_=we(_),v=we(v);var y=ce(_,1),T=ce(v,1);for(v=ce(v,2),_=ce(_,2);!N(v);){var g=T.add(v);g.l(w)<=0&&(y=y.add(_),T=g),v=ce(v,1),_=ce(_,1)}return p=G(w,y.j(p)),new Q(y,p)}for(y=b;w.l(p)>=0;){for(_=Math.max(1,Math.floor(w.m()/p.m())),v=Math.ceil(Math.log(_)/Math.LN2),v=v<=48?1:Math.pow(2,v-48),T=d(_),g=T.j(p);F(g)||g.l(w)>0;)_-=v,T=d(_),g=T.j(p);N(T)&&(T=E),y=y.add(T),w=G(w,g)}return new Q(y,w)}n.B=function(w){return _e(this,w).h},n.and=function(w){let p=Math.max(this.g.length,w.g.length),_=[];for(let v=0;v<p;v++)_[v]=this.i(v)&w.i(v);return new a(_,this.h&w.h)},n.or=function(w){let p=Math.max(this.g.length,w.g.length),_=[];for(let v=0;v<p;v++)_[v]=this.i(v)|w.i(v);return new a(_,this.h|w.h)},n.xor=function(w){let p=Math.max(this.g.length,w.g.length),_=[];for(let v=0;v<p;v++)_[v]=this.i(v)^w.i(v);return new a(_,this.h^w.h)};function we(w){let p=w.g.length+1,_=[];for(let v=0;v<p;v++)_[v]=w.i(v)<<1|w.i(v-1)>>>31;return new a(_,w.h)}function ce(w,p){let _=p>>5;p%=32;let v=w.g.length-_,y=[];for(let T=0;T<v;T++)y[T]=p>0?w.i(T+_)>>>p|w.i(T+_+1)<<32-p:w.i(T+_);return new a(y,w.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,Os=gl.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=m,Ke=gl.Integer=a}).apply(typeof pl<"u"?pl:typeof self<"u"?self:typeof window<"u"?window:{});var zr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Qe={};var Ms,qm,Xt,Ls,Qn,jr,Bs,Us,qs;(function(){var n,e=Object.defineProperty;function t(s){s=[typeof globalThis=="object"&&globalThis,s,typeof window=="object"&&window,typeof self=="object"&&self,typeof zr=="object"&&zr];for(var c=0;c<s.length;++c){var u=s[c];if(u&&u.Math==Math)return u}throw Error("Cannot find global object")}var r=t(this);function i(s,c){if(c)e:{var u=r;s=s.split(".");for(var f=0;f<s.length-1;f++){var I=s[f];if(!(I in u))break e;u=u[I]}s=s[s.length-1],f=u[s],c=c(f),c!=f&&c!=null&&e(u,s,{configurable:!0,writable:!0,value:c})}}i("Symbol.dispose",function(s){return s||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(s){return s||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(s){return s||function(c){var u=[],f;for(f in c)Object.prototype.hasOwnProperty.call(c,f)&&u.push([f,c[f]]);return u}});var o=o||{},a=this||self;function l(s){var c=typeof s;return c=="object"&&s!=null||c=="function"}function h(s,c,u){return s.call.apply(s.bind,arguments)}function d(s,c,u){return d=h,d.apply(null,arguments)}function m(s,c){var u=Array.prototype.slice.call(arguments,1);return function(){var f=u.slice();return f.push.apply(f,arguments),s.apply(this,f)}}function b(s,c){function u(){}u.prototype=c.prototype,s.Z=c.prototype,s.prototype=new u,s.prototype.constructor=s,s.Ob=function(f,I,k){for(var R=Array(arguments.length-2),U=2;U<arguments.length;U++)R[U-2]=arguments[U];return c.prototype[I].apply(f,R)}}var E=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?s=>s&&AsyncContext.Snapshot.wrap(s):s=>s;function S(s){let c=s.length;if(c>0){let u=Array(c);for(let f=0;f<c;f++)u[f]=s[f];return u}return[]}function N(s,c){for(let f=1;f<arguments.length;f++){let I=arguments[f];var u=typeof I;if(u=u!="object"?u:I?Array.isArray(I)?"array":u:"null",u=="array"||u=="object"&&typeof I.length=="number"){u=s.length||0;let k=I.length||0;s.length=u+k;for(let R=0;R<k;R++)s[u+R]=I[R]}else s.push(I)}}class F{constructor(c,u){this.i=c,this.j=u,this.h=0,this.g=null}get(){let c;return this.h>0?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function P(s){a.setTimeout(()=>{throw s},0)}function G(){var s=w;let c=null;return s.g&&(c=s.g,s.g=s.g.next,s.g||(s.h=null),c.next=null),c}class K{constructor(){this.h=this.g=null}add(c,u){let f=Q.get();f.set(c,u),this.h?this.h.next=f:this.g=f,this.h=f}}var Q=new F(()=>new _e,s=>s.reset());class _e{constructor(){this.next=this.g=this.h=null}set(c,u){this.h=c,this.g=u,this.next=null}reset(){this.next=this.g=this.h=null}}let we,ce=!1,w=new K,p=()=>{let s=Promise.resolve(void 0);we=()=>{s.then(_)}};function _(){for(var s;s=G();){try{s.h.call(s.g)}catch(u){P(u)}var c=Q;c.j(s),c.h<100&&(c.h++,s.next=c.g,c.g=s)}ce=!1}function v(){this.u=this.u,this.C=this.C}v.prototype.u=!1,v.prototype.dispose=function(){this.u||(this.u=!0,this.N())},v.prototype[Symbol.dispose]=function(){this.dispose()},v.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function y(s,c){this.type=s,this.g=this.target=c,this.defaultPrevented=!1}y.prototype.h=function(){this.defaultPrevented=!0};var T=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var s=!1,c=Object.defineProperty({},"passive",{get:function(){s=!0}});try{let u=()=>{};a.addEventListener("test",u,c),a.removeEventListener("test",u,c)}catch{}return s}();function g(s){return/^[\s\xa0]*$/.test(s)}function ve(s,c){y.call(this,s?s.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,s&&this.init(s,c)}b(ve,y),ve.prototype.init=function(s,c){let u=this.type=s.type,f=s.changedTouches&&s.changedTouches.length?s.changedTouches[0]:null;this.target=s.target||s.srcElement,this.g=c,c=s.relatedTarget,c||(u=="mouseover"?c=s.fromElement:u=="mouseout"&&(c=s.toElement)),this.relatedTarget=c,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0),this.button=s.button,this.key=s.key||"",this.ctrlKey=s.ctrlKey,this.altKey=s.altKey,this.shiftKey=s.shiftKey,this.metaKey=s.metaKey,this.pointerId=s.pointerId||0,this.pointerType=s.pointerType,this.state=s.state,this.i=s,s.defaultPrevented&&ve.Z.h.call(this)},ve.prototype.h=function(){ve.Z.h.call(this);let s=this.i;s.preventDefault?s.preventDefault():s.returnValue=!1};var tt="closure_listenable_"+(Math.random()*1e6|0),zd=0;function jd(s,c,u,f,I){this.listener=s,this.proxy=null,this.src=c,this.type=u,this.capture=!!f,this.ha=I,this.key=++zd,this.da=this.fa=!1}function gr(s){s.da=!0,s.listener=null,s.proxy=null,s.src=null,s.ha=null}function _r(s,c,u){for(let f in s)c.call(u,s[f],f,s)}function $d(s,c){for(let u in s)c.call(void 0,s[u],u,s)}function sc(s){let c={};for(let u in s)c[u]=s[u];return c}let oc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ac(s,c){let u,f;for(let I=1;I<arguments.length;I++){f=arguments[I];for(u in f)s[u]=f[u];for(let k=0;k<oc.length;k++)u=oc[k],Object.prototype.hasOwnProperty.call(f,u)&&(s[u]=f[u])}}function yr(s){this.src=s,this.g={},this.h=0}yr.prototype.add=function(s,c,u,f,I){let k=s.toString();s=this.g[k],s||(s=this.g[k]=[],this.h++);let R=Ui(s,c,f,I);return R>-1?(c=s[R],u||(c.fa=!1)):(c=new jd(c,this.src,k,!!f,I),c.fa=u,s.push(c)),c};function Bi(s,c){let u=c.type;if(u in s.g){var f=s.g[u],I=Array.prototype.indexOf.call(f,c,void 0),k;(k=I>=0)&&Array.prototype.splice.call(f,I,1),k&&(gr(c),s.g[u].length==0&&(delete s.g[u],s.h--))}}function Ui(s,c,u,f){for(let I=0;I<s.length;++I){let k=s[I];if(!k.da&&k.listener==c&&k.capture==!!u&&k.ha==f)return I}return-1}var qi="closure_lm_"+(Math.random()*1e6|0),zi={};function cc(s,c,u,f,I){if(f&&f.once)return lc(s,c,u,f,I);if(Array.isArray(c)){for(let k=0;k<c.length;k++)cc(s,c[k],u,f,I);return null}return u=Ki(u),s&&s[tt]?s.J(c,u,l(f)?!!f.capture:!!f,I):uc(s,c,u,!1,f,I)}function uc(s,c,u,f,I,k){if(!c)throw Error("Invalid event type");let R=l(I)?!!I.capture:!!I,U=$i(s);if(U||(s[qi]=U=new yr(s)),u=U.add(c,u,f,R,k),u.proxy)return u;if(f=Gd(),u.proxy=f,f.src=s,f.listener=u,s.addEventListener)T||(I=R),I===void 0&&(I=!1),s.addEventListener(c.toString(),f,I);else if(s.attachEvent)s.attachEvent(dc(c.toString()),f);else if(s.addListener&&s.removeListener)s.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return u}function Gd(){function s(u){return c.call(s.src,s.listener,u)}let c=Kd;return s}function lc(s,c,u,f,I){if(Array.isArray(c)){for(let k=0;k<c.length;k++)lc(s,c[k],u,f,I);return null}return u=Ki(u),s&&s[tt]?s.K(c,u,l(f)?!!f.capture:!!f,I):uc(s,c,u,!0,f,I)}function hc(s,c,u,f,I){if(Array.isArray(c))for(var k=0;k<c.length;k++)hc(s,c[k],u,f,I);else f=l(f)?!!f.capture:!!f,u=Ki(u),s&&s[tt]?(s=s.i,k=String(c).toString(),k in s.g&&(c=s.g[k],u=Ui(c,u,f,I),u>-1&&(gr(c[u]),Array.prototype.splice.call(c,u,1),c.length==0&&(delete s.g[k],s.h--)))):s&&(s=$i(s))&&(c=s.g[c.toString()],s=-1,c&&(s=Ui(c,u,f,I)),(u=s>-1?c[s]:null)&&ji(u))}function ji(s){if(typeof s!="number"&&s&&!s.da){var c=s.src;if(c&&c[tt])Bi(c.i,s);else{var u=s.type,f=s.proxy;c.removeEventListener?c.removeEventListener(u,f,s.capture):c.detachEvent?c.detachEvent(dc(u),f):c.addListener&&c.removeListener&&c.removeListener(f),(u=$i(c))?(Bi(u,s),u.h==0&&(u.src=null,c[qi]=null)):gr(s)}}}function dc(s){return s in zi?zi[s]:zi[s]="on"+s}function Kd(s,c){if(s.da)s=!0;else{c=new ve(c,this);let u=s.listener,f=s.ha||s.src;s.fa&&ji(s),s=u.call(f,c)}return s}function $i(s){return s=s[qi],s instanceof yr?s:null}var Gi="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ki(s){return typeof s=="function"?s:(s[Gi]||(s[Gi]=function(c){return s.handleEvent(c)}),s[Gi])}function fe(){v.call(this),this.i=new yr(this),this.M=this,this.G=null}b(fe,v),fe.prototype[tt]=!0,fe.prototype.removeEventListener=function(s,c,u,f){hc(this,s,c,u,f)};function ye(s,c){var u,f=s.G;if(f)for(u=[];f;f=f.G)u.push(f);if(s=s.M,f=c.type||c,typeof c=="string")c=new y(c,s);else if(c instanceof y)c.target=c.target||s;else{var I=c;c=new y(f,s),ac(c,I)}I=!0;let k,R;if(u)for(R=u.length-1;R>=0;R--)k=c.g=u[R],I=br(k,f,!0,c)&&I;if(k=c.g=s,I=br(k,f,!0,c)&&I,I=br(k,f,!1,c)&&I,u)for(R=0;R<u.length;R++)k=c.g=u[R],I=br(k,f,!1,c)&&I}fe.prototype.N=function(){if(fe.Z.N.call(this),this.i){var s=this.i;for(let c in s.g){let u=s.g[c];for(let f=0;f<u.length;f++)gr(u[f]);delete s.g[c],s.h--}}this.G=null},fe.prototype.J=function(s,c,u,f){return this.i.add(String(s),c,!1,u,f)},fe.prototype.K=function(s,c,u,f){return this.i.add(String(s),c,!0,u,f)};function br(s,c,u,f){if(c=s.i.g[String(c)],!c)return!0;c=c.concat();let I=!0;for(let k=0;k<c.length;++k){let R=c[k];if(R&&!R.da&&R.capture==u){let U=R.listener,ae=R.ha||R.src;R.fa&&Bi(s.i,R),I=U.call(ae,f)!==!1&&I}}return I&&!f.defaultPrevented}function Qd(s,c){if(typeof s!="function")if(s&&typeof s.handleEvent=="function")s=d(s.handleEvent,s);else throw Error("Invalid listener argument");return Number(c)>2147483647?-1:a.setTimeout(s,c||0)}function fc(s){s.g=Qd(()=>{s.g=null,s.i&&(s.i=!1,fc(s))},s.l);let c=s.h;s.h=null,s.m.apply(null,c)}class Hd extends v{constructor(c,u){super(),this.m=c,this.l=u,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:fc(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Tn(s){v.call(this),this.h=s,this.g={}}b(Tn,v);var mc=[];function pc(s){_r(s.g,function(c,u){this.g.hasOwnProperty(u)&&ji(c)},s),s.g={}}Tn.prototype.N=function(){Tn.Z.N.call(this),pc(this)},Tn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Qi=a.JSON.stringify,Wd=a.JSON.parse,Jd=class{stringify(s){return a.JSON.stringify(s,void 0)}parse(s){return a.JSON.parse(s,void 0)}};function gc(){}function _c(){}var kn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Hi(){y.call(this,"d")}b(Hi,y);function Wi(){y.call(this,"c")}b(Wi,y);var yt={},yc=null;function wr(){return yc=yc||new fe}yt.Ia="serverreachability";function bc(s){y.call(this,yt.Ia,s)}b(bc,y);function An(s){let c=wr();ye(c,new bc(c))}yt.STAT_EVENT="statevent";function wc(s,c){y.call(this,yt.STAT_EVENT,s),this.stat=c}b(wc,y);function be(s){let c=wr();ye(c,new wc(c,s))}yt.Ja="timingevent";function vc(s,c){y.call(this,yt.Ja,s),this.size=c}b(vc,y);function xn(s,c){if(typeof s!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){s()},c)}function Sn(){this.g=!0}Sn.prototype.ua=function(){this.g=!1};function Xd(s,c,u,f,I,k){s.info(function(){if(s.g)if(k){var R="",U=k.split("&");for(let W=0;W<U.length;W++){var ae=U[W].split("=");if(ae.length>1){let ue=ae[0];ae=ae[1];let De=ue.split("_");R=De.length>=2&&De[1]=="type"?R+(ue+"="+ae+"&"):R+(ue+"=redacted&")}}}else R=null;else R=k;return"XMLHTTP REQ ("+f+") [attempt "+I+"]: "+c+`
`+u+`
`+R})}function Yd(s,c,u,f,I,k,R){s.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+I+"]: "+c+`
`+u+`
`+k+" "+R})}function qt(s,c,u,f){s.info(function(){return"XMLHTTP TEXT ("+c+"): "+ef(s,u)+(f?" "+f:"")})}function Zd(s,c){s.info(function(){return"TIMEOUT: "+c})}Sn.prototype.info=function(){};function ef(s,c){if(!s.g)return c;if(!c)return null;try{let k=JSON.parse(c);if(k){for(s=0;s<k.length;s++)if(Array.isArray(k[s])){var u=k[s];if(!(u.length<2)){var f=u[1];if(Array.isArray(f)&&!(f.length<1)){var I=f[0];if(I!="noop"&&I!="stop"&&I!="close")for(let R=1;R<f.length;R++)f[R]=""}}}}return Qi(k)}catch{return c}}var vr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ic={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Ec;function Ji(){}b(Ji,gc),Ji.prototype.g=function(){return new XMLHttpRequest},Ec=new Ji;function Cn(s){return encodeURIComponent(String(s))}function tf(s){var c=1;s=s.split(":");let u=[];for(;c>0&&s.length;)u.push(s.shift()),c--;return s.length&&u.push(s.join(":")),u}function nt(s,c,u,f){this.j=s,this.i=c,this.l=u,this.S=f||1,this.V=new Tn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Tc}function Tc(){this.i=null,this.g="",this.h=!1}var kc={},Xi={};function Yi(s,c,u){s.M=1,s.A=Er(Pe(c)),s.u=u,s.R=!0,Ac(s,null)}function Ac(s,c){s.F=Date.now(),Ir(s),s.B=Pe(s.A);var u=s.B,f=s.S;Array.isArray(f)||(f=[String(f)]),Bc(u.i,"t",f),s.C=0,u=s.j.L,s.h=new Tc,s.g=ru(s.j,u?c:null,!s.u),s.P>0&&(s.O=new Hd(d(s.Y,s,s.g),s.P)),c=s.V,u=s.g,f=s.ba;var I="readystatechange";Array.isArray(I)||(I&&(mc[0]=I.toString()),I=mc);for(let k=0;k<I.length;k++){let R=cc(u,I[k],f||c.handleEvent,!1,c.h||c);if(!R)break;c.g[R.key]=R}c=s.J?sc(s.J):{},s.u?(s.v||(s.v="POST"),c["Content-Type"]="application/x-www-form-urlencoded",s.g.ea(s.B,s.v,s.u,c)):(s.v="GET",s.g.ea(s.B,s.v,null,c)),An(),Xd(s.i,s.v,s.B,s.l,s.S,s.u)}nt.prototype.ba=function(s){s=s.target;let c=this.O;c&&st(s)==3?c.j():this.Y(s)},nt.prototype.Y=function(s){try{if(s==this.g)e:{let U=st(this.g),ae=this.g.ya(),W=this.g.ca();if(!(U<3)&&(U!=3||this.g&&(this.h.h||this.g.la()||Kc(this.g)))){this.K||U!=4||ae==7||(ae==8||W<=0?An(3):An(2)),Zi(this);var c=this.g.ca();this.X=c;var u=nf(this);if(this.o=c==200,Yd(this.i,this.v,this.B,this.l,this.S,U,c),this.o){if(this.U&&!this.L){t:{if(this.g){var f,I=this.g;if((f=I.g?I.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!g(f)){var k=f;break t}}k=null}if(s=k)qt(this.i,this.l,s,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,es(this,s);else{this.o=!1,this.m=3,be(12),bt(this),Rn(this);break e}}if(this.R){s=!0;let ue;for(;!this.K&&this.C<u.length;)if(ue=rf(this,u),ue==Xi){U==4&&(this.m=4,be(14),s=!1),qt(this.i,this.l,null,"[Incomplete Response]");break}else if(ue==kc){this.m=4,be(15),qt(this.i,this.l,u,"[Invalid Chunk]"),s=!1;break}else qt(this.i,this.l,ue,null),es(this,ue);if(xc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),U!=4||u.length!=0||this.h.h||(this.m=1,be(16),s=!1),this.o=this.o&&s,!s)qt(this.i,this.l,u,"[Invalid Chunked Response]"),bt(this),Rn(this);else if(u.length>0&&!this.W){this.W=!0;var R=this.j;R.g==this&&R.aa&&!R.P&&(R.j.info("Great, no buffering proxy detected. Bytes received: "+u.length),as(R),R.P=!0,be(11))}}else qt(this.i,this.l,u,null),es(this,u);U==4&&bt(this),this.o&&!this.K&&(U==4?Zc(this.j,this):(this.o=!1,Ir(this)))}else yf(this.g),c==400&&u.indexOf("Unknown SID")>0?(this.m=3,be(12)):(this.m=0,be(13)),bt(this),Rn(this)}}}catch{}finally{}};function nf(s){if(!xc(s))return s.g.la();let c=Kc(s.g);if(c==="")return"";let u="",f=c.length,I=st(s.g)==4;if(!s.h.i){if(typeof TextDecoder>"u")return bt(s),Rn(s),"";s.h.i=new a.TextDecoder}for(let k=0;k<f;k++)s.h.h=!0,u+=s.h.i.decode(c[k],{stream:!(I&&k==f-1)});return c.length=0,s.h.g+=u,s.C=0,s.h.g}function xc(s){return s.g?s.v=="GET"&&s.M!=2&&s.j.Aa:!1}function rf(s,c){var u=s.C,f=c.indexOf(`
`,u);return f==-1?Xi:(u=Number(c.substring(u,f)),isNaN(u)?kc:(f+=1,f+u>c.length?Xi:(c=c.slice(f,f+u),s.C=f+u,c)))}nt.prototype.cancel=function(){this.K=!0,bt(this)};function Ir(s){s.T=Date.now()+s.H,Sc(s,s.H)}function Sc(s,c){if(s.D!=null)throw Error("WatchDog timer not null");s.D=xn(d(s.aa,s),c)}function Zi(s){s.D&&(a.clearTimeout(s.D),s.D=null)}nt.prototype.aa=function(){this.D=null;let s=Date.now();s-this.T>=0?(Zd(this.i,this.B),this.M!=2&&(An(),be(17)),bt(this),this.m=2,Rn(this)):Sc(this,this.T-s)};function Rn(s){s.j.I==0||s.K||Zc(s.j,s)}function bt(s){Zi(s);var c=s.O;c&&typeof c.dispose=="function"&&c.dispose(),s.O=null,pc(s.V),s.g&&(c=s.g,s.g=null,c.abort(),c.dispose())}function es(s,c){try{var u=s.j;if(u.I!=0&&(u.g==s||ts(u.h,s))){if(!s.L&&ts(u.h,s)&&u.I==3){try{var f=u.Ba.g.parse(c)}catch{f=null}if(Array.isArray(f)&&f.length==3){var I=f;if(I[0]==0){e:if(!u.v){if(u.g)if(u.g.F+3e3<s.F)Cr(u),xr(u);else break e;os(u),be(18)}}else u.xa=I[1],0<u.xa-u.K&&I[2]<37500&&u.F&&u.A==0&&!u.C&&(u.C=xn(d(u.Va,u),6e3));Pc(u.h)<=1&&u.ta&&(u.ta=void 0)}else vt(u,11)}else if((s.L||u.g==s)&&Cr(u),!g(c))for(I=u.Ba.g.parse(c),c=0;c<I.length;c++){let W=I[c],ue=W[0];if(!(ue<=u.K))if(u.K=ue,W=W[1],u.I==2)if(W[0]=="c"){u.M=W[1],u.ba=W[2];let De=W[3];De!=null&&(u.ka=De,u.j.info("VER="+u.ka));let It=W[4];It!=null&&(u.za=It,u.j.info("SVER="+u.za));let ot=W[5];ot!=null&&typeof ot=="number"&&ot>0&&(f=1.5*ot,u.O=f,u.j.info("backChannelRequestTimeoutMs_="+f)),f=u;let at=s.g;if(at){let Pr=at.g?at.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Pr){var k=f.h;k.g||Pr.indexOf("spdy")==-1&&Pr.indexOf("quic")==-1&&Pr.indexOf("h2")==-1||(k.j=k.l,k.g=new Set,k.h&&(ns(k,k.h),k.h=null))}if(f.G){let cs=at.g?at.g.getResponseHeader("X-HTTP-Session-Id"):null;cs&&(f.wa=cs,J(f.J,f.G,cs))}}u.I=3,u.l&&u.l.ra(),u.aa&&(u.T=Date.now()-s.F,u.j.info("Handshake RTT: "+u.T+"ms")),f=u;var R=s;if(f.na=nu(f,f.L?f.ba:null,f.W),R.L){Dc(f.h,R);var U=R,ae=f.O;ae&&(U.H=ae),U.D&&(Zi(U),Ir(U)),f.g=R}else Xc(f);u.i.length>0&&Sr(u)}else W[0]!="stop"&&W[0]!="close"||vt(u,7);else u.I==3&&(W[0]=="stop"||W[0]=="close"?W[0]=="stop"?vt(u,7):ss(u):W[0]!="noop"&&u.l&&u.l.qa(W),u.A=0)}}An(4)}catch{}}var sf=class{constructor(s,c){this.g=s,this.map=c}};function Cc(s){this.l=s||10,a.PerformanceNavigationTiming?(s=a.performance.getEntriesByType("navigation"),s=s.length>0&&(s[0].nextHopProtocol=="hq"||s[0].nextHopProtocol=="h2")):s=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=s?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Rc(s){return s.h?!0:s.g?s.g.size>=s.j:!1}function Pc(s){return s.h?1:s.g?s.g.size:0}function ts(s,c){return s.h?s.h==c:s.g?s.g.has(c):!1}function ns(s,c){s.g?s.g.add(c):s.h=c}function Dc(s,c){s.h&&s.h==c?s.h=null:s.g&&s.g.has(c)&&s.g.delete(c)}Cc.prototype.cancel=function(){if(this.i=Vc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let s of this.g.values())s.cancel();this.g.clear()}};function Vc(s){if(s.h!=null)return s.i.concat(s.h.G);if(s.g!=null&&s.g.size!==0){let c=s.i;for(let u of s.g.values())c=c.concat(u.G);return c}return S(s.i)}var Nc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function of(s,c){if(s){s=s.split("&");for(let u=0;u<s.length;u++){let f=s[u].indexOf("="),I,k=null;f>=0?(I=s[u].substring(0,f),k=s[u].substring(f+1)):I=s[u],c(I,k?decodeURIComponent(k.replace(/\+/g," ")):"")}}}function rt(s){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let c;s instanceof rt?(this.l=s.l,Pn(this,s.j),this.o=s.o,this.g=s.g,Dn(this,s.u),this.h=s.h,rs(this,Uc(s.i)),this.m=s.m):s&&(c=String(s).match(Nc))?(this.l=!1,Pn(this,c[1]||"",!0),this.o=Vn(c[2]||""),this.g=Vn(c[3]||"",!0),Dn(this,c[4]),this.h=Vn(c[5]||"",!0),rs(this,c[6]||"",!0),this.m=Vn(c[7]||"")):(this.l=!1,this.i=new Fn(null,this.l))}rt.prototype.toString=function(){let s=[];var c=this.j;c&&s.push(Nn(c,Fc,!0),":");var u=this.g;return(u||c=="file")&&(s.push("//"),(c=this.o)&&s.push(Nn(c,Fc,!0),"@"),s.push(Cn(u).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u=this.u,u!=null&&s.push(":",String(u))),(u=this.h)&&(this.g&&u.charAt(0)!="/"&&s.push("/"),s.push(Nn(u,u.charAt(0)=="/"?uf:cf,!0))),(u=this.i.toString())&&s.push("?",u),(u=this.m)&&s.push("#",Nn(u,hf)),s.join("")},rt.prototype.resolve=function(s){let c=Pe(this),u=!!s.j;u?Pn(c,s.j):u=!!s.o,u?c.o=s.o:u=!!s.g,u?c.g=s.g:u=s.u!=null;var f=s.h;if(u)Dn(c,s.u);else if(u=!!s.h){if(f.charAt(0)!="/")if(this.g&&!this.h)f="/"+f;else{var I=c.h.lastIndexOf("/");I!=-1&&(f=c.h.slice(0,I+1)+f)}if(I=f,I==".."||I==".")f="";else if(I.indexOf("./")!=-1||I.indexOf("/.")!=-1){f=I.lastIndexOf("/",0)==0,I=I.split("/");let k=[];for(let R=0;R<I.length;){let U=I[R++];U=="."?f&&R==I.length&&k.push(""):U==".."?((k.length>1||k.length==1&&k[0]!="")&&k.pop(),f&&R==I.length&&k.push("")):(k.push(U),f=!0)}f=k.join("/")}else f=I}return u?c.h=f:u=s.i.toString()!=="",u?rs(c,Uc(s.i)):u=!!s.m,u&&(c.m=s.m),c};function Pe(s){return new rt(s)}function Pn(s,c,u){s.j=u?Vn(c,!0):c,s.j&&(s.j=s.j.replace(/:$/,""))}function Dn(s,c){if(c){if(c=Number(c),isNaN(c)||c<0)throw Error("Bad port number "+c);s.u=c}else s.u=null}function rs(s,c,u){c instanceof Fn?(s.i=c,df(s.i,s.l)):(u||(c=Nn(c,lf)),s.i=new Fn(c,s.l))}function J(s,c,u){s.i.set(c,u)}function Er(s){return J(s,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),s}function Vn(s,c){return s?c?decodeURI(s.replace(/%25/g,"%2525")):decodeURIComponent(s):""}function Nn(s,c,u){return typeof s=="string"?(s=encodeURI(s).replace(c,af),u&&(s=s.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),s):null}function af(s){return s=s.charCodeAt(0),"%"+(s>>4&15).toString(16)+(s&15).toString(16)}var Fc=/[#\/\?@]/g,cf=/[#\?:]/g,uf=/[#\?]/g,lf=/[#\?@]/g,hf=/#/g;function Fn(s,c){this.h=this.g=null,this.i=s||null,this.j=!!c}function wt(s){s.g||(s.g=new Map,s.h=0,s.i&&of(s.i,function(c,u){s.add(decodeURIComponent(c.replace(/\+/g," ")),u)}))}n=Fn.prototype,n.add=function(s,c){wt(this),this.i=null,s=zt(this,s);let u=this.g.get(s);return u||this.g.set(s,u=[]),u.push(c),this.h+=1,this};function Oc(s,c){wt(s),c=zt(s,c),s.g.has(c)&&(s.i=null,s.h-=s.g.get(c).length,s.g.delete(c))}function Mc(s,c){return wt(s),c=zt(s,c),s.g.has(c)}n.forEach=function(s,c){wt(this),this.g.forEach(function(u,f){u.forEach(function(I){s.call(c,I,f,this)},this)},this)};function Lc(s,c){wt(s);let u=[];if(typeof c=="string")Mc(s,c)&&(u=u.concat(s.g.get(zt(s,c))));else for(s=Array.from(s.g.values()),c=0;c<s.length;c++)u=u.concat(s[c]);return u}n.set=function(s,c){return wt(this),this.i=null,s=zt(this,s),Mc(this,s)&&(this.h-=this.g.get(s).length),this.g.set(s,[c]),this.h+=1,this},n.get=function(s,c){return s?(s=Lc(this,s),s.length>0?String(s[0]):c):c};function Bc(s,c,u){Oc(s,c),u.length>0&&(s.i=null,s.g.set(zt(s,c),S(u)),s.h+=u.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let s=[],c=Array.from(this.g.keys());for(let f=0;f<c.length;f++){var u=c[f];let I=Cn(u);u=Lc(this,u);for(let k=0;k<u.length;k++){let R=I;u[k]!==""&&(R+="="+Cn(u[k])),s.push(R)}}return this.i=s.join("&")};function Uc(s){let c=new Fn;return c.i=s.i,s.g&&(c.g=new Map(s.g),c.h=s.h),c}function zt(s,c){return c=String(c),s.j&&(c=c.toLowerCase()),c}function df(s,c){c&&!s.j&&(wt(s),s.i=null,s.g.forEach(function(u,f){let I=f.toLowerCase();f!=I&&(Oc(this,f),Bc(this,I,u))},s)),s.j=c}function ff(s,c){let u=new Sn;if(a.Image){let f=new Image;f.onload=m(it,u,"TestLoadImage: loaded",!0,c,f),f.onerror=m(it,u,"TestLoadImage: error",!1,c,f),f.onabort=m(it,u,"TestLoadImage: abort",!1,c,f),f.ontimeout=m(it,u,"TestLoadImage: timeout",!1,c,f),a.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=s}else c(!1)}function mf(s,c){let u=new Sn,f=new AbortController,I=setTimeout(()=>{f.abort(),it(u,"TestPingServer: timeout",!1,c)},1e4);fetch(s,{signal:f.signal}).then(k=>{clearTimeout(I),k.ok?it(u,"TestPingServer: ok",!0,c):it(u,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(I),it(u,"TestPingServer: error",!1,c)})}function it(s,c,u,f,I){try{I&&(I.onload=null,I.onerror=null,I.onabort=null,I.ontimeout=null),f(u)}catch{}}function pf(){this.g=new Jd}function Tr(s){this.i=s.Sb||null,this.h=s.ab||!1}b(Tr,gc),Tr.prototype.g=function(){return new kr(this.i,this.h)};function kr(s,c){fe.call(this),this.H=s,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}b(kr,fe),n=kr.prototype,n.open=function(s,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=s,this.D=c,this.readyState=1,Mn(this)},n.send=function(s){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let c={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};s&&(c.body=s),(this.H||a).fetch(new Request(this.D,c)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,On(this)),this.readyState=0},n.Pa=function(s){if(this.g&&(this.l=s,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=s.headers,this.readyState=2,Mn(this)),this.g&&(this.readyState=3,Mn(this),this.g)))if(this.responseType==="arraybuffer")s.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in s){if(this.j=s.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;qc(this)}else s.text().then(this.Oa.bind(this),this.ga.bind(this))};function qc(s){s.j.read().then(s.Ma.bind(s)).catch(s.ga.bind(s))}n.Ma=function(s){if(this.g){if(this.o&&s.value)this.response.push(s.value);else if(!this.o){var c=s.value?s.value:new Uint8Array(0);(c=this.B.decode(c,{stream:!s.done}))&&(this.response=this.responseText+=c)}s.done?On(this):Mn(this),this.readyState==3&&qc(this)}},n.Oa=function(s){this.g&&(this.response=this.responseText=s,On(this))},n.Na=function(s){this.g&&(this.response=s,On(this))},n.ga=function(){this.g&&On(this)};function On(s){s.readyState=4,s.l=null,s.j=null,s.B=null,Mn(s)}n.setRequestHeader=function(s,c){this.A.append(s,c)},n.getResponseHeader=function(s){return this.h&&this.h.get(s.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let s=[],c=this.h.entries();for(var u=c.next();!u.done;)u=u.value,s.push(u[0]+": "+u[1]),u=c.next();return s.join(`\r
`)};function Mn(s){s.onreadystatechange&&s.onreadystatechange.call(s)}Object.defineProperty(kr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(s){this.m=s?"include":"same-origin"}});function zc(s){let c="";return _r(s,function(u,f){c+=f,c+=":",c+=u,c+=`\r
`}),c}function is(s,c,u){e:{for(f in u){var f=!1;break e}f=!0}f||(u=zc(u),typeof s=="string"?u!=null&&Cn(u):J(s,c,u))}function ee(s){fe.call(this),this.headers=new Map,this.L=s||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}b(ee,fe);var gf=/^https?$/i,_f=["POST","PUT"];n=ee.prototype,n.Fa=function(s){this.H=s},n.ea=function(s,c,u,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+s);c=c?c.toUpperCase():"GET",this.D=s,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ec.g(),this.g.onreadystatechange=E(d(this.Ca,this));try{this.B=!0,this.g.open(c,String(s),!0),this.B=!1}catch(k){jc(this,k);return}if(s=u||"",u=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var I in f)u.set(I,f[I]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let k of f.keys())u.set(k,f.get(k));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(u.keys()).find(k=>k.toLowerCase()=="content-type"),I=a.FormData&&s instanceof a.FormData,!(Array.prototype.indexOf.call(_f,c,void 0)>=0)||f||I||u.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[k,R]of u)this.g.setRequestHeader(k,R);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(s),this.v=!1}catch(k){jc(this,k)}};function jc(s,c){s.h=!1,s.g&&(s.j=!0,s.g.abort(),s.j=!1),s.l=c,s.o=5,$c(s),Ar(s)}function $c(s){s.A||(s.A=!0,ye(s,"complete"),ye(s,"error"))}n.abort=function(s){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=s||7,ye(this,"complete"),ye(this,"abort"),Ar(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ar(this,!0)),ee.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Gc(this):this.Xa())},n.Xa=function(){Gc(this)};function Gc(s){if(s.h&&typeof o<"u"){if(s.v&&st(s)==4)setTimeout(s.Ca.bind(s),0);else if(ye(s,"readystatechange"),st(s)==4){s.h=!1;try{let k=s.ca();e:switch(k){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var u;if(!(u=c)){var f;if(f=k===0){let R=String(s.D).match(Nc)[1]||null;!R&&a.self&&a.self.location&&(R=a.self.location.protocol.slice(0,-1)),f=!gf.test(R?R.toLowerCase():"")}u=f}if(u)ye(s,"complete"),ye(s,"success");else{s.o=6;try{var I=st(s)>2?s.g.statusText:""}catch{I=""}s.l=I+" ["+s.ca()+"]",$c(s)}}finally{Ar(s)}}}}function Ar(s,c){if(s.g){s.m&&(clearTimeout(s.m),s.m=null);let u=s.g;s.g=null,c||ye(s,"ready");try{u.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function st(s){return s.g?s.g.readyState:0}n.ca=function(){try{return st(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(s){if(this.g){var c=this.g.responseText;return s&&c.indexOf(s)==0&&(c=c.substring(s.length)),Wd(c)}};function Kc(s){try{if(!s.g)return null;if("response"in s.g)return s.g.response;switch(s.F){case"":case"text":return s.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in s.g)return s.g.mozResponseArrayBuffer}return null}catch{return null}}function yf(s){let c={};s=(s.g&&st(s)>=2&&s.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<s.length;f++){if(g(s[f]))continue;var u=tf(s[f]);let I=u[0];if(u=u[1],typeof u!="string")continue;u=u.trim();let k=c[I]||[];c[I]=k,k.push(u)}$d(c,function(f){return f.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ln(s,c,u){return u&&u.internalChannelParams&&u.internalChannelParams[s]||c}function Qc(s){this.za=0,this.i=[],this.j=new Sn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ln("failFast",!1,s),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ln("baseRetryDelayMs",5e3,s),this.Za=Ln("retryDelaySeedMs",1e4,s),this.Ta=Ln("forwardChannelMaxRetries",2,s),this.va=Ln("forwardChannelRequestTimeoutMs",2e4,s),this.ma=s&&s.xmlHttpFactory||void 0,this.Ua=s&&s.Rb||void 0,this.Aa=s&&s.useFetchStreams||!1,this.O=void 0,this.L=s&&s.supportsCrossDomainXhr||!1,this.M="",this.h=new Cc(s&&s.concurrentRequestLimit),this.Ba=new pf,this.S=s&&s.fastHandshake||!1,this.R=s&&s.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=s&&s.Pb||!1,s&&s.ua&&this.j.ua(),s&&s.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&s&&s.detectBufferingProxy||!1,this.ia=void 0,s&&s.longPollingTimeout&&s.longPollingTimeout>0&&(this.ia=s.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Qc.prototype,n.ka=8,n.I=1,n.connect=function(s,c,u,f){be(0),this.W=s,this.H=c||{},u&&f!==void 0&&(this.H.OSID=u,this.H.OAID=f),this.F=this.X,this.J=nu(this,null,this.W),Sr(this)};function ss(s){if(Hc(s),s.I==3){var c=s.V++,u=Pe(s.J);if(J(u,"SID",s.M),J(u,"RID",c),J(u,"TYPE","terminate"),Bn(s,u),c=new nt(s,s.j,c),c.M=2,c.A=Er(Pe(u)),u=!1,a.navigator&&a.navigator.sendBeacon)try{u=a.navigator.sendBeacon(c.A.toString(),"")}catch{}!u&&a.Image&&(new Image().src=c.A,u=!0),u||(c.g=ru(c.j,null),c.g.ea(c.A)),c.F=Date.now(),Ir(c)}tu(s)}function xr(s){s.g&&(as(s),s.g.cancel(),s.g=null)}function Hc(s){xr(s),s.v&&(a.clearTimeout(s.v),s.v=null),Cr(s),s.h.cancel(),s.m&&(typeof s.m=="number"&&a.clearTimeout(s.m),s.m=null)}function Sr(s){if(!Rc(s.h)&&!s.m){s.m=!0;var c=s.Ea;we||p(),ce||(we(),ce=!0),w.add(c,s),s.D=0}}function bf(s,c){return Pc(s.h)>=s.h.j-(s.m?1:0)?!1:s.m?(s.i=c.G.concat(s.i),!0):s.I==1||s.I==2||s.D>=(s.Sa?0:s.Ta)?!1:(s.m=xn(d(s.Ea,s,c),eu(s,s.D)),s.D++,!0)}n.Ea=function(s){if(this.m)if(this.m=null,this.I==1){if(!s){this.V=Math.floor(Math.random()*1e5),s=this.V++;let I=new nt(this,this.j,s),k=this.o;if(this.U&&(k?(k=sc(k),ac(k,this.U)):k=this.U),this.u!==null||this.R||(I.J=k,k=null),this.S)e:{for(var c=0,u=0;u<this.i.length;u++){t:{var f=this.i[u];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(c+=f,c>4096){c=u;break e}if(c===4096||u===this.i.length-1){c=u+1;break e}}c=1e3}else c=1e3;c=Jc(this,I,c),u=Pe(this.J),J(u,"RID",s),J(u,"CVER",22),this.G&&J(u,"X-HTTP-Session-Id",this.G),Bn(this,u),k&&(this.R?c="headers="+Cn(zc(k))+"&"+c:this.u&&is(u,this.u,k)),ns(this.h,I),this.Ra&&J(u,"TYPE","init"),this.S?(J(u,"$req",c),J(u,"SID","null"),I.U=!0,Yi(I,u,null)):Yi(I,u,c),this.I=2}}else this.I==3&&(s?Wc(this,s):this.i.length==0||Rc(this.h)||Wc(this))};function Wc(s,c){var u;c?u=c.l:u=s.V++;let f=Pe(s.J);J(f,"SID",s.M),J(f,"RID",u),J(f,"AID",s.K),Bn(s,f),s.u&&s.o&&is(f,s.u,s.o),u=new nt(s,s.j,u,s.D+1),s.u===null&&(u.J=s.o),c&&(s.i=c.G.concat(s.i)),c=Jc(s,u,1e3),u.H=Math.round(s.va*.5)+Math.round(s.va*.5*Math.random()),ns(s.h,u),Yi(u,f,c)}function Bn(s,c){s.H&&_r(s.H,function(u,f){J(c,f,u)}),s.l&&_r({},function(u,f){J(c,f,u)})}function Jc(s,c,u){u=Math.min(s.i.length,u);let f=s.l?d(s.l.Ka,s.l,s):null;e:{var I=s.i;let U=-1;for(;;){let ae=["count="+u];U==-1?u>0?(U=I[0].g,ae.push("ofs="+U)):U=0:ae.push("ofs="+U);let W=!0;for(let ue=0;ue<u;ue++){var k=I[ue].g;let De=I[ue].map;if(k-=U,k<0)U=Math.max(0,I[ue].g-100),W=!1;else try{k="req"+k+"_"||"";try{var R=De instanceof Map?De:Object.entries(De);for(let[It,ot]of R){let at=ot;l(ot)&&(at=Qi(ot)),ae.push(k+It+"="+encodeURIComponent(at))}}catch(It){throw ae.push(k+"type="+encodeURIComponent("_badmap")),It}}catch{f&&f(De)}}if(W){R=ae.join("&");break e}}R=void 0}return s=s.i.splice(0,u),c.G=s,R}function Xc(s){if(!s.g&&!s.v){s.Y=1;var c=s.Da;we||p(),ce||(we(),ce=!0),w.add(c,s),s.A=0}}function os(s){return s.g||s.v||s.A>=3?!1:(s.Y++,s.v=xn(d(s.Da,s),eu(s,s.A)),s.A++,!0)}n.Da=function(){if(this.v=null,Yc(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var s=4*this.T;this.j.info("BP detection timer enabled: "+s),this.B=xn(d(this.Wa,this),s)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,be(10),xr(this),Yc(this))};function as(s){s.B!=null&&(a.clearTimeout(s.B),s.B=null)}function Yc(s){s.g=new nt(s,s.j,"rpc",s.Y),s.u===null&&(s.g.J=s.o),s.g.P=0;var c=Pe(s.na);J(c,"RID","rpc"),J(c,"SID",s.M),J(c,"AID",s.K),J(c,"CI",s.F?"0":"1"),!s.F&&s.ia&&J(c,"TO",s.ia),J(c,"TYPE","xmlhttp"),Bn(s,c),s.u&&s.o&&is(c,s.u,s.o),s.O&&(s.g.H=s.O);var u=s.g;s=s.ba,u.M=1,u.A=Er(Pe(c)),u.u=null,u.R=!0,Ac(u,s)}n.Va=function(){this.C!=null&&(this.C=null,xr(this),os(this),be(19))};function Cr(s){s.C!=null&&(a.clearTimeout(s.C),s.C=null)}function Zc(s,c){var u=null;if(s.g==c){Cr(s),as(s),s.g=null;var f=2}else if(ts(s.h,c))u=c.G,Dc(s.h,c),f=1;else return;if(s.I!=0){if(c.o)if(f==1){u=c.u?c.u.length:0,c=Date.now()-c.F;var I=s.D;f=wr(),ye(f,new vc(f,u)),Sr(s)}else Xc(s);else if(I=c.m,I==3||I==0&&c.X>0||!(f==1&&bf(s,c)||f==2&&os(s)))switch(u&&u.length>0&&(c=s.h,c.i=c.i.concat(u)),I){case 1:vt(s,5);break;case 4:vt(s,10);break;case 3:vt(s,6);break;default:vt(s,2)}}}function eu(s,c){let u=s.Qa+Math.floor(Math.random()*s.Za);return s.isActive()||(u*=2),u*c}function vt(s,c){if(s.j.info("Error code "+c),c==2){var u=d(s.bb,s),f=s.Ua;let I=!f;f=new rt(f||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Pn(f,"https"),Er(f),I?ff(f.toString(),u):mf(f.toString(),u)}else be(2);s.I=0,s.l&&s.l.pa(c),tu(s),Hc(s)}n.bb=function(s){s?(this.j.info("Successfully pinged google.com"),be(2)):(this.j.info("Failed to ping google.com"),be(1))};function tu(s){if(s.I=0,s.ja=[],s.l){let c=Vc(s.h);(c.length!=0||s.i.length!=0)&&(N(s.ja,c),N(s.ja,s.i),s.h.i.length=0,S(s.i),s.i.length=0),s.l.oa()}}function nu(s,c,u){var f=u instanceof rt?Pe(u):new rt(u);if(f.g!="")c&&(f.g=c+"."+f.g),Dn(f,f.u);else{var I=a.location;f=I.protocol,c=c?c+"."+I.hostname:I.hostname,I=+I.port;let k=new rt(null);f&&Pn(k,f),c&&(k.g=c),I&&Dn(k,I),u&&(k.h=u),f=k}return u=s.G,c=s.wa,u&&c&&J(f,u,c),J(f,"VER",s.ka),Bn(s,f),f}function ru(s,c,u){if(c&&!s.L)throw Error("Can't create secondary domain capable XhrIo object.");return c=s.Aa&&!s.ma?new ee(new Tr({ab:u})):new ee(s.ma),c.Fa(s.L),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function iu(){}n=iu.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Rr(){}Rr.prototype.g=function(s,c){return new Ie(s,c)};function Ie(s,c){fe.call(this),this.g=new Qc(c),this.l=s,this.h=c&&c.messageUrlParams||null,s=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(s?s["X-Client-Protocol"]="webchannel":s={"X-Client-Protocol":"webchannel"}),this.g.o=s,s=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(s?s["X-WebChannel-Content-Type"]=c.messageContentType:s={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.sa&&(s?s["X-WebChannel-Client-Profile"]=c.sa:s={"X-WebChannel-Client-Profile":c.sa}),this.g.U=s,(s=c&&c.Qb)&&!g(s)&&(this.g.u=s),this.A=c&&c.supportsCrossDomainXhr||!1,this.v=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!g(c)&&(this.g.G=c,s=this.h,s!==null&&c in s&&(s=this.h,c in s&&delete s[c])),this.j=new jt(this)}b(Ie,fe),Ie.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ie.prototype.close=function(){ss(this.g)},Ie.prototype.o=function(s){var c=this.g;if(typeof s=="string"){var u={};u.__data__=s,s=u}else this.v&&(u={},u.__data__=Qi(s),s=u);c.i.push(new sf(c.Ya++,s)),c.I==3&&Sr(c)},Ie.prototype.N=function(){this.g.l=null,delete this.j,ss(this.g),delete this.g,Ie.Z.N.call(this)};function su(s){Hi.call(this),s.__headers__&&(this.headers=s.__headers__,this.statusCode=s.__status__,delete s.__headers__,delete s.__status__);var c=s.__sm__;if(c){e:{for(let u in c){s=u;break e}s=void 0}(this.i=s)&&(s=this.i,c=c!==null&&s in c?c[s]:void 0),this.data=c}else this.data=s}b(su,Hi);function ou(){Wi.call(this),this.status=1}b(ou,Wi);function jt(s){this.g=s}b(jt,iu),jt.prototype.ra=function(){ye(this.g,"a")},jt.prototype.qa=function(s){ye(this.g,new su(s))},jt.prototype.pa=function(s){ye(this.g,new ou)},jt.prototype.oa=function(){ye(this.g,"b")},Rr.prototype.createWebChannel=Rr.prototype.g,Ie.prototype.send=Ie.prototype.o,Ie.prototype.open=Ie.prototype.m,Ie.prototype.close=Ie.prototype.close,qs=Qe.createWebChannelTransport=function(){return new Rr},Us=Qe.getStatEventTarget=function(){return wr()},Bs=Qe.Event=yt,jr=Qe.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},vr.NO_ERROR=0,vr.TIMEOUT=8,vr.HTTP_ERROR=6,Qn=Qe.ErrorCode=vr,Ic.COMPLETE="complete",Ls=Qe.EventType=Ic,_c.EventType=kn,kn.OPEN="a",kn.CLOSE="b",kn.ERROR="c",kn.MESSAGE="d",fe.prototype.listen=fe.prototype.J,Xt=Qe.WebChannel=_c,qm=Qe.FetchXmlHttpFactory=Tr,ee.prototype.listenOnce=ee.prototype.K,ee.prototype.getLastError=ee.prototype.Ha,ee.prototype.getLastErrorCode=ee.prototype.ya,ee.prototype.getStatus=ee.prototype.ca,ee.prototype.getResponseJson=ee.prototype.La,ee.prototype.getResponseText=ee.prototype.la,ee.prototype.send=ee.prototype.ea,ee.prototype.setWithCredentials=ee.prototype.Fa,Ms=Qe.XhrIo=ee}).apply(typeof zr<"u"?zr:typeof self<"u"?self:typeof window<"u"?window:{});var _l="@firebase/firestore",yl="4.9.3";var le=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};le.UNAUTHENTICATED=new le(null),le.GOOGLE_CREDENTIALS=new le("google-credentials-uid"),le.FIRST_PARTY=new le("first-party-uid"),le.MOCK_USER=new le("mock-user");var wn="12.7.0";var Dt=new Jt("@firebase/firestore");function Yt(){return Dt.logLevel}function V(n,...e){if(Dt.logLevel<=j.DEBUG){let t=e.map(Va);Dt.debug(`Firestore (${wn}): ${n}`,...t)}}function We(n,...e){if(Dt.logLevel<=j.ERROR){let t=e.map(Va);Dt.error(`Firestore (${wn}): ${n}`,...t)}}function on(n,...e){if(Dt.logLevel<=j.WARN){let t=e.map(Va);Dt.warn(`Firestore (${wn}): ${n}`,...t)}}function Va(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function M(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,ch(n,r,t)}function ch(n,e,t){let r=`FIRESTORE (${wn}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw We(r),new Error(r)}function H(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||ch(e,i,r)}function L(n,e){return n}var A={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},D=class extends je{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Oe=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Jr=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Qs=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(le.UNAUTHENTICATED))}shutdown(){}},Hs=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Ws=class{constructor(e){this.t=e,this.currentUser=le.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){H(this.o===void 0,42304);let r=this.i,i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve(),o=new Oe;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Oe,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let h=o;e.enqueueRetryable(()=>x(this,null,function*(){yield h.promise,yield i(this.currentUser)}))},l=h=>{V("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(h=>l(h)),setTimeout(()=>{if(!this.auth){let h=this.t.getImmediate({optional:!0});h?l(h):(V("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Oe)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(V("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(H(typeof r.accessToken=="string",31837,{l:r}),new Jr(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return H(e===null||typeof e=="string",2055,{h:e}),new le(e)}},Js=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=le.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},Xs=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new Js(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(le.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Xr=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Ys=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ll(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){H(this.o===void 0,3512);let r=o=>{o.error!=null&&V("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let a=o.token!==this.m;return this.m=o.token,V("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{V("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.V.getImmediate({optional:!0});o?i(o):V("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Xr(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(H(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Xr(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function zm(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Zn=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=zm(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%62))}return r}};function q(n,e){return n<e?-1:n>e?1:0}function Zs(n,e){let t=Math.min(n.length,e.length);for(let r=0;r<t;r++){let i=n.charAt(r),o=e.charAt(r);if(i!==o)return zs(i)===zs(o)?q(i,o):zs(i)?1:-1}return q(n.length,e.length)}var jm=55296,$m=57343;function zs(n){let e=n.charCodeAt(0);return e>=jm&&e<=$m}function an(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var bl="__name__",Yr=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&M(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&M(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=n.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return q(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):Zs(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ke.fromString(e.substring(4,e.length-2))}},Z=class n extends Yr{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new D(A.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},Gm=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Te=class n extends Yr{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return Gm.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===bl}static keyField(){return new n([bl])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new D(A.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let l=e[i];if(l==="\\"){if(i+1===e.length)throw new D(A.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new D(A.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else l==="`"?(a=!a,i++):l!=="."||a?(r+=l,i++):(o(),i++)}if(o(),a)throw new D(A.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var O=class n{constructor(e){this.path=e}static fromPath(e){return new n(Z.fromString(e))}static fromName(e){return new n(Z.fromString(e).popFirst(5))}static empty(){return new n(Z.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Z.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Z.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Z(e.slice()))}};function uh(n,e,t){if(!t)throw new D(A.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Km(n,e,t,r){if(e===!0&&r===!0)throw new D(A.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function wl(n){if(!O.isDocumentKey(n))throw new D(A.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function vl(n){if(O.isDocumentKey(n))throw new D(A.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function lh(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Ci(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":M(12329,{type:typeof n})}function Me(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new D(A.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Ci(n);throw new D(A.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function se(n,e){let t={typeString:n};return e&&(t.value=e),t}function dr(n,e){if(!lh(n))throw new D(A.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,o="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let a=n[r];if(i&&typeof a!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(o!==void 0&&a!==o.value){t=`Expected '${r}' field to equal '${o.value}'`;break}}if(t)throw new D(A.INVALID_ARGUMENT,t);return!0}var Il=-62135596800,El=1e6,oe=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*El);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new D(A.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new D(A.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Il)throw new D(A.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new D(A.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/El}_compareTo(e){return this.seconds===e.seconds?q(this.nanoseconds,e.nanoseconds):q(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(dr(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-Il;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};oe._jsonSchemaVersion="firestore/timestamp/1.0",oe._jsonSchema={type:se("string",oe._jsonSchemaVersion),seconds:se("number"),nanoseconds:se("number")};var B=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new oe(0,0))}static max(){return new n(new oe(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var er=-1,eo=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};eo.UNKNOWN_ID=-1;function Qm(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=B.fromTimestamp(r===1e9?new oe(t+1,0):new oe(t,r));return new Vt(i,O.empty(),e)}function Hm(n){return new Vt(n.readTime,n.key,er)}var Vt=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(B.min(),O.empty(),er)}static max(){return new n(B.max(),O.empty(),er)}};function Wm(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=O.comparator(n.documentKey,e.documentKey),t!==0?t:q(n.largestBatchId,e.largestBatchId))}var Jm="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",to=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function vn(n){return x(this,null,function*(){if(n.code!==A.FAILED_PRECONDITION||n.message!==Jm)throw n;V("LocalStore","Unexpectedly lost primary lease")})}var C=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&M(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,a=!1;e.forEach(l=>{++i,l.next(()=>{++o,a&&o===i&&t()},h=>r(h))}),a=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,a=new Array(o),l=0;for(let h=0;h<o;h++){let d=h;t(e[d]).next(m=>{a[d]=m,++l,l===o&&r(a)},m=>i(m))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};function Xm(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function In(n){return n.name==="IndexedDbTransactionError"}var Na=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>r.writeSequenceNumber(i))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ue&&this.ue(t),t}}n.ce=-1;return n})(),Fa=-1;function Ri(n){return n==null}function tr(n){return n===0&&1/n==-1/0}function Ym(n){return typeof n=="number"&&Number.isInteger(n)&&!tr(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var hh="";function Zm(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Tl(e)),e=ep(n.get(t),e);return Tl(e)}function ep(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let o=n.charAt(i);switch(o){case"\0":t+="";break;case hh:t+="";break;default:t+=o}}return t}function Tl(n){return n+hh+""}var tp="remoteDocuments",dh="owner";var fh="mutationQueues";var mh="mutations";var ph="documentMutations",np="remoteDocumentsV14";var gh="remoteDocumentGlobal";var _h="targets";var yh="targetDocuments";var bh="targetGlobal",wh="collectionParents";var vh="clientMetadata";var Ih="bundles";var Eh="namedQueries";var rp="indexConfiguration";var ip="indexState";var sp="indexEntries";var Th="documentOverlays";var op="globals";var ap=[fh,mh,ph,tp,_h,dh,bh,yh,vh,gh,wh,Ih,Eh],ny=[...ap,Th],cp=[fh,mh,ph,np,_h,dh,bh,yh,vh,gh,wh,Ih,Eh,Th],up=cp,lp=[...up,rp,ip,sp];var ry=[...lp,op];function kl(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function _t(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function kh(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var te=class n{constructor(e,t){this.comparator=e,this.root=t||Le.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Le.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Le.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new nn(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new nn(this.root,e,this.comparator,!1)}getReverseIterator(){return new nn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new nn(this.root,e,this.comparator,!0)}},nn=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Le=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw M(43730,{key:this.key,value:this.value});if(this.right.isRed())throw M(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw M(27949);return e+(this.isRed()?0:1)}};Le.EMPTY=null,Le.RED=!0,Le.BLACK=!1;Le.EMPTY=new class{constructor(){this.size=0}get key(){throw M(57766)}get value(){throw M(16141)}get color(){throw M(16727)}get left(){throw M(29726)}get right(){throw M(36894)}copy(e,t,r,i,o){return this}insert(e,t,r){return new Le(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var he=class n{constructor(e){this.comparator=e,this.data=new te(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Zr(this.data.getIterator())}getIteratorFrom(e){return new Zr(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Zr=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var xe=class n{constructor(e){this.fields=e,e.sort(Te.comparator)}static empty(){return new n([])}unionWith(e){let t=new he(Te.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return an(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var ei=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var ge=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new ei("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return q(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};ge.EMPTY_BYTE_STRING=new ge("");var hp=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Je(n){if(H(!!n,39018),typeof n=="string"){let e=0,t=hp.exec(n);if(H(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Y(n.seconds),nanos:Y(n.nanos)}}function Y(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Xe(n){return typeof n=="string"?ge.fromBase64String(n):ge.fromUint8Array(n)}var Ah="server_timestamp",xh="__type__",Sh="__previous_value__",Ch="__local_write_time__";function Oa(n){return(n?.mapValue?.fields||{})[xh]?.stringValue===Ah}function Pi(n){let e=n.mapValue.fields[Sh];return Oa(e)?Pi(e):e}function nr(n){let e=Je(n.mapValue.fields[Ch].timestampValue);return new oe(e.seconds,e.nanos)}var no=class{constructor(e,t,r,i,o,a,l,h,d,m){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=h,this.useFetchStreams=d,this.isUsingEmulator=m}},ti="(default)",ni=class n{constructor(e,t){this.projectId=e,this.database=t||ti}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===ti}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Ma="__type__",Rh="__max__",$r={mapValue:{fields:{__type__:{stringValue:Rh}}}},La="__vector__",cn="value";function mt(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Oa(n)?4:Dh(n)?9007199254740991:Ph(n)?10:11:M(28295,{value:n})}function qe(n,e){if(n===e)return!0;let t=mt(n);if(t!==mt(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return nr(n).isEqual(nr(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let a=Je(i.timestampValue),l=Je(o.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return Xe(i.bytesValue).isEqual(Xe(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return Y(i.geoPointValue.latitude)===Y(o.geoPointValue.latitude)&&Y(i.geoPointValue.longitude)===Y(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return Y(i.integerValue)===Y(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let a=Y(i.doubleValue),l=Y(o.doubleValue);return a===l?tr(a)===tr(l):isNaN(a)&&isNaN(l)}return!1}(n,e);case 9:return an(n.arrayValue.values||[],e.arrayValue.values||[],qe);case 10:case 11:return function(i,o){let a=i.mapValue.fields||{},l=o.mapValue.fields||{};if(kl(a)!==kl(l))return!1;for(let h in a)if(a.hasOwnProperty(h)&&(l[h]===void 0||!qe(a[h],l[h])))return!1;return!0}(n,e);default:return M(52216,{left:n})}}function rr(n,e){return(n.values||[]).find(t=>qe(t,e))!==void 0}function un(n,e){if(n===e)return 0;let t=mt(n),r=mt(e);if(t!==r)return q(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return q(n.booleanValue,e.booleanValue);case 2:return function(o,a){let l=Y(o.integerValue||o.doubleValue),h=Y(a.integerValue||a.doubleValue);return l<h?-1:l>h?1:l===h?0:isNaN(l)?isNaN(h)?0:-1:1}(n,e);case 3:return Al(n.timestampValue,e.timestampValue);case 4:return Al(nr(n),nr(e));case 5:return Zs(n.stringValue,e.stringValue);case 6:return function(o,a){let l=Xe(o),h=Xe(a);return l.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(o,a){let l=o.split("/"),h=a.split("/");for(let d=0;d<l.length&&d<h.length;d++){let m=q(l[d],h[d]);if(m!==0)return m}return q(l.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,a){let l=q(Y(o.latitude),Y(a.latitude));return l!==0?l:q(Y(o.longitude),Y(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return xl(n.arrayValue,e.arrayValue);case 10:return function(o,a){let l=o.fields||{},h=a.fields||{},d=l[cn]?.arrayValue,m=h[cn]?.arrayValue,b=q(d?.values?.length||0,m?.values?.length||0);return b!==0?b:xl(d,m)}(n.mapValue,e.mapValue);case 11:return function(o,a){if(o===$r.mapValue&&a===$r.mapValue)return 0;if(o===$r.mapValue)return 1;if(a===$r.mapValue)return-1;let l=o.fields||{},h=Object.keys(l),d=a.fields||{},m=Object.keys(d);h.sort(),m.sort();for(let b=0;b<h.length&&b<m.length;++b){let E=Zs(h[b],m[b]);if(E!==0)return E;let S=un(l[h[b]],d[m[b]]);if(S!==0)return S}return q(h.length,m.length)}(n.mapValue,e.mapValue);default:throw M(23264,{he:t})}}function Al(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return q(n,e);let t=Je(n),r=Je(e),i=q(t.seconds,r.seconds);return i!==0?i:q(t.nanos,r.nanos)}function xl(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=un(t[i],r[i]);if(o)return o}return q(t.length,r.length)}function ln(n){return ro(n)}function ro(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Je(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Xe(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return O.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=ro(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let a of r)o?o=!1:i+=",",i+=`${a}:${ro(t.fields[a])}`;return i+"}"}(n.mapValue):M(61005,{value:n})}function Qr(n){switch(mt(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=Pi(n);return e?16+Qr(e):16;case 5:return 2*n.stringValue.length;case 6:return Xe(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,o)=>i+Qr(o),0)}(n.arrayValue);case 10:case 11:return function(r){let i=0;return _t(r.fields,(o,a)=>{i+=o.length+Qr(a)}),i}(n.mapValue);default:throw M(13486,{value:n})}}function Sl(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function io(n){return!!n&&"integerValue"in n}function Ba(n){return!!n&&"arrayValue"in n}function Cl(n){return!!n&&"nullValue"in n}function Rl(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Hr(n){return!!n&&"mapValue"in n}function Ph(n){return(n?.mapValue?.fields||{})[Ma]?.stringValue===La}function Wn(n){if(n.geoPointValue)return{geoPointValue:X({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:X({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return _t(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Wn(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Wn(n.arrayValue.values[t]);return e}return X({},n)}function Dh(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Rh}var sy={mapValue:{fields:{[Ma]:{stringValue:La},[cn]:{arrayValue:{}}}}};var Ee=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Hr(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Wn(t)}setAll(e){let t=Te.emptyPath(),r={},i=[];e.forEach((a,l)=>{if(!t.isImmediateParentOf(l)){let h=this.getFieldsMap(t);this.applyChanges(h,r,i),r={},i=[],t=l.popLast()}a?r[l.lastSegment()]=Wn(a):i.push(l.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());Hr(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return qe(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Hr(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){_t(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(Wn(this.value))}};function Vh(n){let e=[];return _t(n.fields,(t,r)=>{let i=new Te([t]);if(Hr(r)){let o=Vh(r.mapValue).fields;if(o.length===0)e.push(i);else for(let a of o)e.push(i.child(a))}else e.push(i)}),new xe(e)}var Ce=class n{constructor(e,t,r,i,o,a,l){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=a,this.documentState=l}static newInvalidDocument(e){return new n(e,0,B.min(),B.min(),B.min(),Ee.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,B.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,B.min(),B.min(),Ee.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,B.min(),B.min(),Ee.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(B.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ee.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ee.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=B.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var hn=class{constructor(e,t){this.position=e,this.inclusive=t}};function Pl(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],a=n.position[i];if(o.field.isKeyField()?r=O.comparator(O.fromName(a.referenceValue),t.key):r=un(a,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function Dl(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!qe(n.position[t],e.position[t]))return!1;return!0}var dn=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function dp(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var ri=class{},ie=class n extends ri{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new oo(e,t,r):t==="array-contains"?new uo(e,r):t==="in"?new lo(e,r):t==="not-in"?new ho(e,r):t==="array-contains-any"?new fo(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new ao(e,r):new co(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(un(t,this.value)):t!==null&&mt(this.value)===mt(t)&&this.matchesComparison(un(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return M(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Re=class n extends ri{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new n(e,t)}matches(e){return Nh(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function Nh(n){return n.op==="and"}function Fh(n){return fp(n)&&Nh(n)}function fp(n){for(let e of n.filters)if(e instanceof Re)return!1;return!0}function so(n){if(n instanceof ie)return n.field.canonicalString()+n.op.toString()+ln(n.value);if(Fh(n))return n.filters.map(e=>so(e)).join(",");{let e=n.filters.map(t=>so(t)).join(",");return`${n.op}(${e})`}}function Oh(n,e){return n instanceof ie?function(r,i){return i instanceof ie&&r.op===i.op&&r.field.isEqual(i.field)&&qe(r.value,i.value)}(n,e):n instanceof Re?function(r,i){return i instanceof Re&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,a,l)=>o&&Oh(a,i.filters[l]),!0):!1}(n,e):void M(19439)}function Mh(n){return n instanceof ie?function(t){return`${t.field.canonicalString()} ${t.op} ${ln(t.value)}`}(n):n instanceof Re?function(t){return t.op.toString()+" {"+t.getFilters().map(Mh).join(" ,")+"}"}(n):"Filter"}var oo=class extends ie{constructor(e,t,r){super(e,t,r),this.key=O.fromName(r.referenceValue)}matches(e){let t=O.comparator(e.key,this.key);return this.matchesComparison(t)}},ao=class extends ie{constructor(e,t){super(e,"in",t),this.keys=Lh("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},co=class extends ie{constructor(e,t){super(e,"not-in",t),this.keys=Lh("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function Lh(n,e){return(e.arrayValue?.values||[]).map(t=>O.fromName(t.referenceValue))}var uo=class extends ie{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Ba(t)&&rr(t.arrayValue,this.value)}},lo=class extends ie{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&rr(this.value.arrayValue,t)}},ho=class extends ie{constructor(e,t){super(e,"not-in",t)}matches(e){if(rr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!rr(this.value.arrayValue,t)}},fo=class extends ie{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Ba(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>rr(this.value.arrayValue,r))}};var mo=class{constructor(e,t=null,r=[],i=[],o=null,a=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=a,this.endAt=l,this.Te=null}};function Vl(n,e=null,t=[],r=[],i=null,o=null,a=null){return new mo(n,e,t,r,i,o,a)}function Ua(n){let e=L(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>so(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),Ri(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>ln(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>ln(r)).join(",")),e.Te=t}return e.Te}function qa(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!dp(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Oh(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Dl(n.startAt,e.startAt)&&Dl(n.endAt,e.endAt)}function po(n){return O.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Nt=class{constructor(e,t=null,r=[],i=[],o=null,a="F",l=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=a,this.startAt=l,this.endAt=h,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}};function mp(n,e,t,r,i,o,a,l){return new Nt(n,e,t,r,i,o,a,l)}function za(n){return new Nt(n)}function Nl(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Bh(n){return n.collectionGroup!==null}function Jn(n){let e=L(n);if(e.Ie===null){e.Ie=[];let t=new Set;for(let o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new he(Te.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new dn(o,r))}),t.has(Te.keyField().canonicalString())||e.Ie.push(new dn(Te.keyField(),r))}return e.Ie}function Be(n){let e=L(n);return e.Ee||(e.Ee=pp(e,Jn(n))),e.Ee}function pp(n,e){if(n.limitType==="F")return Vl(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new dn(i.field,o)});let t=n.endAt?new hn(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new hn(n.startAt.position,n.startAt.inclusive):null;return Vl(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function go(n,e){let t=n.filters.concat([e]);return new Nt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function _o(n,e,t){return new Nt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Di(n,e){return qa(Be(n),Be(e))&&n.limitType===e.limitType}function Uh(n){return`${Ua(Be(n))}|lt:${n.limitType}`}function Zt(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>Mh(i)).join(", ")}]`),Ri(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>ln(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>ln(i)).join(",")),`Target(${r})`}(Be(n))}; limitType=${n.limitType})`}function Vi(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):O.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of Jn(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,l,h){let d=Pl(a,l,h);return a.inclusive?d<=0:d<0}(r.startAt,Jn(r),i)||r.endAt&&!function(a,l,h){let d=Pl(a,l,h);return a.inclusive?d>=0:d>0}(r.endAt,Jn(r),i))}(n,e)}function gp(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function qh(n){return(e,t)=>{let r=!1;for(let i of Jn(n)){let o=_p(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function _p(n,e,t){let r=n.field.isKeyField()?O.comparator(e.key,t.key):function(o,a,l){let h=a.data.field(o),d=l.data.field(o);return h!==null&&d!==null?un(h,d):M(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return M(19790,{direction:n.dir})}}var Ye=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){_t(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return kh(this.inner)}size(){return this.innerSize}};var yp=new te(O.comparator);function Ze(){return yp}var zh=new te(O.comparator);function Hn(...n){let e=zh;for(let t of n)e=e.insert(t.key,t);return e}function jh(n){let e=zh;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function xt(){return Xn()}function $h(){return Xn()}function Xn(){return new Ye(n=>n.toString(),(n,e)=>n.isEqual(e))}var bp=new te(O.comparator),wp=new he(O.comparator);function z(...n){let e=wp;for(let t of n)e=e.add(t);return e}var vp=new he(q);function Ip(){return vp}function ja(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:tr(e)?"-0":e}}function Gh(n){return{integerValue:""+n}}function Ep(n,e){return Ym(e)?Gh(e):ja(n,e)}var fn=class{constructor(){this._=void 0}};function Tp(n,e,t){return n instanceof mn?function(i,o){let a={fields:{[xh]:{stringValue:Ah},[Ch]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Oa(o)&&(o=Pi(o)),o&&(a.fields[Sh]=o),{mapValue:a}}(t,e):n instanceof Ft?Qh(n,e):n instanceof Ot?Hh(n,e):function(i,o){let a=Kh(i,o),l=Fl(a)+Fl(i.Ae);return io(a)&&io(i.Ae)?Gh(l):ja(i.serializer,l)}(n,e)}function kp(n,e,t){return n instanceof Ft?Qh(n,e):n instanceof Ot?Hh(n,e):t}function Kh(n,e){return n instanceof pn?function(r){return io(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var mn=class extends fn{},Ft=class extends fn{constructor(e){super(),this.elements=e}};function Qh(n,e){let t=Wh(e);for(let r of n.elements)t.some(i=>qe(i,r))||t.push(r);return{arrayValue:{values:t}}}var Ot=class extends fn{constructor(e){super(),this.elements=e}};function Hh(n,e){let t=Wh(e);for(let r of n.elements)t=t.filter(i=>!qe(i,r));return{arrayValue:{values:t}}}var pn=class extends fn{constructor(e,t){super(),this.serializer=e,this.Ae=t}};function Fl(n){return Y(n.integerValue||n.doubleValue)}function Wh(n){return Ba(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function Ap(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Ft&&i instanceof Ft||r instanceof Ot&&i instanceof Ot?an(r.elements,i.elements,qe):r instanceof pn&&i instanceof pn?qe(r.Ae,i.Ae):r instanceof mn&&i instanceof mn}(n.transform,e.transform)}var yo=class{constructor(e,t){this.version=e,this.transformResults=t}},He=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Wr(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var gn=class{};function Jh(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new ir(n.key,He.none()):new Mt(n.key,n.data,He.none());{let t=n.data,r=Ee.empty(),i=new he(Te.comparator);for(let o of e.fields)if(!i.has(o)){let a=t.field(o);a===null&&o.length>1&&(o=o.popLast(),a=t.field(o)),a===null?r.delete(o):r.set(o,a),i=i.add(o)}return new ze(n.key,r,new xe(i.toArray()),He.none())}}function xp(n,e,t){n instanceof Mt?function(i,o,a){let l=i.value.clone(),h=Ml(i.fieldTransforms,o,a.transformResults);l.setAll(h),o.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):n instanceof ze?function(i,o,a){if(!Wr(i.precondition,o))return void o.convertToUnknownDocument(a.version);let l=Ml(i.fieldTransforms,o,a.transformResults),h=o.data;h.setAll(Xh(i)),h.setAll(l),o.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function Yn(n,e,t,r){return n instanceof Mt?function(o,a,l,h){if(!Wr(o.precondition,a))return l;let d=o.value.clone(),m=Ll(o.fieldTransforms,h,a);return d.setAll(m),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(n,e,t,r):n instanceof ze?function(o,a,l,h){if(!Wr(o.precondition,a))return l;let d=Ll(o.fieldTransforms,h,a),m=a.data;return m.setAll(Xh(o)),m.setAll(d),a.convertToFoundDocument(a.version,m).setHasLocalMutations(),l===null?null:l.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(b=>b.field))}(n,e,t,r):function(o,a,l){return Wr(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(n,e,t)}function Sp(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=Kh(r.transform,i||null);o!=null&&(t===null&&(t=Ee.empty()),t.set(r.field,o))}return t||null}function Ol(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&an(r,i,(o,a)=>Ap(o,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Mt=class extends gn{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},ze=class extends gn{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function Xh(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Ml(n,e,t){let r=new Map;H(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){let o=n[i],a=o.transform,l=e.data.field(o.field);r.set(o.field,kp(a,l,t[i]))}return r}function Ll(n,e,t){let r=new Map;for(let i of n){let o=i.transform,a=t.data.field(i.field);r.set(i.field,Tp(o,a,e))}return r}var ir=class extends gn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},bo=class extends gn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var wo=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&xp(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Yn(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Yn(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=$h();return this.mutations.forEach(i=>{let o=e.get(i.key),a=o.overlayedDocument,l=this.applyToLocalView(a,o.mutatedFields);l=t.has(i.key)?null:l;let h=Jh(a,l);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument(B.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),z())}isEqual(e){return this.batchId===e.batchId&&an(this.mutations,e.mutations,(t,r)=>Ol(t,r))&&an(this.baseMutations,e.baseMutations,(t,r)=>Ol(t,r))}},vo=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){H(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return bp}(),o=e.mutations;for(let a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new n(e,t,r,i)}};var Io=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Eo=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var ne,$;function Cp(n){switch(n){case A.OK:return M(64938);case A.CANCELLED:case A.UNKNOWN:case A.DEADLINE_EXCEEDED:case A.RESOURCE_EXHAUSTED:case A.INTERNAL:case A.UNAVAILABLE:case A.UNAUTHENTICATED:return!1;case A.INVALID_ARGUMENT:case A.NOT_FOUND:case A.ALREADY_EXISTS:case A.PERMISSION_DENIED:case A.FAILED_PRECONDITION:case A.ABORTED:case A.OUT_OF_RANGE:case A.UNIMPLEMENTED:case A.DATA_LOSS:return!0;default:return M(15467,{code:n})}}function Yh(n){if(n===void 0)return We("GRPC error has no .code"),A.UNKNOWN;switch(n){case ne.OK:return A.OK;case ne.CANCELLED:return A.CANCELLED;case ne.UNKNOWN:return A.UNKNOWN;case ne.DEADLINE_EXCEEDED:return A.DEADLINE_EXCEEDED;case ne.RESOURCE_EXHAUSTED:return A.RESOURCE_EXHAUSTED;case ne.INTERNAL:return A.INTERNAL;case ne.UNAVAILABLE:return A.UNAVAILABLE;case ne.UNAUTHENTICATED:return A.UNAUTHENTICATED;case ne.INVALID_ARGUMENT:return A.INVALID_ARGUMENT;case ne.NOT_FOUND:return A.NOT_FOUND;case ne.ALREADY_EXISTS:return A.ALREADY_EXISTS;case ne.PERMISSION_DENIED:return A.PERMISSION_DENIED;case ne.FAILED_PRECONDITION:return A.FAILED_PRECONDITION;case ne.ABORTED:return A.ABORTED;case ne.OUT_OF_RANGE:return A.OUT_OF_RANGE;case ne.UNIMPLEMENTED:return A.UNIMPLEMENTED;case ne.DATA_LOSS:return A.DATA_LOSS;default:return M(39323,{code:n})}}($=ne||(ne={}))[$.OK=0]="OK",$[$.CANCELLED=1]="CANCELLED",$[$.UNKNOWN=2]="UNKNOWN",$[$.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$[$.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$[$.NOT_FOUND=5]="NOT_FOUND",$[$.ALREADY_EXISTS=6]="ALREADY_EXISTS",$[$.PERMISSION_DENIED=7]="PERMISSION_DENIED",$[$.UNAUTHENTICATED=16]="UNAUTHENTICATED",$[$.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$[$.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$[$.ABORTED=10]="ABORTED",$[$.OUT_OF_RANGE=11]="OUT_OF_RANGE",$[$.UNIMPLEMENTED=12]="UNIMPLEMENTED",$[$.INTERNAL=13]="INTERNAL",$[$.UNAVAILABLE=14]="UNAVAILABLE",$[$.DATA_LOSS=15]="DATA_LOSS";var Rp=null;function Pp(){return new TextEncoder}var Dp=new Ke([4294967295,4294967295],0);function Bl(n){let e=Pp().encode(n),t=new Os;return t.update(e),new Uint8Array(t.digest())}function Ul(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Ke([t,r],0),new Ke([i,o],0)]}var To=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new St(`Invalid padding: ${t}`);if(r<0)throw new St(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new St(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new St(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ke.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(Ke.fromNumber(r)));return i.compare(Dp)===1&&(i=new Ke([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;let t=Bl(e),[r,i]=Ul(t);for(let o=0;o<this.hashCount;o++){let a=this.ye(r,i,o);if(!this.we(a))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new n(o,i,t);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.ge===0)return;let t=Bl(e),[r,i]=Ul(t);for(let o=0;o<this.hashCount;o++){let a=this.ye(r,i,o);this.Se(a)}}Se(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},St=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var ii=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,sr.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(B.min(),i,new te(q),Ze(),z())}},sr=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,z(),z(),z())}};var rn=class{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}},si=class{constructor(e,t){this.targetId=e,this.Ce=t}},oi=class{constructor(e,t,r=ge.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},ai=class{constructor(){this.ve=0,this.Fe=ql(),this.Me=ge.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=z(),t=z(),r=z();return this.Fe.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:M(38017,{changeType:o})}}),new sr(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=ql()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,H(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}},ko=class{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ze(),this.Je=Gr(),this.He=Gr(),this.Ye=new te(q)}Ze(e){for(let t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(let t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{let r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:M(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((r,i)=>{this.rt(i)&&t(i)})}st(e){let t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){let o=i.target;if(po(o))if(r===0){let a=new O(o.path);this.et(t,a,Ce.newNoDocument(a,B.min()))}else H(r===1,20013,{expectedCount:r});else{let a=this._t(t);if(a!==r){let l=this.ut(e),h=l?this.ct(l,e,a):1;if(h!==0){this.it(t);let d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,d)}Rp?.lt(function(m,b,E,S,N){let F={localCacheCount:m,existenceFilterCount:b.count,databaseId:E.database,projectId:E.projectId},P=b.unchangedNames;return P&&(F.bloomFilter={applied:N===0,hashCount:P?.hashCount??0,bitmapLength:P?.bits?.bitmap?.length??0,padding:P?.bits?.padding??0,mightContain:G=>S?.mightContain(G)??!1}),F}(a,e.Ce,this.Ge.ht(),l,h))}}}}ut(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,a,l;try{a=Xe(r).toUint8Array()}catch(h){if(h instanceof ei)return on("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{l=new To(a,i,o)}catch(h){return on(h instanceof St?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return l.ge===0?null:l}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){let r=this.Ge.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let a=this.Ge.ht(),l=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(l)||(this.et(t,o,null),i++)}),i}Tt(e){let t=new Map;this.ze.forEach((o,a)=>{let l=this.ot(a);if(l){if(o.current&&po(l.target)){let h=new O(l.target.path);this.It(h).has(a)||this.Et(a,h)||this.et(a,h,Ce.newNoDocument(h,e))}o.Be&&(t.set(a,o.ke()),o.qe())}});let r=z();this.He.forEach((o,a)=>{let l=!0;a.forEachWhile(h=>{let d=this.ot(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(o))}),this.je.forEach((o,a)=>a.setReadTime(e));let i=new ii(e,t,this.Ye,this.je,r);return this.je=Ze(),this.Je=Gr(),this.He=Gr(),this.Ye=new te(q),i}Xe(e,t){if(!this.rt(e))return;let r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;let i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){let t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new ai,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new he(q),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new he(q),this.Je=this.Je.insert(e,t)),t}rt(e){let t=this.ot(e)!==null;return t||V("WatchChangeAggregator","Detected inactive target",e),t}ot(e){let t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new ai),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}};function Gr(){return new te(O.comparator)}function ql(){return new te(O.comparator)}var Vp={asc:"ASCENDING",desc:"DESCENDING"},Np={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Fp={and:"AND",or:"OR"},Ao=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function xo(n,e){return n.useProto3Json||Ri(e)?e:{value:e}}function ci(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Zh(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Op(n,e){return ci(n,e.toTimestamp())}function Ue(n){return H(!!n,49232),B.fromTimestamp(function(t){let r=Je(t);return new oe(r.seconds,r.nanos)}(n))}function $a(n,e){return So(n,e).canonicalString()}function So(n,e){let t=function(i){return new Z(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function ed(n){let e=Z.fromString(n);return H(sd(e),10190,{key:e.toString()}),e}function Co(n,e){return $a(n.databaseId,e.path)}function js(n,e){let t=ed(e);if(t.get(1)!==n.databaseId.projectId)throw new D(A.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new D(A.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new O(nd(t))}function td(n,e){return $a(n.databaseId,e)}function Mp(n){let e=ed(n);return e.length===4?Z.emptyPath():nd(e)}function Ro(n){return new Z(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function nd(n){return H(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function zl(n,e,t){return{name:Co(n,e),fields:t.value.mapValue.fields}}function Lp(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:M(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(d,m){return d.useProto3Json?(H(m===void 0||typeof m=="string",58123),ge.fromBase64String(m||"")):(H(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),ge.fromUint8Array(m||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(d){let m=d.code===void 0?A.UNKNOWN:Yh(d.code);return new D(m,d.message||"")}(a);t=new oi(r,i,o,l||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=js(n,r.document.name),o=Ue(r.document.updateTime),a=r.document.createTime?Ue(r.document.createTime):B.min(),l=new Ee({mapValue:{fields:r.document.fields}}),h=Ce.newFoundDocument(i,o,a,l),d=r.targetIds||[],m=r.removedTargetIds||[];t=new rn(d,m,h.key,h)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=js(n,r.document),o=r.readTime?Ue(r.readTime):B.min(),a=Ce.newNoDocument(i,o),l=r.removedTargetIds||[];t=new rn([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=js(n,r.document),o=r.removedTargetIds||[];t=new rn([],o,i,null)}else{if(!("filter"in e))return M(11601,{Rt:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,a=new Eo(i,o),l=r.targetId;t=new si(l,a)}}return t}function Bp(n,e){let t;if(e instanceof Mt)t={update:zl(n,e.key,e.value)};else if(e instanceof ir)t={delete:Co(n,e.key)};else if(e instanceof ze)t={update:zl(n,e.key,e.data),updateMask:Hp(e.fieldMask)};else{if(!(e instanceof bo))return M(16599,{Vt:e.type});t={verify:Co(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,a){let l=a.transform;if(l instanceof mn)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Ft)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Ot)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof pn)return{fieldPath:a.field.canonicalString(),increment:l.Ae};throw M(20930,{transform:a.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:Op(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:M(27497)}(n,e.precondition)),t}function Up(n,e){return n&&n.length>0?(H(e!==void 0,14353),n.map(t=>function(i,o){let a=i.updateTime?Ue(i.updateTime):Ue(o);return a.isEqual(B.min())&&(a=Ue(o)),new yo(a,i.transformResults||[])}(t,e))):[]}function qp(n,e){return{documents:[td(n,e.path)]}}function zp(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=td(n,i);let o=function(d){if(d.length!==0)return id(Re.create(d,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let a=function(d){if(d.length!==0)return d.map(m=>function(E){return{field:en(E.field),direction:Gp(E.dir)}}(m))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let l=xo(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:t,parent:i}}function jp(n){let e=Mp(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){H(r===1,65062);let m=t.from[0];m.allDescendants?i=m.collectionId:e=e.child(m.collectionId)}let o=[];t.where&&(o=function(b){let E=rd(b);return E instanceof Re&&Fh(E)?E.getFilters():[E]}(t.where));let a=[];t.orderBy&&(a=function(b){return b.map(E=>function(N){return new dn(tn(N.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(N.direction))}(E))}(t.orderBy));let l=null;t.limit&&(l=function(b){let E;return E=typeof b=="object"?b.value:b,Ri(E)?null:E}(t.limit));let h=null;t.startAt&&(h=function(b){let E=!!b.before,S=b.values||[];return new hn(S,E)}(t.startAt));let d=null;return t.endAt&&(d=function(b){let E=!b.before,S=b.values||[];return new hn(S,E)}(t.endAt)),mp(e,i,a,o,l,"F",h,d)}function $p(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return M(28987,{purpose:i})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function rd(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=tn(t.unaryFilter.field);return ie.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=tn(t.unaryFilter.field);return ie.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=tn(t.unaryFilter.field);return ie.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=tn(t.unaryFilter.field);return ie.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return M(61313);default:return M(60726)}}(n):n.fieldFilter!==void 0?function(t){return ie.create(tn(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return M(58110);default:return M(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Re.create(t.compositeFilter.filters.map(r=>rd(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return M(1026)}}(t.compositeFilter.op))}(n):M(30097,{filter:n})}function Gp(n){return Vp[n]}function Kp(n){return Np[n]}function Qp(n){return Fp[n]}function en(n){return{fieldPath:n.canonicalString()}}function tn(n){return Te.fromServerFormat(n.fieldPath)}function id(n){return n instanceof ie?function(t){if(t.op==="=="){if(Rl(t.value))return{unaryFilter:{field:en(t.field),op:"IS_NAN"}};if(Cl(t.value))return{unaryFilter:{field:en(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Rl(t.value))return{unaryFilter:{field:en(t.field),op:"IS_NOT_NAN"}};if(Cl(t.value))return{unaryFilter:{field:en(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:en(t.field),op:Kp(t.op),value:t.value}}}(n):n instanceof Re?function(t){let r=t.getFilters().map(i=>id(i));return r.length===1?r[0]:{compositeFilter:{op:Qp(t.op),filters:r}}}(n):M(54877,{filter:n})}function Hp(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function sd(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var or=class n{constructor(e,t,r,i,o=B.min(),a=B.min(),l=ge.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=h}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Po=class{constructor(e){this.yt=e}};function Wp(n){let e=jp({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?_o(e,e.limit,"L"):e}var ui=class{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Y(e.integerValue));else if("doubleValue"in e){let r=Y(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),tr(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=Je(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Xe(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?Dh(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Ph(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):M(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){let r=e.fields||{};this.Ft(t,55);for(let i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){let r=e.fields||{};this.Ft(t,53);let i=cn,o=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Y(o)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){let r=e.values||[];this.Ft(t,50);for(let i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),O.fromName(e).path.forEach(r=>{this.Ft(t,60),this.Ut(r,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}};ui.Kt=new ui;var Do=class{constructor(){this.Cn=new Vo}addToCollectionParentIndex(e,t){return this.Cn.add(t),C.resolve()}getCollectionParents(e,t){return C.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return C.resolve()}deleteFieldIndex(e,t){return C.resolve()}deleteAllFieldIndexes(e){return C.resolve()}createTargetIndexes(e,t){return C.resolve()}getDocumentsMatchingTarget(e,t){return C.resolve(null)}getIndexType(e,t){return C.resolve(0)}getFieldIndexes(e,t){return C.resolve([])}getNextCollectionGroupToUpdate(e){return C.resolve(null)}getMinOffset(e,t){return C.resolve(Vt.min())}getMinOffsetFromCollectionGroup(e,t){return C.resolve(Vt.min())}updateCollectionGroup(e,t,r){return C.resolve()}updateIndexEntries(e,t){return C.resolve()}},Vo=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new he(Z.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new he(Z.comparator)).toArray()}};var oy=new Uint8Array(0);var jl={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},od=41943040,Ae=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};Ae.DEFAULT_COLLECTION_PERCENTILE=10,Ae.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ae.DEFAULT=new Ae(od,Ae.DEFAULT_COLLECTION_PERCENTILE,Ae.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ae.DISABLED=new Ae(-1,0,0);var ar=class n{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new n(0)}static cr(){return new n(-1)}};var $l="LruGarbageCollector",Jp=1048576;function Gl([n,e],[t,r]){let i=q(n,t);return i===0?q(e,r):i}var No=class{constructor(e){this.Ir=e,this.buffer=new he(Gl),this.Er=0}dr(){return++this.Er}Ar(e){let t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();Gl(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},Fo=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){V($l,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>x(this,null,function*(){this.Rr=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){In(t)?V($l,"Ignoring IndexedDB error during garbage collection: ",t):yield vn(t)}yield this.Vr(3e5)}))}},Oo=class{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return C.resolve(Na.ce);let r=new No(t);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(V("LruGarbageCollector","Garbage collection skipped; disabled"),C.resolve(jl)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(V("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),jl):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,o,a,l,h,d,m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(b=>(b>this.params.maximumSequenceNumbersToCollect?(V("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${b}`),i=this.params.maximumSequenceNumbersToCollect):i=b,a=Date.now(),this.nthSequenceNumber(e,i))).next(b=>(r=b,l=Date.now(),this.removeTargets(e,r,t))).next(b=>(o=b,h=Date.now(),this.removeOrphanedDocuments(e,r))).next(b=>(d=Date.now(),Yt()<=j.DEBUG&&V("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-m}ms
	Determined least recently used ${i} in `+(l-a)+`ms
	Removed ${o} targets in `+(h-l)+`ms
	Removed ${b} documents in `+(d-h)+`ms
Total Duration: ${d-m}ms`),C.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:b})))}};function Xp(n,e){return new Oo(n,e)}var Mo=class{constructor(){this.changes=new Ye(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ce.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?C.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Lo=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Bo=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Yn(r.mutation,i,xe.empty(),oe.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,z()).next(()=>r))}getLocalViewOfDocuments(e,t,r=z()){let i=xt();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let a=Hn();return o.forEach((l,h)=>{a=a.insert(l,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=xt();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,z()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((a,l)=>{t.set(a,l)})})}computeViews(e,t,r,i){let o=Ze(),a=Xn(),l=function(){return Xn()}();return t.forEach((h,d)=>{let m=r.get(d.key);i.has(d.key)&&(m===void 0||m.mutation instanceof ze)?o=o.insert(d.key,d):m!==void 0?(a.set(d.key,m.mutation.getFieldMask()),Yn(m.mutation,d,m.mutation.getFieldMask(),oe.now())):a.set(d.key,xe.empty())}),this.recalculateAndSaveOverlays(e,o).next(h=>(h.forEach((d,m)=>a.set(d,m)),t.forEach((d,m)=>l.set(d,new Lo(m,a.get(d)??null))),l))}recalculateAndSaveOverlays(e,t){let r=Xn(),i=new te((a,l)=>a-l),o=z();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let l of a)l.keys().forEach(h=>{let d=t.get(h);if(d===null)return;let m=r.get(h)||xe.empty();m=l.applyToLocalView(d,m),r.set(h,m);let b=(i.get(l.batchId)||z()).add(h);i=i.insert(l.batchId,b)})}).next(()=>{let a=[],l=i.getReverseIterator();for(;l.hasNext();){let h=l.getNext(),d=h.key,m=h.value,b=$h();m.forEach(E=>{if(!o.has(E)){let S=Jh(t.get(E),r.get(E));S!==null&&b.set(E,S),o=o.add(E)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,b))}return C.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return O.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Bh(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):C.resolve(xt()),l=er,h=o;return a.next(d=>C.forEach(d,(m,b)=>(l<b.largestBatchId&&(l=b.largestBatchId),o.get(m)?C.resolve():this.remoteDocumentCache.getEntry(e,m).next(E=>{h=h.insert(m,E)}))).next(()=>this.populateOverlays(e,d,o)).next(()=>this.computeViews(e,h,d,z())).next(m=>({batchId:l,changes:jh(m)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new O(t)).next(r=>{let i=Hn();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,a=Hn();return this.indexManager.getCollectionParents(e,o).next(l=>C.forEach(l,h=>{let d=function(b,E){return new Nt(E,null,b.explicitOrderBy.slice(),b.filters.slice(),b.limit,b.limitType,b.startAt,b.endAt)}(t,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(m=>{m.forEach((b,E)=>{a=a.insert(b,E)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(a=>{o.forEach((h,d)=>{let m=d.getKey();a.get(m)===null&&(a=a.insert(m,Ce.newInvalidDocument(m)))});let l=Hn();return a.forEach((h,d)=>{let m=o.get(h);m!==void 0&&Yn(m.mutation,d,xe.empty(),oe.now()),Vi(t,d)&&(l=l.insert(h,d))}),l})}};var Uo=class{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return C.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Ue(i.createTime)}}(t)),C.resolve()}getNamedQuery(e,t){return C.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(i){return{name:i.name,query:Wp(i.bundledQuery),readTime:Ue(i.readTime)}}(t)),C.resolve()}};var qo=class{constructor(){this.overlays=new te(O.comparator),this.qr=new Map}getOverlay(e,t){return C.resolve(this.overlays.get(t))}getOverlays(e,t){let r=xt();return C.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.St(e,t,o)}),C.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.qr.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.qr.delete(r)),C.resolve()}getOverlaysForCollection(e,t,r){let i=xt(),o=t.length+1,a=new O(t.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){let h=l.getNext().value,d=h.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===o&&h.largestBatchId>r&&i.set(h.getKey(),h)}return C.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new te((d,m)=>d-m),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let m=o.get(d.largestBatchId);m===null&&(m=xt(),o=o.insert(d.largestBatchId,m)),m.set(d.getKey(),d)}}let l=xt(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((d,m)=>l.set(d,m)),!(l.size()>=i)););return C.resolve(l)}St(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Io(t,r));let o=this.qr.get(t);o===void 0&&(o=z(),this.qr.set(t,o)),this.qr.set(t,o.add(r.key))}};var zo=class{constructor(){this.sessionToken=ge.EMPTY_BYTE_STRING}getSessionToken(e){return C.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,C.resolve()}};var cr=class{constructor(){this.Qr=new he(re.$r),this.Ur=new he(re.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){let r=new re(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Gr(new re(e,t))}zr(e,t){e.forEach(r=>this.removeReference(r,t))}jr(e){let t=new O(new Z([])),r=new re(t,e),i=new re(t,e+1),o=[];return this.Ur.forEachInRange([r,i],a=>{this.Gr(a),o.push(a.key)}),o}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){let t=new O(new Z([])),r=new re(t,e),i=new re(t,e+1),o=z();return this.Ur.forEachInRange([r,i],a=>{o=o.add(a.key)}),o}containsKey(e){let t=new re(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},re=class{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return O.comparator(e.key,t.key)||q(e.Yr,t.Yr)}static Kr(e,t){return q(e.Yr,t.Yr)||O.comparator(e.key,t.key)}};var jo=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new he(re.$r)}checkEmpty(e){return C.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new wo(o,t,r,i);this.mutationQueue.push(a);for(let l of i)this.Zr=this.Zr.add(new re(l.key,o)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return C.resolve(a)}lookupMutationBatch(e,t){return C.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.ei(r),o=i<0?0:i;return C.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return C.resolve(this.mutationQueue.length===0?Fa:this.tr-1)}getAllMutationBatches(e){return C.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new re(t,0),i=new re(t,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([r,i],a=>{let l=this.Xr(a.Yr);o.push(l)}),C.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new he(q);return t.forEach(i=>{let o=new re(i,0),a=new re(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,a],l=>{r=r.add(l.Yr)})}),C.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;O.isDocumentKey(o)||(o=o.child(""));let a=new re(new O(o),0),l=new he(q);return this.Zr.forEachWhile(h=>{let d=h.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(l=l.add(h.Yr)),!0)},a),C.resolve(this.ti(l))}ti(e){let t=[];return e.forEach(r=>{let i=this.Xr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){H(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return C.forEach(t.mutations,i=>{let o=new re(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,t){let r=new re(t,0),i=this.Zr.firstAfterOrEqual(r);return C.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,C.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){let t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var $o=class{constructor(e){this.ri=e,this.docs=function(){return new te(O.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return C.resolve(r?r.document.mutableCopy():Ce.newInvalidDocument(t))}getEntries(e,t){let r=Ze();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():Ce.newInvalidDocument(i))}),C.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=Ze(),a=t.path,l=new O(a.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(l);for(;h.hasNext();){let{key:d,value:{document:m}}=h.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||Wm(Hm(m),r)<=0||(i.has(m.key)||Vi(t,m))&&(o=o.insert(m.key,m.mutableCopy()))}return C.resolve(o)}getAllFromCollectionGroup(e,t,r,i){M(9500)}ii(e,t){return C.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Go(this)}getSize(e){return C.resolve(this.size)}},Go=class extends Mo{constructor(e){super(),this.Nr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),C.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}};var Ko=class{constructor(e){this.persistence=e,this.si=new Ye(t=>Ua(t),qa),this.lastRemoteSnapshotVersion=B.min(),this.highestTargetId=0,this.oi=0,this._i=new cr,this.targetCount=0,this.ai=ar.ur()}forEachTarget(e,t){return this.si.forEach((r,i)=>t(i)),C.resolve()}getLastRemoteSnapshotVersion(e){return C.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return C.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),C.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),C.resolve()}Pr(e){this.si.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.ai=new ar(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,C.resolve()}updateTargetData(e,t){return this.Pr(t),C.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,C.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.si.forEach((a,l)=>{l.sequenceNumber<=t&&r.get(l.targetId)===null&&(this.si.delete(a),o.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),C.waitFor(o).next(()=>i)}getTargetCount(e){return C.resolve(this.targetCount)}getTargetData(e,t){let r=this.si.get(t)||null;return C.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),C.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(a=>{o.push(i.markPotentiallyOrphaned(e,a))}),C.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),C.resolve()}getMatchingKeysForTargetId(e,t){let r=this._i.Hr(t);return C.resolve(r)}containsKey(e,t){return C.resolve(this._i.containsKey(t))}};var li=class{constructor(e,t){this.ui={},this.overlays={},this.ci=new Na(0),this.li=!1,this.li=!0,this.hi=new zo,this.referenceDelegate=e(this),this.Pi=new Ko(this),this.indexManager=new Do,this.remoteDocumentCache=function(i){return new $o(i)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new Po(t),this.Ii=new Uo(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new qo,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new jo(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){V("MemoryPersistence","Starting transaction:",e);let i=new Qo(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ai(e,t){return C.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,t)))}},Qo=class extends to{constructor(e){super(),this.currentSequenceNumber=e}},Ho=class n{constructor(e){this.persistence=e,this.Ri=new cr,this.Vi=null}static mi(e){return new n(e)}get fi(){if(this.Vi)return this.Vi;throw M(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),C.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),C.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),C.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(i=>this.fi.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.fi.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return C.forEach(this.fi,r=>{let i=O.fromPath(r);return this.gi(e,i).next(o=>{o||t.removeEntry(i,B.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return C.or([()=>C.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}},hi=class n{constructor(e,t){this.persistence=e,this.pi=new Ye(r=>Zm(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=Xp(this,t)}static mi(e,t){return new n(e,t)}Ei(){}di(e){return C.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){let t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}wr(e){let t=0;return this.pr(e,r=>{t++}).next(()=>t)}pr(e,t){return C.forEach(this.pi,(r,i)=>this.br(e,r,i).next(o=>o?C.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ii(e,a=>this.br(e,a,t).next(l=>{l||(r++,o.removeEntry(a,B.min()))})).next(()=>o.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),C.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),C.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),C.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),C.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Qr(e.data.value)),t}br(e,t,r){return C.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.pi.get(t);return C.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var Wo=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=z(),i=z();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var Jo=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Xo=class{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return Wu()?8:Xm(Hu())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.ys(e,t).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.ws(e,t,i,r).next(a=>{o.result=a})}).next(()=>{if(o.result)return;let a=new Jo;return this.Ss(e,t,a).next(l=>{if(o.result=l,this.Vs)return this.bs(e,t,a,l.size)})}).next(()=>o.result)}bs(e,t,r,i){return r.documentReadCount<this.fs?(Yt()<=j.DEBUG&&V("QueryEngine","SDK will not create cache indexes for query:",Zt(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),C.resolve()):(Yt()<=j.DEBUG&&V("QueryEngine","Query:",Zt(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Yt()<=j.DEBUG&&V("QueryEngine","The SDK decides to create cache indexes for query:",Zt(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Be(t))):C.resolve())}ys(e,t){if(Nl(t))return C.resolve(null);let r=Be(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=_o(t,null,"F"),r=Be(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let a=z(...o);return this.ps.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(h=>{let d=this.Ds(t,l);return this.Cs(t,d,a,h.readTime)?this.ys(e,_o(t,null,"F")):this.vs(e,d,t,h)}))})))}ws(e,t,r,i){return Nl(t)||i.isEqual(B.min())?C.resolve(null):this.ps.getDocuments(e,r).next(o=>{let a=this.Ds(t,o);return this.Cs(t,a,r,i)?C.resolve(null):(Yt()<=j.DEBUG&&V("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Zt(t)),this.vs(e,a,t,Qm(i,er)).next(l=>l))})}Ds(e,t){let r=new he(qh(e));return t.forEach((i,o)=>{Vi(e,o)&&(r=r.add(o))}),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ss(e,t,r){return Yt()<=j.DEBUG&&V("QueryEngine","Using full collection scan to execute query:",Zt(t)),this.ps.getDocumentsMatchingQuery(e,t,Vt.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(a=>{o=o.insert(a.key,a)}),o))}};var Ga="LocalStore",Yp=3e8,Yo=class{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new te(q),this.xs=new Ye(o=>Ua(o),qa),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Bo(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}};function Zp(n,e,t,r){return new Yo(n,e,t,r)}function ad(n,e){return x(this,null,function*(){let t=L(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.Bs(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let a=[],l=[],h=z();for(let d of i){a.push(d.batchId);for(let m of d.mutations)h=h.add(m.key)}for(let d of o){l.push(d.batchId);for(let m of d.mutations)h=h.add(m.key)}return t.localDocuments.getDocuments(r,h).next(d=>({Ls:d,removedBatchIds:a,addedBatchIds:l}))})})})}function eg(n,e){let t=L(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.Ns.newChangeBuffer({trackRemovals:!0});return function(l,h,d,m){let b=d.batch,E=b.keys(),S=C.resolve();return E.forEach(N=>{S=S.next(()=>m.getEntry(h,N)).next(F=>{let P=d.docVersions.get(N);H(P!==null,48541),F.version.compareTo(P)<0&&(b.applyToRemoteDocument(F,d),F.isValidDocument()&&(F.setReadTime(d.commitVersion),m.addEntry(F)))})}),S.next(()=>l.mutationQueue.removeMutationBatch(h,b))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let h=z();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(h=h.add(l.batch.mutations[d].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function cd(n){let e=L(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function tg(n,e){let t=L(n),r=e.snapshotVersion,i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let a=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;let l=[];e.targetChanges.forEach((m,b)=>{let E=i.get(b);if(!E)return;l.push(t.Pi.removeMatchingKeys(o,m.removedDocuments,b).next(()=>t.Pi.addMatchingKeys(o,m.addedDocuments,b)));let S=E.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(b)!==null?S=S.withResumeToken(ge.EMPTY_BYTE_STRING,B.min()).withLastLimboFreeSnapshotVersion(B.min()):m.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(m.resumeToken,r)),i=i.insert(b,S),function(F,P,G){return F.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-F.snapshotVersion.toMicroseconds()>=Yp?!0:G.addedDocuments.size+G.modifiedDocuments.size+G.removedDocuments.size>0}(E,S,m)&&l.push(t.Pi.updateTargetData(o,S))});let h=Ze(),d=z();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(o,m))}),l.push(ng(o,a,e.documentUpdates).next(m=>{h=m.ks,d=m.qs})),!r.isEqual(B.min())){let m=t.Pi.getLastRemoteSnapshotVersion(o).next(b=>t.Pi.setTargetsMetadata(o,o.currentSequenceNumber,r));l.push(m)}return C.waitFor(l).next(()=>a.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,h,d)).next(()=>h)}).then(o=>(t.Ms=i,o))}function ng(n,e,t){let r=z(),i=z();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let a=Ze();return t.forEach((l,h)=>{let d=o.get(l);h.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(l)),h.isNoDocument()&&h.version.isEqual(B.min())?(e.removeEntry(l,h.readTime),a=a.insert(l,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(h),a=a.insert(l,h)):V(Ga,"Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",h.version)}),{ks:a,qs:i}})}function rg(n,e){let t=L(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Fa),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function ig(n,e){let t=L(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Pi.getTargetData(r,e).next(o=>o?(i=o,C.resolve(i)):t.Pi.allocateTargetId(r).next(a=>(i=new or(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r})}function Zo(n,e,t){return x(this,null,function*(){let r=L(n),i=r.Ms.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!In(a))throw a;V(Ga,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)})}function Kl(n,e,t){let r=L(n),i=B.min(),o=z();return r.persistence.runTransaction("Execute query","readwrite",a=>function(h,d,m){let b=L(h),E=b.xs.get(m);return E!==void 0?C.resolve(b.Ms.get(E)):b.Pi.getTargetData(d,m)}(r,a,Be(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,l.targetId).next(h=>{o=h})}).next(()=>r.Fs.getDocumentsMatchingQuery(a,e,t?i:B.min(),t?o:z())).next(l=>(sg(r,gp(e),l),{documents:l,Qs:o})))}function sg(n,e,t){let r=n.Os.get(e)||B.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.Os.set(e,r)}var di=class{constructor(){this.activeTargetIds=Ip()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var ea=class{constructor(){this.Mo=new di,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new di,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var ta=class{Oo(e){}shutdown(){}};var Ql="ConnectivityMonitor",fi=class{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){V(Ql,"Network connectivity changed: AVAILABLE");for(let e of this.qo)e(0)}ko(){V(Ql,"Network connectivity changed: UNAVAILABLE");for(let e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Kr=null;function na(){return Kr===null?Kr=function(){return 268435456+Math.round(2147483648*Math.random())}():Kr++,"0x"+Kr.toString(16)}var $s="RestConnection",og={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},ra=class{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===ti?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,o){let a=na(),l=this.zo(e,t.toUriEncodedString());V($s,`Sending RPC '${e}' ${a}:`,l,r);let h={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(h,i,o);let{host:d}=new URL(l),m=Lr(d);return this.Jo(e,l,h,r,m).then(b=>(V($s,`Received RPC '${e}' ${a}: `,b),b),b=>{throw on($s,`RPC '${e}' ${a} failed with error: `,b,"url: ",l,"request:",r),b})}Ho(e,t,r,i,o,a){return this.Go(e,t,r,i,o)}jo(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+wn}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,o)=>e[o]=i),r&&r.headers.forEach((i,o)=>e[o]=i)}zo(e,t){let r=og[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}};var ia=class{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}};var pe="WebChannelConnection",sa=class extends ra{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,o){let a=na();return new Promise((l,h)=>{let d=new Ms;d.setWithCredentials(!0),d.listenOnce(Ls.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Qn.NO_ERROR:let b=d.getResponseJson();V(pe,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(b)),l(b);break;case Qn.TIMEOUT:V(pe,`RPC '${e}' ${a} timed out`),h(new D(A.DEADLINE_EXCEEDED,"Request time out"));break;case Qn.HTTP_ERROR:let E=d.getStatus();if(V(pe,`RPC '${e}' ${a} failed with status:`,E,"response text:",d.getResponseText()),E>0){let S=d.getResponseJson();Array.isArray(S)&&(S=S[0]);let N=S?.error;if(N&&N.status&&N.message){let F=function(G){let K=G.toLowerCase().replace(/_/g,"-");return Object.values(A).indexOf(K)>=0?K:A.UNKNOWN}(N.status);h(new D(F,N.message))}else h(new D(A.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new D(A.UNAVAILABLE,"Connection failed."));break;default:M(9055,{l_:e,streamId:a,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{V(pe,`RPC '${e}' ${a} completed.`)}});let m=JSON.stringify(i);V(pe,`RPC '${e}' ${a} sending request:`,i),d.send(t,"POST",m,r,15)})}T_(e,t,r){let i=na(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=qs(),l=Us(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.useFetchStreams=!0),this.jo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;let m=o.join("");V(pe,`Creating RPC '${e}' stream ${i}: ${m}`,h);let b=a.createWebChannel(m,h);this.I_(b);let E=!1,S=!1,N=new ia({Yo:P=>{S?V(pe,`Not sending because RPC '${e}' stream ${i} is closed:`,P):(E||(V(pe,`Opening RPC '${e}' stream ${i} transport.`),b.open(),E=!0),V(pe,`RPC '${e}' stream ${i} sending:`,P),b.send(P))},Zo:()=>b.close()}),F=(P,G,K)=>{P.listen(G,Q=>{try{K(Q)}catch(_e){setTimeout(()=>{throw _e},0)}})};return F(b,Xt.EventType.OPEN,()=>{S||(V(pe,`RPC '${e}' stream ${i} transport opened.`),N.o_())}),F(b,Xt.EventType.CLOSE,()=>{S||(S=!0,V(pe,`RPC '${e}' stream ${i} transport closed`),N.a_(),this.E_(b))}),F(b,Xt.EventType.ERROR,P=>{S||(S=!0,on(pe,`RPC '${e}' stream ${i} transport errored. Name:`,P.name,"Message:",P.message),N.a_(new D(A.UNAVAILABLE,"The operation could not be completed")))}),F(b,Xt.EventType.MESSAGE,P=>{if(!S){let G=P.data[0];H(!!G,16349);let K=G,Q=K?.error||K[0]?.error;if(Q){V(pe,`RPC '${e}' stream ${i} received error:`,Q);let _e=Q.status,we=function(p){let _=ne[p];if(_!==void 0)return Yh(_)}(_e),ce=Q.message;we===void 0&&(we=A.INTERNAL,ce="Unknown error status: "+_e+" with message "+Q.message),S=!0,N.a_(new D(we,ce)),b.close()}else V(pe,`RPC '${e}' stream ${i} received:`,G),N.u_(G)}}),F(l,Bs.STAT_EVENT,P=>{P.stat===jr.PROXY?V(pe,`RPC '${e}' stream ${i} detected buffering proxy`):P.stat===jr.NOPROXY&&V(pe,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{N.__()},0),N}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}};function Gs(){return typeof document<"u"?document:null}function Ni(n){return new Ao(n,!0)}var mi=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();let t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&V("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}};var Hl="PersistentStream",pi=class{constructor(e,t,r,i,o,a,l,h){this.Mi=e,this.S_=r,this.b_=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=h,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new mi(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}stop(){return x(this,null,function*(){this.x_()&&(yield this.close(0))})}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}k_(){return x(this,null,function*(){if(this.O_())return this.close(0)})}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}close(e,t){return x(this,null,function*(){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===A.RESOURCE_EXHAUSTED?(We(t.toString()),We("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===A.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.r_(t)})}K_(){}auth(){this.state=1;let e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===t&&this.G_(r,i)},r=>{e(()=>{let i=new D(A.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,t){let r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(()=>x(this,null,function*(){this.state=0,this.start()}))}z_(e){return V(Hl,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(V(Hl,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},oa=class extends pi{constructor(e,t,r,i,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();let t=Lp(this.serializer,e),r=function(o){if(!("targetChange"in o))return B.min();let a=o.targetChange;return a.targetIds&&a.targetIds.length?B.min():a.readTime?Ue(a.readTime):B.min()}(e);return this.listener.H_(t,r)}Y_(e){let t={};t.database=Ro(this.serializer),t.addTarget=function(o,a){let l,h=a.target;if(l=po(h)?{documents:qp(o,h)}:{query:zp(o,h).ft},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=Zh(o,a.resumeToken);let d=xo(o,a.expectedCount);d!==null&&(l.expectedCount=d)}else if(a.snapshotVersion.compareTo(B.min())>0){l.readTime=ci(o,a.snapshotVersion.toTimestamp());let d=xo(o,a.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);let r=$p(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){let t={};t.database=Ro(this.serializer),t.removeTarget=e,this.q_(t)}},aa=class extends pi{constructor(e,t,r,i,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return H(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,H(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){H(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let t=Up(e.writeResults,e.commitTime),r=Ue(e.commitTime);return this.listener.na(r,t)}ra(){let e={};e.database=Ro(this.serializer),this.q_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>Bp(this.serializer,r))};this.q_(t)}};var ca=class{},ua=class extends ca{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new D(A.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Go(e,So(t,r),i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===A.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new D(A.UNKNOWN,o.toString())})}Ho(e,t,r,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Ho(e,So(t,r),i,a,l,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===A.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new D(A.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}},la=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(We(t),this.aa=!1):V("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}};var Lt="RemoteStore",ha=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo(a=>{r.enqueueAndForget(()=>x(this,null,function*(){Ut(this)&&(V(Lt,"Restarting streams for network reachability change."),yield function(h){return x(this,null,function*(){let d=L(h);d.Ea.add(4),yield fr(d),d.Ra.set("Unknown"),d.Ea.delete(4),yield Fi(d)})}(this))}))}),this.Ra=new la(r,i)}};function Fi(n){return x(this,null,function*(){if(Ut(n))for(let e of n.da)yield e(!0)})}function fr(n){return x(this,null,function*(){for(let e of n.da)yield e(!1)})}function ud(n,e){let t=L(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Wa(t)?Ha(t):En(t).O_()&&Qa(t,e))}function Ka(n,e){let t=L(n),r=En(t);t.Ia.delete(e),r.O_()&&ld(t,e),t.Ia.size===0&&(r.O_()?r.L_():Ut(t)&&t.Ra.set("Unknown"))}function Qa(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(B.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}En(n).Y_(e)}function ld(n,e){n.Va.Ue(e),En(n).Z_(e)}function Ha(n){n.Va=new ko({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),En(n).start(),n.Ra.ua()}function Wa(n){return Ut(n)&&!En(n).x_()&&n.Ia.size>0}function Ut(n){return L(n).Ea.size===0}function hd(n){n.Va=void 0}function ag(n){return x(this,null,function*(){n.Ra.set("Online")})}function cg(n){return x(this,null,function*(){n.Ia.forEach((e,t)=>{Qa(n,e)})})}function ug(n,e){return x(this,null,function*(){hd(n),Wa(n)?(n.Ra.ha(e),Ha(n)):n.Ra.set("Unknown")})}function lg(n,e,t){return x(this,null,function*(){if(n.Ra.set("Online"),e instanceof oi&&e.state===2&&e.cause)try{yield function(i,o){return x(this,null,function*(){let a=o.cause;for(let l of o.targetIds)i.Ia.has(l)&&(yield i.remoteSyncer.rejectListen(l,a),i.Ia.delete(l),i.Va.removeTarget(l))})}(n,e)}catch(r){V(Lt,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield gi(n,r)}else if(e instanceof rn?n.Va.Ze(e):e instanceof si?n.Va.st(e):n.Va.tt(e),!t.isEqual(B.min()))try{let r=yield cd(n.localStore);t.compareTo(r)>=0&&(yield function(o,a){let l=o.Va.Tt(a);return l.targetChanges.forEach((h,d)=>{if(h.resumeToken.approximateByteSize()>0){let m=o.Ia.get(d);m&&o.Ia.set(d,m.withResumeToken(h.resumeToken,a))}}),l.targetMismatches.forEach((h,d)=>{let m=o.Ia.get(h);if(!m)return;o.Ia.set(h,m.withResumeToken(ge.EMPTY_BYTE_STRING,m.snapshotVersion)),ld(o,h);let b=new or(m.target,h,d,m.sequenceNumber);Qa(o,b)}),o.remoteSyncer.applyRemoteEvent(l)}(n,t))}catch(r){V(Lt,"Failed to raise snapshot:",r),yield gi(n,r)}})}function gi(n,e,t){return x(this,null,function*(){if(!In(e))throw e;n.Ea.add(1),yield fr(n),n.Ra.set("Offline"),t||(t=()=>cd(n.localStore)),n.asyncQueue.enqueueRetryable(()=>x(this,null,function*(){V(Lt,"Retrying IndexedDB access"),yield t(),n.Ea.delete(1),yield Fi(n)}))})}function dd(n,e){return e().catch(t=>gi(n,t,e))}function Oi(n){return x(this,null,function*(){let e=L(n),t=pt(e),r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Fa;for(;hg(e);)try{let i=yield rg(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,dg(e,i)}catch(i){yield gi(e,i)}fd(e)&&md(e)})}function hg(n){return Ut(n)&&n.Ta.length<10}function dg(n,e){n.Ta.push(e);let t=pt(n);t.O_()&&t.X_&&t.ea(e.mutations)}function fd(n){return Ut(n)&&!pt(n).x_()&&n.Ta.length>0}function md(n){pt(n).start()}function fg(n){return x(this,null,function*(){pt(n).ra()})}function mg(n){return x(this,null,function*(){let e=pt(n);for(let t of n.Ta)e.ea(t.mutations)})}function pg(n,e,t){return x(this,null,function*(){let r=n.Ta.shift(),i=vo.from(r,e,t);yield dd(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Oi(n)})}function gg(n,e){return x(this,null,function*(){e&&pt(n).X_&&(yield function(r,i){return x(this,null,function*(){if(function(a){return Cp(a)&&a!==A.ABORTED}(i.code)){let o=r.Ta.shift();pt(r).B_(),yield dd(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield Oi(r)}})}(n,e)),fd(n)&&md(n)})}function Wl(n,e){return x(this,null,function*(){let t=L(n);t.asyncQueue.verifyOperationInProgress(),V(Lt,"RemoteStore received new credentials");let r=Ut(t);t.Ea.add(3),yield fr(t),r&&t.Ra.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),yield Fi(t)})}function _g(n,e){return x(this,null,function*(){let t=L(n);e?(t.Ea.delete(2),yield Fi(t)):e||(t.Ea.add(2),yield fr(t),t.Ra.set("Unknown"))})}function En(n){return n.ma||(n.ma=function(t,r,i){let o=L(t);return o.sa(),new oa(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Xo:ag.bind(null,n),t_:cg.bind(null,n),r_:ug.bind(null,n),H_:lg.bind(null,n)}),n.da.push(e=>x(this,null,function*(){e?(n.ma.B_(),Wa(n)?Ha(n):n.Ra.set("Unknown")):(yield n.ma.stop(),hd(n))}))),n.ma}function pt(n){return n.fa||(n.fa=function(t,r,i){let o=L(t);return o.sa(),new aa(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:fg.bind(null,n),r_:gg.bind(null,n),ta:mg.bind(null,n),na:pg.bind(null,n)}),n.da.push(e=>x(this,null,function*(){e?(n.fa.B_(),yield Oi(n)):(yield n.fa.stop(),n.Ta.length>0&&(V(Lt,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}var da=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new Oe,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let a=Date.now()+r,l=new n(e,t,a,i,o);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new D(A.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Ja(n,e){if(We("AsyncQueue",`${e}: ${n}`),In(n))return new D(A.UNAVAILABLE,`${e}: ${n}`);throw n}var _i=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||O.comparator(t.key,r.key):(t,r)=>O.comparator(t.key,r.key),this.keyedMap=Hn(),this.sortedSet=new te(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var yi=class{constructor(){this.ga=new te(O.comparator)}track(e){let t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):M(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){let e=[];return this.ga.inorderTraversal((t,r)=>{e.push(r)}),e}},_n=class n{constructor(e,t,r,i,o,a,l,h,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,o){let a=[];return t.forEach(l=>{a.push({type:0,doc:l})}),new n(e,t,_i.emptySet(t),a,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Di(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var fa=class{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}},ma=class{constructor(){this.queries=Jl(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){let i=L(t),o=i.queries;i.queries=Jl(),o.forEach((a,l)=>{for(let h of l.Sa)h.onError(r)})})(this,new D(A.ABORTED,"Firestore shutting down"))}};function Jl(){return new Ye(n=>Uh(n),Di)}function pd(n,e){return x(this,null,function*(){let t=L(n),r=3,i=e.query,o=t.queries.get(i);o?!o.ba()&&e.Da()&&(r=2):(o=new fa,r=e.Da()?0:1);try{switch(r){case 0:o.wa=yield t.onListen(i,!0);break;case 1:o.wa=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(a){let l=Ja(a,`Initialization of query '${Zt(e.query)}' failed`);return void e.onError(l)}t.queries.set(i,o),o.Sa.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&Xa(t)})}function gd(n,e){return x(this,null,function*(){let t=L(n),r=e.query,i=3,o=t.queries.get(r);if(o){let a=o.Sa.indexOf(e);a>=0&&(o.Sa.splice(a,1),o.Sa.length===0?i=e.Da()?0:1:!o.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function yg(n,e){let t=L(n),r=!1;for(let i of e){let o=i.query,a=t.queries.get(o);if(a){for(let l of a.Sa)l.Fa(i)&&(r=!0);a.wa=i}}r&&Xa(t)}function bg(n,e,t){let r=L(n),i=r.queries.get(e);if(i)for(let o of i.Sa)o.onError(t);r.queries.delete(e)}function Xa(n){n.Ca.forEach(e=>{e.next()})}var pa,Xl;(Xl=pa||(pa={})).Ma="default",Xl.Cache="cache";var bi=class{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new _n(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;let r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;let t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=_n.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==pa.Cache}};var wi=class{constructor(e){this.key=e}},vi=class{constructor(e){this.key=e}},ga=class{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=z(),this.mutatedKeys=z(),this.eu=qh(e),this.tu=new _i(this.eu)}get nu(){return this.Ya}ru(e,t){let r=t?t.iu:new yi,i=t?t.tu:this.tu,o=t?t.mutatedKeys:this.mutatedKeys,a=i,l=!1,h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((m,b)=>{let E=i.get(m),S=Vi(this.query,b)?b:null,N=!!E&&this.mutatedKeys.has(E.key),F=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations),P=!1;E&&S?E.data.isEqual(S.data)?N!==F&&(r.track({type:3,doc:S}),P=!0):this.su(E,S)||(r.track({type:2,doc:S}),P=!0,(h&&this.eu(S,h)>0||d&&this.eu(S,d)<0)&&(l=!0)):!E&&S?(r.track({type:0,doc:S}),P=!0):E&&!S&&(r.track({type:1,doc:E}),P=!0,(h||d)&&(l=!0)),P&&(S?(a=a.add(S),o=F?o.add(m):o.delete(m)):(a=a.delete(m),o=o.delete(m)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let m=this.query.limitType==="F"?a.last():a.first();a=a.delete(m.key),o=o.delete(m.key),r.track({type:1,doc:m})}return{tu:a,iu:r,Cs:l,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let a=e.iu.ya();a.sort((m,b)=>function(S,N){let F=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return M(20277,{Rt:P})}};return F(S)-F(N)}(m.type,b.type)||this.eu(m.doc,b.doc)),this.ou(r),i=i??!1;let l=t&&!i?this._u():[],h=this.Xa.size===0&&this.current&&!i?1:0,d=h!==this.Za;return this.Za=h,a.length!==0||d?{snapshot:new _n(this.query,e.tu,o,a,e.mutatedKeys,h===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new yi,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Xa;this.Xa=z(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});let t=[];return e.forEach(r=>{this.Xa.has(r)||t.push(new vi(r))}),this.Xa.forEach(r=>{e.has(r)||t.push(new wi(r))}),t}cu(e){this.Ya=e.Qs,this.Xa=z();let t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return _n.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}},Ya="SyncEngine",_a=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},ya=class{constructor(e){this.key=e,this.hu=!1}},ba=class{constructor(e,t,r,i,o,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Ye(l=>Uh(l),Di),this.Iu=new Map,this.Eu=new Set,this.du=new te(O.comparator),this.Au=new Map,this.Ru=new cr,this.Vu={},this.mu=new Map,this.fu=ar.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}};function wg(n,e,t=!0){return x(this,null,function*(){let r=Id(n),i,o=r.Tu.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=yield _d(r,e,t,!0),i})}function vg(n,e){return x(this,null,function*(){let t=Id(n);yield _d(t,e,!0,!1)})}function _d(n,e,t,r){return x(this,null,function*(){let i=yield ig(n.localStore,Be(e)),o=i.targetId,a=n.sharedClientState.addLocalQueryTarget(o,t),l;return r&&(l=yield Ig(n,e,o,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&ud(n.remoteStore,i),l})}function Ig(n,e,t,r,i){return x(this,null,function*(){n.pu=(b,E,S)=>function(F,P,G,K){return x(this,null,function*(){let Q=P.view.ru(G);Q.Cs&&(Q=yield Kl(F.localStore,P.query,!1).then(({documents:w})=>P.view.ru(w,Q)));let _e=K&&K.targetChanges.get(P.targetId),we=K&&K.targetMismatches.get(P.targetId)!=null,ce=P.view.applyChanges(Q,F.isPrimaryClient,_e,we);return Zl(F,P.targetId,ce.au),ce.snapshot})}(n,b,E,S);let o=yield Kl(n.localStore,e,!0),a=new ga(e,o.Qs),l=a.ru(o.documents),h=sr.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=a.applyChanges(l,n.isPrimaryClient,h);Zl(n,t,d.au);let m=new _a(e,t,a);return n.Tu.set(e,m),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),d.snapshot})}function Eg(n,e,t){return x(this,null,function*(){let r=L(n),i=r.Tu.get(e),o=r.Iu.get(i.targetId);if(o.length>1)return r.Iu.set(i.targetId,o.filter(a=>!Di(a,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Zo(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Ka(r.remoteStore,i.targetId),wa(r,i.targetId)}).catch(vn))):(wa(r,i.targetId),yield Zo(r.localStore,i.targetId,!0))})}function Tg(n,e){return x(this,null,function*(){let t=L(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Ka(t.remoteStore,r.targetId))})}function kg(n,e,t){return x(this,null,function*(){let r=Dg(n);try{let i=yield function(a,l){let h=L(a),d=oe.now(),m=l.reduce((S,N)=>S.add(N.key),z()),b,E;return h.persistence.runTransaction("Locally write mutations","readwrite",S=>{let N=Ze(),F=z();return h.Ns.getEntries(S,m).next(P=>{N=P,N.forEach((G,K)=>{K.isValidDocument()||(F=F.add(G))})}).next(()=>h.localDocuments.getOverlayedDocuments(S,N)).next(P=>{b=P;let G=[];for(let K of l){let Q=Sp(K,b.get(K.key).overlayedDocument);Q!=null&&G.push(new ze(K.key,Q,Vh(Q.value.mapValue),He.exists(!0)))}return h.mutationQueue.addMutationBatch(S,d,G,l)}).next(P=>{E=P;let G=P.applyToLocalDocumentSet(b,F);return h.documentOverlayCache.saveOverlays(S,P.batchId,G)})}).then(()=>({batchId:E.batchId,changes:jh(b)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,l,h){let d=a.Vu[a.currentUser.toKey()];d||(d=new te(q)),d=d.insert(l,h),a.Vu[a.currentUser.toKey()]=d}(r,i.batchId,t),yield mr(r,i.changes),yield Oi(r.remoteStore)}catch(i){let o=Ja(i,"Failed to persist write");t.reject(o)}})}function yd(n,e){return x(this,null,function*(){let t=L(n);try{let r=yield tg(t.localStore,e);e.targetChanges.forEach((i,o)=>{let a=t.Au.get(o);a&&(H(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?H(a.hu,14607):i.removedDocuments.size>0&&(H(a.hu,42227),a.hu=!1))}),yield mr(t,r,e)}catch(r){yield vn(r)}})}function Yl(n,e,t){let r=L(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Tu.forEach((o,a)=>{let l=a.view.va(e);l.snapshot&&i.push(l.snapshot)}),function(a,l){let h=L(a);h.onlineState=l;let d=!1;h.queries.forEach((m,b)=>{for(let E of b.Sa)E.va(l)&&(d=!0)}),d&&Xa(h)}(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Ag(n,e,t){return x(this,null,function*(){let r=L(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Au.get(e),o=i&&i.key;if(o){let a=new te(O.comparator);a=a.insert(o,Ce.newNoDocument(o,B.min()));let l=z().add(o),h=new ii(B.min(),new Map,new te(q),a,l);yield yd(r,h),r.du=r.du.remove(o),r.Au.delete(e),Za(r)}else yield Zo(r.localStore,e,!1).then(()=>wa(r,e,t)).catch(vn)})}function xg(n,e){return x(this,null,function*(){let t=L(n),r=e.batch.batchId;try{let i=yield eg(t.localStore,e);wd(t,r,null),bd(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield mr(t,i)}catch(i){yield vn(i)}})}function Sg(n,e,t){return x(this,null,function*(){let r=L(n);try{let i=yield function(a,l){let h=L(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let m;return h.mutationQueue.lookupMutationBatch(d,l).next(b=>(H(b!==null,37113),m=b.keys(),h.mutationQueue.removeMutationBatch(d,b))).next(()=>h.mutationQueue.performConsistencyCheck(d)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(d,m,l)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,m)).next(()=>h.localDocuments.getDocuments(d,m))})}(r.localStore,e);wd(r,e,t),bd(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield mr(r,i)}catch(i){yield vn(i)}})}function bd(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function wd(n,e,t){let r=L(n),i=r.Vu[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function wa(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach(r=>{n.Ru.containsKey(r)||vd(n,r)})}function vd(n,e){n.Eu.delete(e.path.canonicalString());let t=n.du.get(e);t!==null&&(Ka(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Za(n))}function Zl(n,e,t){for(let r of t)r instanceof wi?(n.Ru.addReference(r.key,e),Cg(n,r)):r instanceof vi?(V(Ya,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||vd(n,r.key)):M(19791,{wu:r})}function Cg(n,e){let t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(V(Ya,"New document in limbo: "+t),n.Eu.add(r),Za(n))}function Za(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){let e=n.Eu.values().next().value;n.Eu.delete(e);let t=new O(Z.fromString(e)),r=n.fu.next();n.Au.set(r,new ya(t)),n.du=n.du.insert(t,r),ud(n.remoteStore,new or(Be(za(t.path)),r,"TargetPurposeLimboResolution",Na.ce))}}function mr(n,e,t){return x(this,null,function*(){let r=L(n),i=[],o=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach((l,h)=>{a.push(r.pu(h,e,t).then(d=>{if((d||t)&&r.isPrimaryClient){let m=d?!d.fromCache:t?.targetChanges.get(h.targetId)?.current;r.sharedClientState.updateQueryState(h.targetId,m?"current":"not-current")}if(d){i.push(d);let m=Wo.As(h.targetId,d);o.push(m)}}))}),yield Promise.all(a),r.Pu.H_(i),yield function(h,d){return x(this,null,function*(){let m=L(h);try{yield m.persistence.runTransaction("notifyLocalViewChanges","readwrite",b=>C.forEach(d,E=>C.forEach(E.Es,S=>m.persistence.referenceDelegate.addReference(b,E.targetId,S)).next(()=>C.forEach(E.ds,S=>m.persistence.referenceDelegate.removeReference(b,E.targetId,S)))))}catch(b){if(!In(b))throw b;V(Ga,"Failed to update sequence numbers: "+b)}for(let b of d){let E=b.targetId;if(!b.fromCache){let S=m.Ms.get(E),N=S.snapshotVersion,F=S.withLastLimboFreeSnapshotVersion(N);m.Ms=m.Ms.insert(E,F)}}})}(r.localStore,o))})}function Rg(n,e){return x(this,null,function*(){let t=L(n);if(!t.currentUser.isEqual(e)){V(Ya,"User change. New user:",e.toKey());let r=yield ad(t.localStore,e);t.currentUser=e,function(o,a){o.mu.forEach(l=>{l.forEach(h=>{h.reject(new D(A.CANCELLED,a))})}),o.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield mr(t,r.Ls)}})}function Pg(n,e){let t=L(n),r=t.Au.get(e);if(r&&r.hu)return z().add(r.key);{let i=z(),o=t.Iu.get(e);if(!o)return i;for(let a of o){let l=t.Tu.get(a);i=i.unionWith(l.view.nu)}return i}}function Id(n){let e=L(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=yd.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Pg.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Ag.bind(null,e),e.Pu.H_=yg.bind(null,e.eventManager),e.Pu.yu=bg.bind(null,e.eventManager),e}function Dg(n){let e=L(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=xg.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Sg.bind(null,e),e}var Ed=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return x(this,null,function*(){this.serializer=Ni(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),yield this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)})}Fu(t,r){return null}Mu(t,r){return null}vu(t){return Zp(this.persistence,new Xo,t.initialUser,this.serializer)}Cu(t){return new li(Ho.mi,this.serializer)}Du(t){return new ea}terminate(){return x(this,null,function*(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})(),va=class extends Ed{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){H(this.persistence.referenceDelegate instanceof hi,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new Fo(r,e.asyncQueue,t)}Cu(e){let t=this.cacheSizeBytes!==void 0?Ae.withCacheSize(this.cacheSizeBytes):Ae.DEFAULT;return new li(r=>hi.mi(r,t),this.serializer)}};var Vg=(()=>{class n{initialize(t,r){return x(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Yl(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=Rg.bind(null,this.syncEngine),yield _g(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new ma}()}createDatastore(t){let r=Ni(t.databaseInfo.databaseId),i=function(a){return new sa(a)}(t.databaseInfo);return function(a,l,h,d){return new ua(a,l,h,d)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,o,a,l,h){return new ha(i,o,a,l,h)}(this.localStore,this.datastore,t.asyncQueue,r=>Yl(this.syncEngine,r,0),function(){return fi.v()?new fi:new ta}())}createSyncEngine(t,r){return function(o,a,l,h,d,m,b){let E=new ba(o,a,l,h,d,m);return b&&(E.gu=!0),E}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return x(this,null,function*(){yield function(r){return x(this,null,function*(){let i=L(r);V(Lt,"RemoteStore shutting down."),i.Ea.add(5),yield fr(i),i.Aa.shutdown(),i.Ra.set("Unknown")})}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()})}}return n.provider={build:()=>new n},n})();var Ii=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):We("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var gt="FirestoreClient",Ia=class{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=le.UNAUTHENTICATED,this.clientId=Zn.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,a=>x(this,null,function*(){V(gt,"Received user=",a.uid),yield this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,a=>(V(gt,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Oe;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>x(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Ja(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Ks(n,e){return x(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),V(gt,"Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>x(this,null,function*(){r.isEqual(i)||(yield ad(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function eh(n,e){return x(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield Ng(n);V(gt,"Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Wl(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Wl(e.remoteStore,i)),n._onlineComponents=e})}function Ng(n){return x(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){V(gt,"Using user provided OfflineComponentProvider");try{yield Ks(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===A.FAILED_PRECONDITION||i.code===A.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;on("Error using user provided cache. Falling back to memory cache: "+t),yield Ks(n,new Ed)}}else V(gt,"Using default OfflineComponentProvider"),yield Ks(n,new va(void 0));return n._offlineComponents})}function Td(n){return x(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(V(gt,"Using user provided OnlineComponentProvider"),yield eh(n,n._uninitializedComponentsProvider._online)):(V(gt,"Using default OnlineComponentProvider"),yield eh(n,new Vg))),n._onlineComponents})}function Fg(n){return Td(n).then(e=>e.syncEngine)}function Ea(n){return x(this,null,function*(){let e=yield Td(n),t=e.eventManager;return t.onListen=wg.bind(null,e.syncEngine),t.onUnlisten=Eg.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=vg.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Tg.bind(null,e.syncEngine),t})}function Og(n,e,t={}){let r=new Oe;return n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(o,a,l,h,d){let m=new Ii({next:E=>{m.Nu(),a.enqueueAndForget(()=>gd(o,b)),E.fromCache&&h.source==="server"?d.reject(new D(A.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(E)},error:E=>d.reject(E)}),b=new bi(l,m,{includeMetadataChanges:!0,qa:!0});return pd(o,b)}(yield Ea(n),n.asyncQueue,e,t,r)})),r.promise}function kd(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var th=new Map;var Ad="firestore.googleapis.com",nh=!0,Ei=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new D(A.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Ad,this.ssl=nh}else this.host=e.host,this.ssl=e.ssl??nh;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=od;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Jp)throw new D(A.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Km("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=kd(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new D(A.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new D(A.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new D(A.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},yn=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ei({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new D(A.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new D(A.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ei(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Qs;switch(r.type){case"firstParty":return new Xs(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new D(A.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return x(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=th.get(t);r&&(V("ComponentProvider","Removing Datastore"),th.delete(t),r.terminate())}(this),Promise.resolve()}};function Mg(n,e,t,r={}){n=Me(n,yn);let i=Lr(e),o=n._getSettings(),a=Ve(X({},o),{emulatorOptions:n._getEmulatorOptions()}),l=`${e}:${t}`;i&&(Gu(`https://${l}`),Qu("Firestore",!0)),o.host!==Ad&&o.host!==l&&on("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let h=Ve(X({},o),{host:l,ssl:i,emulatorOptions:r});if(!Wt(h,a)&&(n._setSettings(h),r.mockUserToken)){let d,m;if(typeof r.mockUserToken=="string")d=r.mockUserToken,m=le.MOCK_USER;else{d=Ku(r.mockUserToken,n._app?.options.projectId);let b=r.mockUserToken.sub||r.mockUserToken.user_id;if(!b)throw new D(A.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new le(b)}n._authCredentials=new Hs(new Jr(d,m))}}var Bt=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},de=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new lt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(dr(t,n._jsonSchema))return new n(e,r||null,new O(Z.fromString(t.referencePath)))}};de._jsonSchemaVersion="firestore/documentReference/1.0",de._jsonSchema={type:se("string",de._jsonSchemaVersion),referencePath:se("string")};var lt=class n extends Bt{constructor(e,t,r){super(e,t,za(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new de(this.firestore,null,new O(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Mi(n,e,...t){if(n=Se(n),uh("collection","path",e),n instanceof yn){let r=Z.fromString(e,...t);return vl(r),new lt(n,null,r)}{if(!(n instanceof de||n instanceof lt))throw new D(A.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Z.fromString(e,...t));return vl(r),new lt(n.firestore,null,r)}}function Li(n,e,...t){if(n=Se(n),arguments.length===1&&(e=Zn.newId()),uh("doc","path",e),n instanceof yn){let r=Z.fromString(e,...t);return wl(r),new de(n,null,new O(r))}{if(!(n instanceof de||n instanceof lt))throw new D(A.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Z.fromString(e,...t));return wl(r),new de(n.firestore,n instanceof lt?n.converter:null,new O(r))}}var rh="AsyncQueue",Ti=class{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new mi(this,"async_queue_retry"),this._c=()=>{let r=Gs();r&&V(rh,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;let t=Gs();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=Gs();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});let t=new Oe;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}lc(){return x(this,null,function*(){if(this.Xu.length!==0){try{yield this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!In(e))throw e;V(rh,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}})}cc(e){let t=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,We("INTERNAL UNHANDLED ERROR: ",ih(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let i=da.createAndSchedule(this,e,t,r,o=>this.hc(o));return this.tc.push(i),i}uc(){this.nc&&M(47125,{Pc:ih(this.nc)})}verifyOperationInProgress(){}Tc(){return x(this,null,function*(){let e;do e=this.ac,yield e;while(e!==this.ac)})}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}};function ih(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function sh(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(n,["next","error","complete"])}var et=class extends yn{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Ti,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return x(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Ti(e),this._firestoreClient=void 0,yield e}})}};function xd(n,e){let t=typeof n=="object"?n:dl(),r=typeof n=="string"?n:e||ti,i=ul(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let o=$u("firestore");o&&Mg(i,...o)}return i}function ec(n){if(n._terminated)throw new D(A.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Lg(n),n._firestoreClient}function Lg(n){let e=n._freezeSettings(),t=function(i,o,a,l){return new no(i,o,a,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,kd(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)}(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new Ia(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&function(i){let o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}}(n._componentsProvider))}var ht=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(ge.fromBase64String(e))}catch(t){throw new D(A.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(ge.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(dr(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};ht._jsonSchemaVersion="firestore/bytes/1.0",ht._jsonSchema={type:se("string",ht._jsonSchemaVersion),bytes:se("string")};var bn=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new D(A.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Te(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var ur=class{constructor(e){this._methodName=e}};var dt=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new D(A.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new D(A.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return q(this._lat,e._lat)||q(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(dr(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};dt._jsonSchemaVersion="firestore/geoPoint/1.0",dt._jsonSchema={type:se("string",dt._jsonSchemaVersion),latitude:se("number"),longitude:se("number")};var ft=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(dr(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new D(A.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};ft._jsonSchemaVersion="firestore/vectorValue/1.0",ft._jsonSchema={type:se("string",ft._jsonSchemaVersion),vectorValues:se("object")};var Bg=/^__.*__$/,Ta=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new ze(e,this.data,this.fieldMask,t,this.fieldTransforms):new Mt(e,this.data,t,this.fieldTransforms)}},ki=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new ze(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function Sd(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw M(40011,{Ac:n})}}var ka=class n{constructor(e,t,r,i,o,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new n(X(X({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){let t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){let t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return xi(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Sd(this.Ac)&&Bg.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}},Aa=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Ni(e)}Cc(e,t,r,i=!1){return new ka({Ac:e,methodName:t,Dc:r,path:Te.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function tc(n){let e=n._freezeSettings(),t=Ni(n._databaseId);return new Aa(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Ug(n,e,t,r,i,o={}){let a=n.Cc(o.merge||o.mergeFields?2:0,e,t,i);nc("Data must be an object, but it was:",a,r);let l=Cd(r,a),h,d;if(o.merge)h=new xe(a.fieldMask),d=a.fieldTransforms;else if(o.mergeFields){let m=[];for(let b of o.mergeFields){let E=xa(e,b,t);if(!a.contains(E))throw new D(A.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);Pd(m,E)||m.push(E)}h=new xe(m),d=a.fieldTransforms.filter(b=>h.covers(b.field))}else h=null,d=a.fieldTransforms;return new Ta(new Ee(l),h,d)}var Ai=class n extends ur{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function qg(n,e,t,r){let i=n.Cc(1,e,t);nc("Data must be an object, but it was:",i,r);let o=[],a=Ee.empty();_t(r,(h,d)=>{let m=rc(e,h,t);d=Se(d);let b=i.yc(m);if(d instanceof Ai)o.push(m);else{let E=pr(d,b);E!=null&&(o.push(m),a.set(m,E))}});let l=new xe(o);return new ki(a,l,i.fieldTransforms)}function zg(n,e,t,r,i,o){let a=n.Cc(1,e,t),l=[xa(e,r,t)],h=[i];if(o.length%2!=0)throw new D(A.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<o.length;E+=2)l.push(xa(e,o[E])),h.push(o[E+1]);let d=[],m=Ee.empty();for(let E=l.length-1;E>=0;--E)if(!Pd(d,l[E])){let S=l[E],N=h[E];N=Se(N);let F=a.yc(S);if(N instanceof Ai)d.push(S);else{let P=pr(N,F);P!=null&&(d.push(S),m.set(S,P))}}let b=new xe(d);return new ki(m,b,a.fieldTransforms)}function jg(n,e,t,r=!1){return pr(t,n.Cc(r?4:3,e))}function pr(n,e){if(Rd(n=Se(n)))return nc("Unsupported field value:",e,n),Cd(n,e);if(n instanceof ur)return function(r,i){if(!Sd(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,i){let o=[],a=0;for(let l of r){let h=pr(l,i.wc(a));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),a++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=Se(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Ep(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=oe.fromDate(r);return{timestampValue:ci(i.serializer,o)}}if(r instanceof oe){let o=new oe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ci(i.serializer,o)}}if(r instanceof dt)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ht)return{bytesValue:Zh(i.serializer,r._byteString)};if(r instanceof de){let o=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(o))throw i.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:$a(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof ft)return function(a,l){return{mapValue:{fields:{[Ma]:{stringValue:La},[cn]:{arrayValue:{values:a.toArray().map(d=>{if(typeof d!="number")throw l.Sc("VectorValues must only contain numeric values.");return ja(l.serializer,d)})}}}}}}(r,i);throw i.Sc(`Unsupported field value: ${Ci(r)}`)}(n,e)}function Cd(n,e){let t={};return kh(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):_t(n,(r,i)=>{let o=pr(i,e.mc(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function Rd(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof oe||n instanceof dt||n instanceof ht||n instanceof de||n instanceof ur||n instanceof ft)}function nc(n,e,t){if(!Rd(t)||!lh(t)){let r=Ci(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function xa(n,e,t){if((e=Se(e))instanceof bn)return e._internalPath;if(typeof e=="string")return rc(n,e);throw xi("Field path arguments must be of type string or ",n,!1,void 0,t)}var $g=new RegExp("[~\\*/\\[\\]]");function rc(n,e,t){if(e.search($g)>=0)throw xi(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new bn(...e.split("."))._internalPath}catch{throw xi(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function xi(n,e,t,r,i){let o=r&&!r.isEmpty(),a=i!==void 0,l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let h="";return(o||a)&&(h+=" (found",o&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new D(A.INVALID_ARGUMENT,l+n+h)}function Pd(n,e){return n.some(t=>t.isEqual(e))}var Si=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new de(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Sa(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Dd("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Sa=class extends Si{data(){return super.data()}};function Dd(n,e){return typeof e=="string"?rc(n,e):e instanceof bn?e._internalPath:e._delegate._internalPath}function Vd(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new D(A.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var lr=class{},Ca=class extends lr{};function Nd(n,e,...t){let r=[];e instanceof lr&&r.push(e),r=r.concat(t),function(o){let a=o.filter(h=>h instanceof Pa).length,l=o.filter(h=>h instanceof Ra).length;if(a>1||a>0&&l>0)throw new D(A.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Ra=class n extends Ca{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return Fd(e._query,t),new Bt(e.firestore,e.converter,go(e._query,t))}_parse(e){let t=tc(e.firestore);return function(o,a,l,h,d,m,b){let E;if(d.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new D(A.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){ah(b,m);let N=[];for(let F of b)N.push(oh(h,o,F));E={arrayValue:{values:N}}}else E=oh(h,o,b)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||ah(b,m),E=jg(l,a,b,m==="in"||m==="not-in");return ie.create(d,m,E)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};var Pa=class n extends lr{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Re.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,o){let a=i,l=o.getFlattenedFilters();for(let h of l)Fd(a,h),a=go(a,h)}(e._query,t),new Bt(e.firestore,e.converter,go(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};function oh(n,e,t){if(typeof(t=Se(t))=="string"){if(t==="")throw new D(A.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Bh(e)&&t.indexOf("/")!==-1)throw new D(A.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(Z.fromString(t));if(!O.isDocumentKey(r))throw new D(A.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Sl(n,new O(r))}if(t instanceof de)return Sl(n,t._key);throw new D(A.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ci(t)}.`)}function ah(n,e){if(!Array.isArray(n)||n.length===0)throw new D(A.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Fd(n,e){let t=function(i,o){for(let a of i)for(let l of a.getFlattenedFilters())if(o.indexOf(l.op)>=0)return l.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new D(A.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new D(A.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Da=class{convertValue(e,t="none"){switch(mt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Y(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Xe(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw M(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return _t(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){let t=e.fields?.[cn].arrayValue?.values?.map(r=>Y(r.doubleValue));return new ft(t)}convertGeoPoint(e){return new dt(Y(e.latitude),Y(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Pi(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(nr(e));default:return null}}convertTimestamp(e){let t=Je(e);return new oe(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=Z.fromString(e);H(sd(r),9688,{name:e});let i=new ni(r.get(1),r.get(3)),o=new O(r.popFirst(5));return i.isEqual(t)||We(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function Gg(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Ct=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Rt=class n extends Si{constructor(e,t,r,i,o,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new sn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Dd("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new D(A.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Rt._jsonSchemaVersion="firestore/documentSnapshot/1.0",Rt._jsonSchema={type:se("string",Rt._jsonSchemaVersion),bundleSource:se("string","DocumentSnapshot"),bundleName:se("string"),bundle:se("string")};var sn=class extends Rt{data(e={}){return super.data(e)}},Pt=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Ct(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new sn(this._firestore,this._userDataWriter,r.key,r,new Ct(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new D(A.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(l=>{let h=new sn(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Ct(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>o||l.type!==3).map(l=>{let h=new sn(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Ct(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,m=-1;return l.type!==0&&(d=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),m=a.indexOf(l.doc.key)),{type:Kg(l.type),doc:h,oldIndex:d,newIndex:m}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new D(A.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Zn.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(t.push(o._document),r.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function Kg(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return M(61501,{type:n})}}Pt._jsonSchemaVersion="firestore/querySnapshot/1.0",Pt._jsonSchema={type:se("string",Pt._jsonSchemaVersion),bundleSource:se("string","QuerySnapshot"),bundleName:se("string"),bundle:se("string")};var hr=class extends Da{constructor(e){super(),this.firestore=e}convertBytes(e){return new ht(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new de(this.firestore,null,t)}};function Od(n){n=Me(n,Bt);let e=Me(n.firestore,et),t=ec(e),r=new hr(e);return Vd(n._query),Og(t,n._query).then(i=>new Pt(e,r,n,i))}function Md(n,e,t,...r){n=Me(n,de);let i=Me(n.firestore,et),o=tc(i),a;return a=typeof(e=Se(e))=="string"||e instanceof bn?zg(o,"updateDoc",n._key,e,t,r):qg(o,"updateDoc",n._key,e),ic(i,[a.toMutation(n._key,He.exists(!0))])}function Ld(n){return ic(Me(n.firestore,et),[new ir(n._key,He.none())])}function Bd(n,e){let t=Me(n.firestore,et),r=Li(n),i=Gg(n.converter,e);return ic(t,[Ug(tc(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,He.exists(!1))]).then(()=>r)}function Ud(n,...e){n=Se(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||sh(e[r])||(t=e[r++]);let i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(sh(e[r])){let h=e[r];e[r]=h.next?.bind(h),e[r+1]=h.error?.bind(h),e[r+2]=h.complete?.bind(h)}let o,a,l;if(n instanceof de)a=Me(n.firestore,et),l=za(n._key.path),o={next:h=>{e[r]&&e[r](Qg(a,n,h))},error:e[r+1],complete:e[r+2]};else{let h=Me(n,Bt);a=Me(h.firestore,et),l=h._query;let d=new hr(a);o={next:m=>{e[r]&&e[r](new Pt(a,d,h,m))},error:e[r+1],complete:e[r+2]},Vd(n._query)}return function(d,m,b,E){let S=new Ii(E),N=new bi(m,S,b);return d.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return pd(yield Ea(d),N)})),()=>{S.Nu(),d.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return gd(yield Ea(d),N)}))}}(ec(a),l,i,o)}function ic(n,e){return function(r,i){let o=new Oe;return r.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return kg(yield Fg(r),i,o)})),o.promise}(ec(n),e)}function Qg(n,e,t){let r=t.docs.get(e._key),i=new hr(n);return new Rt(n,i,e._key,r,new Ct(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){wn=i})(hl),Gn(new $e("firestore",(r,{instanceIdentifier:i,options:o})=>{let a=r.getProvider("app").getImmediate(),l=new et(new Ws(r.getProvider("auth-internal")),new Ys(a,r.getProvider("app-check-internal")),function(d,m){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new D(A.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ni(d.options.projectId,m)}(a,i),a);return o=X({useFetchStreams:t},o),l._setSettings(o),l},"PUBLIC").setMultipleInstances(!0)),ut(_l,yl,e),ut(_l,yl,"esm2020")})();var qd=(()=>{class n{constructor(){this.app=null,this.db=null,this.isInitialized=Et(!1),this.error=Et(null),ke.firebase&&this.hasValidFirebaseConfig()&&this.initialize()}hasValidFirebaseConfig(){return ke.firebase.apiKey!=="YOUR_FIREBASE_API_KEY"&&ke.firebase.projectId!=="YOUR_PROJECT_ID"}initialize(){try{this.app=Fs(ke.firebase),this.db=xd(this.app),this.isInitialized.set(!0),this.error.set(null)}catch(t){this.error.set(`Failed to initialize Firebase: ${t.message}`),console.error("Firebase initialization error:",t)}}getCollection(t){return x(this,null,function*(){if(!this.db)throw new Error("Firestore not initialized");try{let r=yield Od(Mi(this.db,t)),i=[];return r.forEach(o=>{i.push(X({id:o.id},o.data()))}),i}catch(r){return this.error.set(`Error getting collection: ${r.message}`),console.error("Firestore get error:",r),[]}})}subscribeToCollection(t,r){if(!this.db)return console.warn("Firestore not initialized"),null;try{let i=Nd(Mi(this.db,t));return Ud(i,o=>{let a=[];o.forEach(l=>{a.push(X({id:l.id},l.data()))}),r(a)},o=>{this.error.set(`Error subscribing to collection: ${o.message}`),console.error("Firestore subscription error:",o)})}catch(i){return this.error.set(`Error setting up subscription: ${i.message}`),console.error("Firestore subscription setup error:",i),null}}addDocument(t,r){return x(this,null,function*(){if(!this.db)throw new Error("Firestore not initialized");try{return(yield Bd(Mi(this.db,t),Ve(X({},r),{createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}))).id}catch(i){return this.error.set(`Error adding document: ${i.message}`),console.error("Firestore add error:",i),null}})}updateDocument(t,r,i){return x(this,null,function*(){if(!this.db)throw new Error("Firestore not initialized");try{let o=Li(this.db,t,r);return yield Md(o,Ve(X({},i),{updatedAt:new Date().toISOString()})),!0}catch(o){return this.error.set(`Error updating document: ${o.message}`),console.error("Firestore update error:",o),!1}})}deleteDocument(t,r){return x(this,null,function*(){if(!this.db)throw new Error("Firestore not initialized");try{let i=Li(this.db,t,r);return yield Ld(i),!0}catch(i){return this.error.set(`Error deleting document: ${i.message}`),console.error("Firestore delete error:",i),!1}})}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=$t({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var vy=(()=>{class n{constructor(t,r){this.localStorageService=t,this.firestoreService=r,this.STORAGE_KEY="grocery-items",this.COLLECTION_NAME="groceryItems",this.firestoreSubscription=null,this.items=Et([]),this.isLoading=Et(!1),this.useFirestore=Et(ke.useFirestore),this.loadItems()}ngOnDestroy(){this.firestoreSubscription&&this.firestoreSubscription()}loadItems(){return x(this,null,function*(){this.isLoading.set(!0);try{if(this.useFirestore()&&this.firestoreService.isInitialized())this.subscribeToFirestore();else{let t=this.localStorageService.getItem(this.STORAGE_KEY)||[];this.items.set(t)}}catch(t){console.error("Error loading items:",t)}finally{this.isLoading.set(!1)}})}subscribeToFirestore(){this.firestoreSubscription=this.firestoreService.subscribeToCollection(this.COLLECTION_NAME,t=>{this.items.set(t)})}addItem(t){return x(this,null,function*(){if(!t.trim())return;let r=t.trim(),i=this.items(),o=i.filter(l=>l.name.toLowerCase()===r.toLowerCase());if(o.length>0)if(this.useFirestore()&&this.firestoreService.isInitialized())for(let l of o)yield this.firestoreService.deleteDocument(this.COLLECTION_NAME,l.id);else{let l=i.filter(h=>h.name.toLowerCase()!==r.toLowerCase());this.items.set(l),this.saveToLocalStorage(l)}let a={id:Date.now().toString(),name:r,completed:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};if(this.useFirestore()&&this.firestoreService.isInitialized()){let l=yield this.firestoreService.addDocument(this.COLLECTION_NAME,a);l&&(a.id=l)}else{let l=this.items(),h=[a,...l];this.items.set(h),this.saveToLocalStorage(h)}})}updateItem(t,r){return x(this,null,function*(){if(this.useFirestore()&&this.firestoreService.isInitialized())yield this.firestoreService.updateDocument(this.COLLECTION_NAME,t,r);else{let o=this.items().map(a=>a.id===t?Ve(X(X({},a),r),{updatedAt:new Date().toISOString()}):a);this.items.set(o),this.saveToLocalStorage(o)}})}toggleItem(t){return x(this,null,function*(){let i=this.items().find(o=>o.id===t);i&&(yield this.updateItem(t,{completed:!i.completed}))})}deleteItem(t){return x(this,null,function*(){if(this.useFirestore()&&this.firestoreService.isInitialized())yield this.firestoreService.deleteDocument(this.COLLECTION_NAME,t);else{let i=this.items().filter(o=>o.id!==t);this.items.set(i),this.saveToLocalStorage(i)}})}clearCompleted(){return x(this,null,function*(){let t=this.items().filter(r=>r.completed);for(let r of t)yield this.deleteItem(r.id)})}migrateToFirestore(){return x(this,null,function*(){if(!this.firestoreService.isInitialized()){console.error("Firestore not initialized");return}let t=this.localStorageService.getItem(this.STORAGE_KEY)||[];if(t.length===0){console.log("No items to migrate");return}console.log(`Migrating ${t.length} items to Firestore...`);for(let r of t)yield this.firestoreService.addDocument(this.COLLECTION_NAME,r);this.localStorageService.removeItem(this.STORAGE_KEY),this.useFirestore.set(!0),this.subscribeToFirestore(),console.log("Migration complete!")})}saveToLocalStorage(t){this.localStorageService.setItem(this.STORAGE_KEY,t)}getActiveItems(){return this.items().filter(t=>!t.completed)}getCompletedItems(){return this.items().filter(t=>t.completed)}static{this.\u0275fac=function(r){return new(r||n)(us(Vu),us(qd))}}static{this.\u0275prov=$t({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var ky=(()=>{class n{constructor(){this.API_URL="https://models.inference.ai.azure.com/chat/completions"}isConfigured(){return!!ke.githubToken&&ke.githubToken!=="YOUR_GITHUB_PAT"&&ke.githubToken.startsWith("github_pat_")}suggestRecipes(t,r){return x(this,null,function*(){let i=`${r?r+`

`:""}Generate 3 recipe suggestions based on: ${t}

Please respond with a JSON array of recipes in this exact format:
[
  {
    "name": "Recipe Name",
    "description": "Brief description",
    "prepTime": 15,
    "cookTime": 30,
    "servings": 4,
    "ingredients": ["ingredient 1", "ingredient 2"],
    "instructions": ["step 1", "step 2"],
    "tags": ["tag1", "tag2"]
  }
]

Only return valid JSON, no additional text.`,o=yield this.generateContent(i);if(!o.success)throw new Error(o.error||"Failed to generate recipe suggestions");try{let a=o.text.match(/\[[\s\S]*\]/);if(!a)throw new Error("No valid JSON found in response");return JSON.parse(a[0])}catch(a){throw console.error("Error parsing recipe suggestions:",a),new Error("Failed to parse recipe suggestions")}})}suggestGroceries(t,r){return x(this,null,function*(){let i=r?.length?`

Existing items (don't duplicate): ${r.join(", ")}`:"",o=`Based on these planned recipes: ${t.join(", ")}${i}

Generate a comprehensive grocery list. Return only a JSON array of strings, no additional text:
["item 1", "item 2", "item 3"]`,a=yield this.generateContent(o);if(!a.success)throw new Error(a.error||"Failed to generate grocery suggestions");try{let l=a.text.match(/\[[\s\S]*\]/);if(!l)throw new Error("No valid JSON found in response");return JSON.parse(l[0])}catch(l){throw console.error("Error parsing grocery suggestions:",l),new Error("Failed to parse grocery suggestions")}})}suggestMealPlan(t,r=7){return x(this,null,function*(){let i=`Create a ${r}-day meal plan based on: ${t}

Return only a JSON array in this format, no additional text:
[
  {
    "day": "Monday",
    "breakfast": "meal name",
    "lunch": "meal name",
    "dinner": "meal name",
    "snacks": ["snack 1", "snack 2"]
  }
]`,o=yield this.generateContent(i);if(!o.success)throw new Error(o.error||"Failed to generate meal plan");try{let a=o.text.match(/\[[\s\S]*\]/);if(!a)throw new Error("No valid JSON found in response");return JSON.parse(a[0])}catch(a){throw console.error("Error parsing meal plan:",a),new Error("Failed to parse meal plan")}})}suggestRestaurants(t,r){return x(this,null,function*(){let i=`Suggest 3-5 ${t} restaurants or food delivery options. ${r?`Preferences: ${r}`:""}
    
Provide brief descriptions and what makes each one special. Format as a simple text list.`,o=yield this.generateContent(i);if(!o.success)throw new Error(o.error||"Failed to generate restaurant suggestions");return o.text})}generateContent(t){return x(this,null,function*(){if(!this.isConfigured())return{success:!1,text:"",error:"GitHub Personal Access Token not configured. Please add your token to the environment file."};try{let r=yield fetch(this.API_URL,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ke.githubToken}`},body:JSON.stringify({model:"gpt-4o-mini",messages:[{role:"user",content:t}],temperature:.7,max_tokens:2048})});if(!r.ok){let a=yield r.json().catch(()=>({}));throw new Error(a.error?.message||`API request failed: ${r.status}`)}let i=yield r.json();if(!i.choices||!i.choices[0]?.message?.content)throw new Error("Invalid response format from OpenAI API");let o=i.choices[0].message.content;return this.incrementApiCounter(),{success:!0,text:o}}catch(r){return console.error("GitHub Models API error:",r),{success:!1,text:"",error:r.message||"Unknown error occurred"}}})}incrementApiCounter(){let r=parseInt(localStorage.getItem("githubApiCallCount")||"0",10)+1;localStorage.setItem("githubApiCallCount",r.toString()),window.dispatchEvent(new StorageEvent("storage",{key:"githubApiCallCount",newValue:r.toString()}))}getCookingHelp(t){return x(this,null,function*(){let r=`You are a helpful cooking assistant. Answer this question briefly and practically: ${t}`,i=yield this.generateContent(r);if(!i.success)throw new Error(i.error||"Failed to get cooking help");return i.text})}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=$t({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();export{Ou as a,f_ as b,vy as c,ky as d};
