<div class="remi-world-container">
  <div class="header">
    <h1>
      <mat-icon>school</mat-icon>
      Remi's World
    </h1>
    <p class="subtitle">Learn and play with fun quizzes!</p>
  </div>

  <!-- Category Selection -->
  <div class="categories" *ngIf="!selectedCategory()">
    <h2>Choose a Quiz Category</h2>
    <div class="category-grid">
      <mat-card class="category-card" (click)="selectCategory('spelling')">
        <mat-icon>spellcheck</mat-icon>
        <h3>Spelling</h3>
        <p>Practice spelling words</p>
      </mat-card>

      <mat-card class="category-card" (click)="selectCategory('math')">
        <mat-icon>calculate</mat-icon>
        <h3>Math</h3>
        <p>Solve math problems</p>
      </mat-card>

      <mat-card class="category-card" (click)="selectCategory('trivia')">
        <mat-icon>quiz</mat-icon>
        <h3>Trivia</h3>
        <p>Test your knowledge</p>
      </mat-card>
    </div>
  </div>

  <!-- Quiz Section -->
  <div class="quiz-section" *ngIf="selectedCategory() && currentQuestion()">
    <div class="quiz-header">
      <button mat-icon-button (click)="backToCategories()" class="back-btn">
        <mat-icon>arrow_back</mat-icon>
      </button>
      <div class="quiz-info">
        <h2>{{ selectedCategory() | titlecase }} Quiz</h2>
        <div class="score-badge">
          Score: {{ getScore().correct }} / {{ getScore().total }}
        </div>
      </div>
    </div>

    <mat-card class="question-card">
      <mat-card-content>
        <div class="question">
          <h3>{{ currentQuestion()?.question }}</h3>
          <p class="hint" *ngIf="currentQuestion()?.hint">
            <mat-icon>lightbulb</mat-icon>
            Hint: {{ currentQuestion()?.hint }}
          </p>
        </div>

        <!-- Text Input (for spelling and math) -->
        <div class="answer-section" *ngIf="currentQuestion()?.type !== 'multiple-choice' && !showResult()">
          <mat-form-field appearance="outline" class="answer-input">
            <mat-label>Your Answer</mat-label>
            <input 
              matInput 
              [(ngModel)]="userAnswer" 
              (keyup.enter)="submitAnswer()"
              placeholder="Type your answer here"
              autofocus>
          </mat-form-field>
          <button 
            mat-raised-button 
            color="primary" 
            (click)="submitAnswer()"
            [disabled]="!userAnswer().trim()">
            Submit Answer
          </button>
        </div>

        <!-- Multiple Choice Options -->
        <div class="answer-section" *ngIf="currentQuestion()?.type === 'multiple-choice' && !showResult()">
          <mat-radio-group [(ngModel)]="userAnswer" class="radio-group">
            <mat-radio-button 
              *ngFor="let option of currentQuestion()?.options" 
              [value]="option"
              class="radio-option">
              {{ option }}
            </mat-radio-button>
          </mat-radio-group>
          <button 
            mat-raised-button 
            color="primary" 
            (click)="submitAnswer()"
            [disabled]="!userAnswer().trim()">
            Submit Answer
          </button>
        </div>

        <!-- Result Display -->
        <div class="result-section" *ngIf="showResult()">
          <div class="result" [class.correct]="currentResult()" [class.incorrect]="!currentResult()">
            <mat-icon>{{ currentResult() ? 'check_circle' : 'cancel' }}</mat-icon>
            <h3>{{ currentResult() ? 'Correct!' : 'Not quite!' }}</h3>
            <p *ngIf="!currentResult()">
              The correct answer is: <strong>{{ currentQuestion()?.correctAnswer }}</strong>
            </p>
          </div>

          <div class="result-actions">
            <button 
              mat-raised-button 
              color="primary" 
              (click)="nextQuestion()"
              *ngIf="!isQuizComplete()">
              <mat-icon>arrow_forward</mat-icon>
              Next Question
            </button>
            <button 
              mat-raised-button 
              color="accent" 
              (click)="restartQuiz()"
              *ngIf="isQuizComplete()">
              <mat-icon>refresh</mat-icon>
              Try Again
            </button>
            <button 
              mat-button 
              (click)="backToCategories()">
              <mat-icon>home</mat-icon>
              Back to Categories
            </button>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Progress Indicator -->
    <div class="progress-section">
      <p>Questions Answered: {{ getScore().total }}</p>
      <div class="progress-bar">
        <div 
          class="progress-fill" 
          [style.width.%]="getScorePercentage()">
        </div>
      </div>
      <p class="score-text">{{ getScorePercentage() }}% Correct</p>
    </div>
  </div>

  <!-- Quiz Complete -->
  <div class="quiz-complete" *ngIf="selectedCategory() && !currentQuestion() && isQuizComplete()">
    <mat-card class="complete-card">
      <mat-icon class="trophy">emoji_events</mat-icon>
      <h2>Quiz Complete!</h2>
      <div class="final-score">
        <h3>Final Score</h3>
        <div class="score-display">
          {{ getScore().correct }} / {{ getScore().total }}
        </div>
        <div class="percentage">{{ getScorePercentage() }}%</div>
      </div>

      <div class="complete-actions">
        <button mat-raised-button color="primary" (click)="restartQuiz()">
          <mat-icon>refresh</mat-icon>
          Try Again
        </button>
        <button mat-raised-button color="accent" (click)="backToCategories()">
          <mat-icon>home</mat-icon>
          Choose Another Quiz
        </button>
      </div>
    </mat-card>
  </div>
</div>
